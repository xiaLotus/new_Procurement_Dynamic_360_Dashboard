<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ë´ãË≥ºÂãïÊÖã360ÁúãÊùø</title>
    <script src="../static/js/vue.global.js"></script>
    <link href="../static/css/tailwind.min.css" rel="stylesheet">
    <script src="../static/js/tailwinds.js"></script>
    <script src="../static/js/axios.min.js"></script>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            overflow: hidden; 
        }
        .fade-enter-active, .fade-leave-active {
            transition: opacity 0.2s;
        }
        .fade-enter-from, .fade-leave-to {
            opacity: 0;
        }
        .fade-enter-active, .fade-leave-active {
            transition: opacity 0.2s;
        }
        .fade-enter-from, .fade-leave-to {
            opacity: 0;
        }
        .rotate-90 {
            transform: rotate(90deg);
        }
        [data-folder-card] {
            position: fixed !important;
            z-index: 9999 !important;
        }
    </style>
</head>

<body class="bg-[#EEEEEE] font-sans leading-normal tracking-normal">

    <div id="app" class="mx-auto relative">

        <!-- Êñ∞Â¢ûË≥áÊñôÂ§æËàáÈ©óÊî∂Ë∑ØÂæë z-index ÊúÄÈ´ò -->
        <!-- <div v-if="showFolderCard" data-folder-card class="inset-0 bg-black bg-opacity-40 flex justify-center items-center">
            <div class="bg-white rounded-lg shadow-lg p-6 w-96 pointer-events-auto">
                <h3 class="text-lg font-bold text-gray-700 mb-3">Ë´ãËº∏ÂÖ•Ë≥áÊñôÂ§æÂêçÁ®±</h3>
                <input
                    v-if="folderCardTargetKey === 'Â†±ÂëäË∑ØÂæë'"
                    v-model="newFolderName"
                    placeholder="Ë´ãËº∏ÂÖ•Â†±ÂëäË≥áÊñôÂ§æÂêçÁ®±"
                    class="w-full border border-gray-300 px-3 py-2 rounded text-sm"
                />
                <input
                    v-else-if="folderCardTargetKey === 'È©óÊî∂Ë∑ØÂæë'"
                    v-model="acceptanceFolderName"
                    placeholder="Ë´ãËº∏ÂÖ•È©óÊî∂Ë≥áÊñôÂ§æÂêçÁ®±"
                    class="w-full border border-gray-300 px-3 py-2 rounded text-sm"
                />
                <div class="mt-4 flex justify-end space-x-2">
                    <button
                        class="px-4 py-1.5 text-sm border rounded text-gray-700 hover:bg-gray-100"
                        @click="showFolderCard = false"
                    >
                        ÂèñÊ∂à
                    </button>
                    <button
                        class="px-4 py-1.5 text-sm border border-blue-500 text-blue-600 rounded hover:bg-blue-50"
                    @click="checkFolderName()"
                    >
                        Á¢∫Ë™ç
                    </button>
                </div>
            </div>
        </div> -->


        <!-- Â∑¶‰∏äÊµÆÂãïÔºöÊú™Ë´ãË≥º‰ª∂Êï∏ -->
        <div class="absolute left-4 z-40 flex gap-2">
        <!-- ÂÖ®ÈÉ® -->
            <div 
                class="flex justify-center items-center text-white text-xs bg-blue-500 font-bold px-2 h-16 rounded shadow hover:bg-blue-600 transition w-[50px] text-center cursor-pointer"
                @click="resetAllFilters()"
            >
                ÂÖ®ÈÉ®
            </div>

            <!-- Êú™Ë´ãË≥º -->
            <div 
                class="flex flex-col justify-center text-white text-xs bg-red-500 px-2 h-16 rounded shadow hover:bg-red-600 transition w-[60px] text-center leading-snug cursor-pointer"
                @click="filterPurchaseStatus = 'UNORDERED'"
            >
                <span>Êú™Ë´ãË≥º</span>
                <span>{{ filteredUnorderedCount }} ‰ª∂</span>
            </div>

            <!-- Â∑≤Ë´ãË≥º -->
            <div 
                class="flex flex-col justify-center text-white text-xs bg-emerald-600 px-2 h-16 rounded shadow hover:bg-emerald-700 transition w-[60px] text-center leading-snug cursor-pointer"
                @click="filterPurchaseStatus = 'ORDERED'"
                >
                <span>Â∑≤Ë´ãË≥º</span>
                <span>{{ filteredOrderedCount }} ‰ª∂</span>
            </div>

            <!-- Áï∂ÂâçÊú™Ë´ãË≥ºÈáëÈ°ç -->
            <div 
                class="flex flex-col justify-center text-white text-xs bg-red-500 px-2 h-16 rounded shadow hover:bg-red-600 transition w-[120px] text-center leading-snug"
            >
                <span>Áï∂ÂâçÊú™Ë´ãË≥º</span>
                <div class="flex justify-center items-center gap-1">
                <img src="../static/picture/money.png" alt="money" class="w-3.5 h-3.5 object-contain" />
                <span>{{ allUnorderedCountMoney.toLocaleString() }}</span>
                </div>
            </div>
        </div>

        <!-- ‰∏ªÊ®ôÈ°åÁΩÆ‰∏≠ -->
        <div class="absolute left-0 right-0 h-16 flex items-center justify-center z-10">
            <h1 class="text-3xl font-semibold text-black">
                Ë´ãË≥ºÂãïÊÖã360ÁúãÊùø
            </h1>
        </div>

        <!-- Âè≥ÂÅ¥Ë≥áË®ä -->
        <div class="my-4 flex justify-end pr-4">
            <div class="inline-flex items-center gap-3">
                <!-- ÊØèÊúàËä±Ë≤ª(Â∑≤ÈñãÂñÆ) -->
                <div class="flex flex-col justify-center text-green-700 text-sm bg-green-100 px-3 py-2 rounded shadow w-64 text-center leading-snug min-h-[64px]">
                    <label for="issuedMonthSelect" class="text-sm font-semibold text-green-800 mb-1">
                        üìÖ ÊØèÊúàËä±Ë≤ª üí∞ {{ monthlyTotalAmount.toLocaleString() }} ÂÖÉ
                    </label>
                    <select
                        id="issuedMonthSelect"
                        v-model="selectedIssuedMonth"
                        class="w-full text-black border border-gray-300 px-2 py-1 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-400"
                        style="z-index: 50; position: relative;"
                        >
                        <option disabled value="">Ë´ãÈÅ∏Êìá</option>
                        <option v-for="month in issuedMonthOptions" :key="month" :value="month">
                            {{ formatMonth(month) }}
                        </option>
                    </select>
                </div>

                <!-- ÂåÖÂê´Êú™Ë´ãË≥ºÊúà‰ªΩÂçÄÂ°ä -->
                <div class="h-16 flex flex-col justify-center text-white text-xs bg-red-500 px-3 py-1.5 rounded shadow hover:bg-red-600 transition w-72 text-center leading-snug">
                    <label for="monthSelect" class="text-xs font-semibold text-white mb-0.5">
                        üìÖ Ë´ãÈÅ∏ÊìáÊúà‰ªΩ (Êú™Ë´ãË≥º) üí∞ {{ formattedSelectedAmount }}
                    </label>
                    <select
                        id="monthSelect"
                        v-model="selectedMonth"
                        class="w-full text-black border border-gray-300 px-2 py-0.5 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-400"
                        style="z-index: 50;"
                    >
                        <option disabled value="">Ë´ãÈÅ∏Êìá</option>
                        <option v-for="month in Object.keys(total_money_by_month_data)" :key="month" :value="month">
                            {{ formatMonth(month) }}
                        </option>
                    </select>
                </div>

                <!-- Ââ©‰∏ãÈ§òÈ°ç -->
                <div class="text-white text-sm bg-emerald-500 px-4 py-2 rounded shadow hover:bg-emerald-600 transition min-w-[100px] h-16 text-center leading-snug flex flex-col justify-center">
                    <span>Ââ©‰∏ãÈ§òÈ°ç</span>
                    <span>{{ rest_money.toLocaleString() }}</span>
                </div>

                <!-- ÈΩíËº™ÊåâÈàï + Â∞èÂç°ÔºàÊ≠£Á¢∫Êì∫Âú® inline-flex Ë£°Èù¢Ôºâ -->
                <div class="relative" style="z-index: 30;">
                    <div
                        @click="toggleSettings"
                        :class="{ 'rotate-90': showSettings }"
                        class="w-14 h-14 flex items-center justify-center bg-white border rounded-full shadow cursor-pointer hover:shadow-lg transition-transform duration-300"
                        style="z-index: 1001; position: relative;"
                    >
                        <img
                            src="../static/picture/ÈΩíËº™.png"
                            alt="Ë®≠ÂÆö"
                            class="w-8 h-8 object-contain pointer-events-none"
                        />
                    </div>
                
                    <transition name="fade">
                        <div v-if="showSettings"
                            class="absolute w-64 bg-white border rounded-lg shadow-lg p-4"
                            style="z-index: 32; left: -250px; top: 50px;">
                            <h3 class="text-xl font-semibold text-gray-800 mb-4">Ë´ãË≥ºÈ†êÁÆóË®≠ÂÆö</h3>
                            <div class="space-y-4">
                                <!-- Áï∂ÊúàË´ãË≥ºÈ†êÁÆó -->
                                <div>
                                    <label for="current-budget" class="block text-lg font-medium text-gray-700">Áï∂ÊúàË´ãË≥ºÈ†êÁÆó</label>
                                    <input 
                                        id="current-budget" 
                                        v-model="currentBudget" 
                                        type="number" 
                                        class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500" 
                                        placeholder="Ë´ãËº∏ÂÖ•Áï∂ÊúàË´ãË≥ºÈ†êÁÆó"
                                    />
                                </div>
                                <!-- Áï∂ÊúàËøΩÂä†È†êÁÆó -->
                                <div>
                                    <label for="additional-budget" class="block text-lg font-medium text-gray-700">Áï∂ÊúàËøΩÂä†È†êÁÆó</label>
                                    <input 
                                        id="additional-budget" 
                                        v-model="additionalBudget" 
                                        type="number" 
                                        class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500" 
                                        placeholder="Ë´ãËº∏ÂÖ•Áï∂ÊúàËøΩÂä†È†êÁÆó"
                                    />
                                </div>
                                <!-- Êèê‰∫§ÊåâÈàï -->
                                <div class="flex space-x-4 mt-4">
                                    <button @click="closeConfigCard" class="w-full py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">ÈóúÈñâ</button>
                                    <button @click="uploadMoney" class="w-full py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">Êèê‰∫§</button>
                                </div>
                            </div>
                        </div>
                    </transition>
                </div>
            </div>
        </div>
        <!-- ‰∏äÊñπÊ®ôÈ°åÂàóÁµêÊùü -->

        <!-- Ë≥áÊñôË°®Ê†º -->
        <div class="border border-gray-300 rounded-lg shadow-md overflow-y-auto" style="max-height: 80vh; min-height: 600px; overflow-x: auto;">
             <table class="min-w-full bg-white">
                <thead class="sticky top-0 bg-gray-800">
                    <tr class="bg-gray-100">
                        <!-- ÈñãÂñÆÁãÄÊÖã -->
                        <th class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30"
                            :class="{ 'bg-yellow-500 text-red-600 rounded px-1': isStatesFiltered }"
                            >
                            <div ref="stateDropdownWrapper">
                                <div @click="toggleDropdown('showStateFilter')"
                                    class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                    <span>ÈñãÂñÆÁãÄÊÖã</span>
                                    <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showStateFilter }">‚è∑</span>
                                </div>

                                <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                <transition name="fade">
                                    <div v-if="showStateFilter"
                                        class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                        <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                        <div class="flex justify-between items-center">
                                            <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                        </div>
                                        <hr class="border-gray-200" />

                                        <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                        <div class="max-h-52 overflow-y-auto space-y-1">
                                            <label 
                                                v-for="state in uniqueStates" 
                                                :key="state" 
                                                class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                            >
                                                <input 
                                                    type="checkbox" 
                                                    :value="state" 
                                                    v-model="checkedStates" 
                                                    class="text-blue-600 focus:ring-blue-500 rounded"
                                                />
                                                <span class="text-sm text-gray-700">{{ state }}</span>
                                            </label>
                                        </div>

                                        <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                        <div class="pt-2 text-right">
                                            <button @click="checkedStates = []; showStateFilter = false"
                                                class="text-gray-500 text-xs hover:text-red-500">
                                                Ê∏ÖÈô§ÁØ©ÈÅ∏
                                            </button>
                                        </div>
                                    </div>
                                </transition>
                            </div>
                        </th>
                        <!-- ÈñãÂñÆÁãÄÊÖã -->  
                        <!-- È©óÊî∂ÁãÄÊÖã -->  
                        <th class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30"
                            :class="{ 'bg-yellow-500 text-red-600 rounded px-1': isReceivingResutlFiltered }">
                            <div ref="ReceivingResultDropdownWrapper">
                                <div @click="toggleDropdown('showReceivingResultFilter')"
                                    class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                    <span>È©óÊî∂ÁãÄÊÖã</span>
                                    <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showReceivingResultFilter }">‚è∑</span>
                                </div>

                                <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                <transition name="fade">
                                    <div v-if="showReceivingResultFilter"
                                        class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                        <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                        <div class="flex justify-between items-center">
                                            <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                        </div>
                                        <hr class="border-gray-200" />

                                        <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                        <div class="max-h-52 overflow-y-auto space-y-1">
                                            <label 
                                                v-for="val in uniqueReceivingResult" 
                                                :key="val" 
                                                class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                            >
                                                <input 
                                                    type="checkbox" 
                                                    :value="val" 
                                                    v-model="checkedReceivingResults" 
                                                    class="text-blue-600 focus:ring-blue-500 rounded"
                                                />
                                                <span class="text-sm text-gray-700">
                                                    {{ val === 'V' ? '‚úî ÈÄöÈÅé' : val === 'X' ? '‚úñ ‰∏çÈÄöÈÅé' : '‚ßó Êú™È©óÊî∂' }}
                                                </span>
                                            </label>
                                        </div>

                                        <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                        <div class="pt-2 text-right">
                                            <button @click="checkedReceivingResults = []; showReceivingResultFilter = false"
                                                class="text-gray-500 text-xs hover:text-red-500">
                                                Ê∏ÖÈô§ÁØ©ÈÅ∏
                                            </button>
                                        </div>
                                    </div>
                                </transition>
                            </div>
                        </th>
                        <!-- È©óÊî∂ÁãÄÊÖã -->
                        <!-- WBS -->
                        <th class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30"
                            :class="{ 'bg-yellow-500 text-red-600 rounded px-1': isWBSFiltered }">
                            <div ref="WBSDropdownWrapper">
                                <div @click="toggleDropdown('showWBSFilter')"
                                    class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                    <span>WBS</span>
                                    <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showWBSFilter }">‚è∑</span>
                                </div>

                                <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                <transition name="fade">
                                    <div v-if="showWBSFilter"
                                        class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-64 p-2 space-y-2">
                                    
                                        <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                        <div class="flex justify-between items-center">
                                            <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                        </div>
                                        <hr class="border-gray-200" />

                                        <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                        <div class="max-h-52 overflow-y-auto space-y-1">
                                            <label 
                                                v-for="wbs in uniqueWBS" 
                                                :key="wbs" 
                                                class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                            >
                                                <input 
                                                    type="checkbox" 
                                                    :value="wbs" 
                                                    v-model="checkedWBS" 
                                                    class="text-blue-600 focus:ring-blue-500 rounded"
                                                />
                                                <span class="text-sm text-gray-700">{{ wbs }}</span>
                                            </label>
                                        </div>

                                        <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                        <div class="pt-2 text-right">
                                            <button @click="checkedWBS = []; showWBSFilter = false" class="text-gray-500 text-xs hover:text-red-500">Ê∏ÖÈô§ÁØ©ÈÅ∏</button>
                                        </div>
                                    </div>
                                </transition>
                            </div>
                        </th>
                        <!-- WBS -->

                        <!-- Ë´ãË≥ºÈ†ÜÂ∫è -->
                        <th class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30"
                            :class="{ 'bg-yellow-500 text-red-600 rounded px-1': isOrdersFiltered }">
                            <div ref="OrderDropdownWrapper">
                                <div @click="toggleDropdown('showOrderFilter')"
                                    class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                    <span>Ë´ãË≥ºÈ†ÜÂ∫è</span>
                                    <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showOrderFilter }">‚è∑</span>
                                </div>

                                <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                <transition name="fade">
                                    <div v-if="showOrderFilter"
                                        class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">
                                    
                                        <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                        <div class="flex justify-between items-center">
                                            <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            <button @click="toggleSort('Ë´ãË≥ºÈ†ÜÂ∫è')"
                                                class="text-gray-500 text-xs hover:text-red-500">
                                                È†ÜÂ∫èË™øÊï¥
                                            </button>
                                        </div>
                                        <hr class="border-gray-200" />

                                        <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                        <div class="max-h-52 overflow-y-auto space-y-1">
                                            <label 
                                                v-for="order in uniqueOrders" 
                                                :key="order" 
                                                class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                            >
                                                <!-- :value="order"  -->
                                                <input 
                                                    type="checkbox" 
                                                    
                                                    :value="String(order)"  
                                                    v-model="checkedOrders" 
                                                    class="text-blue-600 focus:ring-blue-500 rounded"
                                                />
                                                <span class="text-sm text-gray-700">{{ order }}</span>
                                            </label>
                                        </div>

                                        <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                        <div class="pt-2 text-right">
                                            <button @click="checkedOrders = []; showOrderFilter = false" class="text-gray-500 text-xs hover:text-red-500">Ê∏ÖÈô§ÁØ©ÈÅ∏</button>
                                        </div>
                                    </div>
                                </transition>
                            </div>
                        </th>
                        <!-- Ë´ãË≥ºÈ†ÜÂ∫è -->

                        <!-- ÈúÄÊ±ÇËÄÖ -->
                        <th class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30"
                            :class="{ 'bg-yellow-500 text-red-600 rounded px-1': isPeopleFiltered }">
                            <div ref="NeedPersonDropdownWrapper">
                                <div @click="toggleDropdown('showPersonFilter')"
                                    class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                    <span>ÈúÄÊ±ÇËÄÖ</span>
                                    <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showPersonFilter }">‚è∑</span>
                                </div>

                                <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                <transition name="fade">
                                    <div v-if="showPersonFilter"
                                        class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-64 p-2 space-y-2">
                                    
                                        <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                        <div class="flex justify-between items-center">
                                            <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                        </div>
                                        <hr class="border-gray-200" />

                                        <!-- Â§öÈÅ∏Ê∏ÖÂñÆÔºåÈªûÊï¥Ë°åÂèØÈÅ∏ -->
                                        <div class="max-h-52 overflow-y-auto space-y-1">
                                            <label 
                                                v-for="person in uniquePeople" 
                                                :key="person" 
                                                class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                            >
                                                <input 
                                                    type="checkbox" 
                                                    :value="person" 
                                                    v-model="checkedPeople" 
                                                    class="text-blue-600 focus:ring-blue-500 rounded"
                                                />
                                                <span class="text-sm text-gray-700">{{ person }}</span>
                                            </label>
                                        </div>

                                        <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                        <div class="pt-2 text-right">
                                            <button @click="clearPersonFilter" class="text-gray-500 text-xs hover:text-red-500">Ê∏ÖÈô§ÁØ©ÈÅ∏</button>
                                        </div>
                                    </div>
                                </transition>
                            </div>
                        </th>
                        <!-- ÈúÄÊ±ÇËÄÖ -->
                        
                        <!-- Ë´ãË≥ºÈ†ÖÁõÆ -->
                        <th class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30"
                            :class="{ 'bg-yellow-500 text-red-600 rounded px-1': isItemsFiltered }">
                            <div ref="NeedItemDropdownWrapper">
                                <div @click="closeAllDropdowns(); showItemFilter = !showItemFilter"
                                    class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                    <span>Ë´ãË≥ºÈ†ÖÁõÆ</span>
                                    <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showItemFilter }">‚è∑</span>
                                </div>

                                <transition name="fade">
                                    <div v-if="showItemFilter"
                                        class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-64 p-2 space-y-2">
                                    
                                        <!-- Ê®°Á≥äÊêúÂ∞ãËº∏ÂÖ•Ê°Ü -->
                                        <input v-model="itemSearchText"
                                            @input="onItemSearchChange"
                                            placeholder="Ê®°Á≥äÊêúÂ∞ã"
                                            class="w-full border border-gray-300 px-2 py-1 text-sm rounded" />

                                        <!-- ÈÅ∏È†ÖÊ∏ÖÂñÆ -->
                                        <div class="max-h-52 overflow-y-auto space-y-1">
                                            <label 
                                                v-for="item in uniqueItems" 
                                                :key="item" 
                                                class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                            >
                                                <input 
                                                    type="checkbox" 
                                                    :value="item" 
                                                    v-model="checkedItems" 
                                                    class="text-blue-600 focus:ring-blue-500 rounded" />
                                                <span class="text-sm text-gray-700">{{ item || '(Á©∫ÁôΩ)' }}</span>
                                            </label>
                                        </div>

                                        <!-- Ê∏ÖÈô§ -->
                                        <div class="pt-2 text-right">
                                            <button @click="checkedItems = []; showItemFilter = false"
                                            class="text-gray-500 text-xs hover:text-red-500">Ê∏ÖÈô§ÁØ©ÈÅ∏</button>
                                        </div>
                                    </div>
                                </transition>
                            </div>
                        </th>
                        <!-- Ë´ãË≥ºÈ†ÖÁõÆ -->

                        <!-- ÈúÄÊ±ÇÂéüÂõ† -->
                        <th class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30"
                            :class="{ 'bg-yellow-500 text-red-600 rounded px-1': isReasonsFiltered }">
                            <div ref="NeedReasonDropdownWrapper">
                                <div @click="toggleDropdown('showReasonFilter')"
                                    class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                    <span>ÈúÄÊ±ÇÂéüÂõ†</span>
                                    <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showReasonFilter }">‚è∑</span>
                                </div>

                                <transition name="fade">
                                    <div v-if="showReasonFilter"
                                        class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-64 p-2 space-y-2">
                                        
                                        <!-- Ê®°Á≥äÊêúÂ∞ãËº∏ÂÖ•Ê°Ü -->
                                        <input v-model="reasonSearchText"
                                                @input="onReasonSearchChange"
                                                placeholder="Ê®°Á≥äÊêúÂ∞ã"
                                                class="w-full border border-gray-300 px-2 py-1 text-sm rounded" 
                                        />

                                        <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                        <div class="max-h-52 overflow-y-auto space-y-1">
                                            <label 
                                                v-for="reason in uniqueReasons.filter(r => !reasonSearchText || r.includes(reasonSearchText))"
                                                :key="reason"
                                                class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                            >
                                                <input 
                                                    type="checkbox" 
                                                    :value="reason" 
                                                    v-model="checkedReasons"
                                                    class="text-blue-600 focus:ring-blue-500 rounded" />
                                                    <span class="text-sm text-gray-700">{{ reason || '(Á©∫ÁôΩ)' }}</span>
                                            </label>
                                        </div>

                                        <!-- Ê∏ÖÈô§ -->
                                        <div class="pt-2 text-right">
                                            <button @click="checkedReasons = []; showReasonFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">Ê∏ÖÈô§ÁØ©ÈÅ∏</button>
                                        </div>
                                    </div>
                                </transition>
                            </div>
                        </th>
                        <!-- ÈúÄÊ±ÇÂéüÂõ† -->

                        <!-- Á∏ΩÈáëÈ°ç -->
                        <th class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30"
                            :class="{ 'bg-yellow-500 text-red-600 rounded px-1': isAmountsFiltered }">
                            <div ref="TotalMoneyDropdownWrapper">
                                <div @click="toggleDropdown('showAmountFilter')"
                                    class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                    <span>Á∏ΩÈáëÈ°ç</span>
                                    <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showAmountFilter }">‚è∑</span>
                                </div>

                                <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                <transition name="fade">
                                    <div v-if="showAmountFilter"
                                        class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-64 p-2 space-y-2">

                                        <!-- Ê®ôÈ°åËàáÊéíÂ∫è -->
                                        <div class="flex justify-between items-center">
                                            <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            <button @click="toggleSort('Á∏ΩÈáëÈ°ç')" class="text-gray-500 text-xs hover:text-red-500">È†ÜÂ∫èË™øÊï¥</button>
                                        </div>
                                        <hr class="border-gray-200" />

                                        <!-- Â§öÈÅ∏Ê∏ÖÂñÆÔºà‰∏çÂÜçÊ†ºÂºèÂåñÊúà‰ªΩÔºâ-->
                                        <div class="max-h-52 overflow-y-auto space-y-1">
                                            <label v-for="amount in uniqueAmounts"
                                                :key="amount"
                                                class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition">
                                                <input type="checkbox"
                                                        :value="amount"
                                                        v-model="checkedAmounts"
                                                        class="text-blue-600 focus:ring-blue-500 rounded" />
                                                <span class="text-sm text-gray-700">{{ amount }}</span>
                                            </label>
                                        </div>

                                        <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                        <div class="pt-2 text-right">
                                            <button @click="checkedAmounts = []; showAmountFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                Ê∏ÖÈô§ÁØ©ÈÅ∏
                                            </button>
                                        </div>
                                    </div>
                                </transition>
                            </div>
                        </th>
                        <!-- Á∏ΩÈáëÈ°ç -->

                        <!-- ÈúÄÊ±ÇÊó• -->
                        <th class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30"
                            :class="{ 'bg-yellow-500 text-red-600 rounded px-1': isNeedDatesFiltered }">
                            <div ref="NeedDateDropdownWrapper">
                                <div @click="toggleDropdown('showNeedDateFilter')"
                                    class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                    <span>ÈúÄÊ±ÇÊó•</span>
                                    <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showNeedDateFilter }">‚è∑</span>
                                </div>

                                <transition name="fade">
                                    <div v-if="showNeedDateFilter"
                                        class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-48 p-2 space-y-2">

                                        <div class="flex justify-between items-center">
                                            <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                        </div>
                                        <hr class="border-gray-200" />

                                        <div class="max-h-52 overflow-y-auto space-y-1">
                                            <label 
                                                v-for="date in uniqueNeedDates" 
                                                :key="date" 
                                                class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                            >
                                                <input 
                                                    type="checkbox" 
                                                    :value="date" 
                                                    v-model="checkedNeedDates" 
                                                    class="text-blue-600 focus:ring-blue-500 rounded"
                                                />
                                                <span class="text-sm text-gray-700">{{ date }}</span>
                                            </label>
                                        </div>

                                        <div class="pt-2 text-right">
                                            <button @click="checkedNeedDates = []; showNeedDateFilter = false" class="text-gray-500 text-xs hover:text-red-500">Ê∏ÖÈô§ÁØ©ÈÅ∏</button>
                                        </div>
                                    </div>
                                </transition>
                            </div>
                        </th>
                        <!-- ÈúÄÊ±ÇÊó• -->

                        <!-- Â∑≤ÈñãÂñÆÊó•Êúü -->
                        <th class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30"
                            :class="{ 'bg-yellow-500 text-red-600 rounded px-1': isIssuedMonthsFiltered }">
                            <div ref="AleadyDateDropdownWrapper">
                                <div @click="toggleDropdown('showIssuedMonthFilter')"
                                    class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                    <span>Â∑≤ÈñãÂñÆÊó•Êúü</span>
                                    <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showIssuedMonthFilter }">‚è∑</span>
                                </div>

                                <transition name="fade">
                                    <div v-if="showIssuedMonthFilter"
                                        class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-48 p-2 space-y-2">

                                        <div class="flex justify-between items-center">
                                            <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            <button @click="toggleSort('Â∑≤ÈñãÂñÆÊó•Êúü')"
                                                class="text-gray-500 text-xs hover:text-red-500">
                                                È†ÜÂ∫èË™øÊï¥
                                            </button>
                                        </div>
                                        <hr class="border-gray-200" />

                                        <div class="max-h-52 overflow-y-auto space-y-1">
                                            <label 
                                                v-for="month in uniqueIssuedMonths" 
                                                :key="month" 
                                                class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                            >
                                                <input 
                                                    type="checkbox" 
                                                    :value="month" 
                                                    v-model="checkedIssuedMonths" 
                                                    class="text-blue-600 focus:ring-blue-500 rounded"
                                                />
                                                <span class="text-sm text-gray-700">{{ month.slice(0, 4) }}/{{ month.slice(4, 6) }}</span>
                                            </label>
                                        </div>

                                        <div class="pt-2 text-right">
                                            <button @click="checkedIssuedMonths = []; showIssuedMonthFilter = false" class="text-gray-500 text-xs hover:text-red-500">Ê∏ÖÈô§ÁØ©ÈÅ∏</button>
                                        </div>
                                    </div>
                                </transition>
                            </div>
                        </th>
                        <!-- Â∑≤ÈñãÂñÆÊó•Êúü -->

                        <!-- ePR No. -->
                        <th class="relative py-3 px-6 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30"
                            :class="{ 'bg-yellow-500 text-red-600 rounded px-1': isEPRsFiltered }">
                            <div ref="EPRNODropdownWrapper">
                                <div @click="toggleDropdown('showEPRFilter')"
                                    class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                    <span>ePR No.</span>
                                    <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showEPRFilter }">‚è∑</span>
                                </div>

                                <transition name="fade">
                                    <div v-if="showEPRFilter"
                                        class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-64 p-2 space-y-2">
                                        <!-- Ê®°Á≥äÊêúÂ∞ãËº∏ÂÖ•Ê°Ü -->
                                        <input v-model="ePRsSearchText"
                                                @input="onePRSearchChange"
                                                placeholder="Ê®°Á≥äÊêúÂ∞ã"
                                                class="w-full border border-gray-300 px-2 py-1 text-sm rounded" 
                                        />
                                        <hr class="border-gray-200" />
                                        <div class="max-h-52 overflow-y-auto space-y-1">
                                            <label v-for="epr in uniqueEPRs" :key="epr"
                                                class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition">
                                                <input type="checkbox" :value="epr" v-model="checkedEPRs"
                                                    class="text-blue-600 focus:ring-blue-500 rounded" />
                                                <span class="text-sm text-gray-700">{{ epr || 'Â∞öÊú™Êúâ ePR Á∑®Ëôü' }}</span>
                                            </label>
                                        </div>
                                        <div class="pt-2 text-right">
                                            <button @click="checkedEPRs = []; showEPRFilter = false"
                                                class="text-gray-500 text-xs hover:text-red-500">Ê∏ÖÈô§ÁØ©ÈÅ∏</button>
                                        </div>
                                    </div>
                                </transition>
                            </div>
                        </th>
                        <!-- ePR No. -->
                        <!-- PO No -->
                        <th class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30"
                            :class="{ 'bg-yellow-500 text-red-600 rounded px-1': isPONosFiltered }">
                            <div ref="poDropdownWrapper">
                                <div @click="toggleDropdown('showPONoFilter')"
                                    class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                    <span>PO No</span>
                                    <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showPONoFilter }">‚è∑</span>
                                </div>

                                <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                <transition name="fade">
                                    <div v-if="showPONoFilter"
                                        class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-48 p-2 space-y-2">

                                        <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                        <div class="max-h-52 overflow-y-auto space-y-1">
                                            <label 
                                                v-for="po in uniquePONos" 
                                                :key="po" 
                                                class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                            >
                                                <input 
                                                    type="checkbox" 
                                                    :value="po" 
                                                    v-model="checkedPONos" 
                                                    class="text-blue-600 focus:ring-blue-500 rounded"
                                                />
                                                <span class="text-sm text-gray-700">{{ po }}</span>
                                            </label>
                                        </div>

                                        <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                        <div class="pt-2 text-right">
                                            <button @click="checkedPONos = []; showPONoFilter = false"
                                                class="text-gray-500 text-xs hover:text-red-500">
                                                Ê∏ÖÈô§ÁØ©ÈÅ∏
                                            </button>
                                        </div>
                                    </div>
                                </transition>
                            </div>
                        </th>
                        <!-- PO No -->
                        <!-- Á∞ΩÊ†∏‰∏≠ÈóúÂç° -->
                        <th class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30"
                            :class="{ 'bg-yellow-500 text-red-600 rounded px-1': isStageFiltered }">
                            <div ref="CheckDropdownWrapper">
                                <div @click="toggleDropdown('showStageFilter')" class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                    <span>Á∞ΩÊ†∏‰∏≠ÈóúÂç°</span>
                                    <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showStageFilter }">‚è∑</span>
                                </div>

                                <transition name="fade">
                                    <div v-if="showStageFilter" class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-64 p-2 space-y-2">
                                        <div class="flex justify-between items-center">
                                            <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                        </div>
                                        <hr class="border-gray-200" />
                                        <div class="max-h-52 overflow-y-auto space-y-1">
                                            <label v-for="stage in uniqueStages" :key="stage" class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition">
                                                <input type="checkbox" :value="stage" v-model="checkedStages" class="text-blue-600 focus:ring-blue-500 rounded" />
                                                <span class="text-sm text-gray-700">{{ stage || 'Â∞öÊú™ÊúâË≥áÊñô' }}</span>
                                            </label>
                                        </div>
                                        <div class="pt-2 text-right">
                                            <button @click="checkedStages = []; showStageFilter = false" class="text-gray-500 text-xs hover:text-red-500">Ê∏ÖÈô§ÁØ©ÈÅ∏</button>
                                        </div>
                                    </div>
                                </transition>
                            </div>
                        </th>
                        <!-- Á∞ΩÊ†∏‰∏≠ÈóúÂç° -->
                        <!-- Status -->
                        <th class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30"
                            :class="{ 'bg-yellow-500 text-red-600 rounded px-1': isStatuesFiltered }">
                            <div ref="StatusDropdownWrapper">
                                <div @click="toggleDropdown('showStatusFilter')" class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                    <span>Status</span>
                                    <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showStatusFilter }">‚è∑</span>
                                </div>

                                <transition name="fade">
                                    <div v-if="showStatusFilter" class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-64 p-2 space-y-2">
                                        <div class="flex justify-between items-center">
                                            <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                        </div>
                                        <hr class="border-gray-200" />
                                        <div class="max-h-52 overflow-y-auto space-y-1">
                                            <label v-for="s in uniqueStatuses" :key="s" class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition">
                                                <input type="checkbox" :value="s" v-model="checkedStatuses" class="text-blue-600 focus:ring-blue-500 rounded" />
                                                <span class="text-sm text-gray-700">{{ s || 'Â∞öÊú™ÊúâË≥áÊñô' }}</span>
                                            </label>
                                        </div>
                                        <div class="pt-2 text-right">
                                            <button @click="checkedStatuses = []; showStatusFilter = false" class="text-gray-500 text-xs hover:text-red-500">Ê∏ÖÈô§ÁØ©ÈÅ∏</button>
                                        </div>
                                    </div>
                                </transition>
                            </div>
                        </th>
                        <!-- Status -->
                        <!-- ÂÇôË®ª -->
                        <th class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30"
                            :class="{ 'bg-yellow-500 text-red-600 rounded px-1': isRemarksFiltered }">
                            <div ref="RemarksDropdownWrapper">
                                <div @click="toggleDropdown('showRemarkFilter')" class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                    <span>ÂÇôË®ª</span>
                                    <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showRemarkFilter }">‚è∑</span>
                                </div>

                                <transition name="fade">
                                    <div v-if="showRemarkFilter" class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-64 p-2 space-y-2">
                                        <input v-model="remarkSearchText"
                                                @input="onRemarkSearchChange"
                                                placeholder="Ê®°Á≥äÊêúÂ∞ã"
                                                class="w-full border border-gray-300 px-2 py-1 text-sm rounded" 
                                        />
                                        <hr class="border-gray-200" />
                                        <div class="max-h-52 overflow-y-auto space-y-1">
                                            <label v-for="s in uniqueRemarks" :key="s" class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition">
                                                <input type="checkbox" :value="s" v-model="checkedRemarks" class="text-blue-600 focus:ring-blue-500 rounded" />
                                                <span class="text-sm text-gray-700">{{ s || 'Â∞öÊú™ÊúâË≥áÊñô' }}</span>
                                            </label>
                                        </div>
                                        <div class="pt-2 text-right">
                                            <button @click="checkedRemarks = []; showRemarkFilter = false" class="text-gray-500 text-xs hover:text-red-500">Ê∏ÖÈô§ÁØ©ÈÅ∏</button>
                                        </div>
                                    </div>
                                </transition>
                            </div>
                        </th>
                        <th class="py-3 px-4 text-left text-sm font-semibold text-gray-700 whitespace-nowrap text-center">Edit</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="(item, index) in sortedFilteredData" 
                            :key="index" 
                            class="border-t border-gray-200"
                            :class="{
                                'bg-gray-500 text-white': item['ÈñãÂñÆÁãÄÊÖã'] === 'C' || item['ÂèñÊ∂à'] === 'C'
                            }"
                        >
                        <td class="py-2 px-4 text-sm text-center"
                            :class="{
                                'text-red-500 text-5xl font-bold': item['ÈñãÂñÆÁãÄÊÖã'] === 'X',
                                'text-green-500 text-5xl font-bold': item['ÈñãÂñÆÁãÄÊÖã'] === 'V'
                            }">
                            {{ item['ÈñãÂñÆÁãÄÊÖã'] }}
                        </td>
                        <td class="py-2 px-4 text-sm text-center"
                            :class="{
                                'text-red-500 text-5xl font-bold': item['È©óÊî∂ÁãÄÊÖã'] === 'X',
                                'text-green-500 text-5xl font-bold': item['È©óÊî∂ÁãÄÊÖã'] === 'V'
                            }">
                            {{ item.È©óÊî∂ÁãÄÊÖã }}
                        </td>
                        <td class="py-2 px-4 text-sm text-center">{{ item.WBS }}</td>
                        <td class="py-2 px-4 text-sm font-bold text-center" 
                            :class="{
                                'text-red-500 text-5xl text-center': Number(item.Ë´ãË≥ºÈ†ÜÂ∫è) === 1,
                                'text-yellow-500 text-5xl text-center': Number(item.Ë´ãË≥ºÈ†ÜÂ∫è) === 2,
                                'text-green-500 text-5xl text-center': Number(item.Ë´ãË≥ºÈ†ÜÂ∫è) === 3
                            }">
                            {{ item.Ë´ãË≥ºÈ†ÜÂ∫è }}
                        </td>
                        <td class="py-2 px-4 text-sm text-center">{{ item.ÈúÄÊ±ÇËÄÖ }}</td>
                        <td class="py-2 px-4 text-sm ">{{ item.Ë´ãË≥ºÈ†ÖÁõÆ }}</td>
                        <td class="py-2 px-4 text-sm ">{{ item.ÈúÄÊ±ÇÂéüÂõ† }}</td>
                        <td class="py-2 px-4 text-sm text-center">{{ Number(item.Á∏ΩÈáëÈ°ç).toLocaleString() }}</td>
                        <td class="py-2 px-4 text-sm text-center">
                            {{ String(item.ÈúÄÊ±ÇÊó•).length === 8 ? String(item.ÈúÄÊ±ÇÊó•).slice(0,4) + '/' + String(item.ÈúÄÊ±ÇÊó•).slice(4,6) + '/' + String(item.ÈúÄÊ±ÇÊó•).slice(6,8) : item.ÈúÄÊ±ÇÊó• }}
                        </td>
                        <td class="py-2 px-4 text-sm text-center">
                            {{ String(item.Â∑≤ÈñãÂñÆÊó•Êúü).length === 8 ? String(item.Â∑≤ÈñãÂñÆÊó•Êúü).slice(0,4) + '/' + String(item.Â∑≤ÈñãÂñÆÊó•Êúü).slice(4,6) + '/' + String(item.Â∑≤ÈñãÂñÆÊó•Êúü).slice(6,8) : '' }}
                        </td>
                        <td class="py-2 px-4 text-sm text-center">
                            <span v-if="String(item['ePR No.']).length === 10">
                                <a 
                                    :href="`https://khwfap.kh.asegroup.com/ePR/zh-TW/PRQuery/QueryPR?id=${item['ePR No.']}`" 
                                    class="text-blue-600 hover:underline" 
                                    target="_blank"
                                >
                                    {{ item["ePR No."] || ''}}
                                </a>
                            </span>
                        </td>
                        <td class="py-2 px-4 text-sm text-center" v-html="item['PO No.'] || ''"></td>
                        <td class="py-2 px-4 text-sm text-center">
                            {{ item.Á∞ΩÊ†∏‰∏≠ÈóúÂç° }}
                        </td>
                        <td class="py-2 px-4 text-sm text-center">
                            {{ item.Status }}
                        </td>
                        <td class="py-2 px-4 text-sm text-center">{{ item.ÂÇôË®ª }}</td>
                        <td class="py-2 px-4 text-sm text-center">
                            <div class="flex flex-col items-center gap-2">
                                <button 
                                    @click="editItem(index, item)" 
                                    class="w-20 bg-yellow-400 hover:bg-yellow-500 text-gray-900 font-semibold py-1 px-2 rounded-lg shadow transition-all duration-200">
                                    ‚úèÔ∏è ‰øÆÊ≠£
                                </button>
                                <button 
                                    @click="deleteItem(index, item)" 
                                    class="w-20 bg-red-500 hover:bg-red-600 text-white font-semibold py-1 px-2 rounded-lg shadow transition-all duration-200">
                                    üóëÔ∏è Âà™Èô§
                                </button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- Ë°®Ê†ºÂçÄÂ°äÁµêÊùü -->

        <!-- Â∫ïÈÉ®ÊåâÈàïÂçÄÂ°ä - Âêà‰ΩµÂ∑¶Âè≥ÂÖ©ÂÅ¥ -->
        <div class="fixed bottom-6 left-6 right-6 z-50 flex justify-between items-end">
            <!-- Â∑¶ÂÅ¥ÔºöÁØ©ÈÅ∏ÂçÄÈñìÊåâÈàï -->
            <div class="relative">
                <div 
                    class="text-white text-lg bg-green-600 px-5 py-3 rounded-full shadow-lg hover:bg-green-700 transition min-w-[140px] h-12 text-center cursor-pointer flex items-center justify-center"
                    @click="openFilterCard">
                    üìÖ ÁØ©ÈÅ∏ÂçÄÈñì
                </div>

                <!-- Âç°ÁâáÈ°ØÁ§∫Âú®ÊåâÈàï‰∏äÊñπ -->
                <transition name="fade">
                    <div v-if="showFilterCard"
                        class="absolute bottom-full left-0 mb-2 w-80 bg-white border rounded-lg shadow-xl p-4 text-gray-800"
                        style="z-index: 9999;">
                        <h3 class="text-lg font-semibold mb-3 text-center border-b pb-2">üìÖ Êó•ÊúüÂçÄÈñìÁØ©ÈÅ∏</h3>
                        <div class="space-y-3">
                            <label class="block">
                                <span class="text-sm font-medium text-gray-700">ÈñãÂßãÊó•ÊúüÔºö</span>
                                <input type="date" v-model="filterStartDate"
                                    class="w-full border border-gray-300 px-3 py-2 rounded-md focus:ring-2 focus:ring-blue-400 focus:border-blue-400" />
                            </label>
                            <label class="block">
                                <span class="text-sm font-medium text-gray-700">ÁµêÊùüÊó•ÊúüÔºö</span>
                                <input type="date" v-model="filterEndDate"
                                    class="w-full border border-gray-300 px-3 py-2 rounded-md focus:ring-2 focus:ring-blue-400 focus:border-blue-400" />
                            </label>
                        </div>
                        <div class="mt-4 flex justify-between space-x-2">
                            <button @click="applyDateRangeFilter"
                                class="px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition flex-1">
                                ‚úÖ Â•óÁî®
                            </button>
                            <button @click="cancelDateRangeFilter"
                                class="px-4 py-2 bg-orange-500 text-white rounded-md hover:bg-orange-600 transition flex-1">
                                üîÑ ÂèñÊ∂àÁØ©ÈÅ∏
                            </button>
                            <button @click="showFilterCard = false"
                                class="px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition flex-1">
                                ‚ùå ÈóúÈñâ
                            </button>
                        </div>
                    </div>
                </transition>
            </div>

            <!-- Âè≥ÂÅ¥Ôºö‰∏âÂÄãÊåâÈàïÁæ§ÁµÑ -->
            <div class="flex items-end space-x-4">
                <div 
                    class="bg-purple-500 hover:bg-purple-600 text-white text-lg px-5 py-3 rounded-full shadow-lg cursor-pointer flex items-center justify-center h-12"
                    @click="goDetailPage">
                    <span> üìã eRT È©óÊî∂Á∏ΩË°®</span>
                </div>
                <div 
                    class="bg-emerald-700 hover:bg-emerald-800 text-white px-5 py-3 rounded-full shadow-lg text-lg cursor-pointer flex items-center justify-center h-12"
                    @click="openUploadModal">
                    üîÅ Êõ¥Êñ∞ÁõÆÂâçÁãÄÊÖã
                </div>
                <div 
                    class="bg-blue-600 hover:bg-blue-700 text-white px-5 py-3 rounded-full shadow-lg text-lg cursor-pointer flex items-center justify-center h-12"
                    @click="openNewItemModal">
                    ‚ûï Êñ∞Â¢û
                </div>
            </div>
        </div>

        <!-- üìÇ ‰∏äÂÇ≥ Modal Ë¶ñÁ™ó -->
        <div v-if="showUploadModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white w-full max-w-md rounded-lg p-6 shadow-xl space-y-4">
                <h2 class="text-xl font-semibold text-gray-800">üîÅ ‰∏äÂÇ≥Êõ¥Êñ∞Ê™îÊ°à</h2>

                <input type="file" @change="handleFileChange" class="block w-full border border-gray-300 rounded px-3 py-2" />

                <div class="flex justify-end space-x-3 pt-2">
                    <button @click="showUploadModal = false"
                            class="bg-gray-400 hover:bg-gray-500 text-white px-4 py-2 rounded shadow">
                        ‚ùå ÂèñÊ∂à
                    </button>
                    <button @click="uploadFile"
                            class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded shadow">
                        üì§ Á¢∫Ë™ç‰∏äÂÇ≥
                    </button>
                </div>
            </div>
        </div>

        <!-- ‰øÆÊ≠£Âç°Áâá UI -->
        <div v-if="editingIndex !== null" class="fixed inset-0 bg-black bg-opacity-50 z-50 overflow-y-auto py-10 px-4">
            <div class="relative bg-white w-full max-w-full rounded-xl shadow-xl p-6 space-y-6 mx-auto">
                <h2 class="text-3xl font-bold text-gray-800 text-center border-b pb-3 flex items-center justify-center gap-2">
                    ‚úèÔ∏è ‰øÆÊ≠£Ë´ãË≥ºË≥áÊñô
                    <!-- Ë§áË£ΩÂúñÁ§∫ -->
                    <div class="relative group inline-block">
                        <img
                            src="../static/picture/Copy.png"
                            alt="Ë§áË£ΩÂúñÁ§∫"
                            class="w-8 h-8 object-contain cursor-pointer hover:scale-110 transition-transform"
                            @click="copyToNewItem"
                        />
                        <div
                            class="absolute top-full left-1/2 -translate-x-1/2 mt-2 px-4 py-2 bg-white text-gray-800 text-sm rounded-lg shadow-lg border z-50 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap"
                            >
                            üìÑ Ë§áË£ΩÊ≠§Ë´ãË≥ºË≥áÊñôÔºåÂè¶Â≠òÁÇ∫Êñ∞ÂñÆÊìö
                        </div>
                    </div>

                    <!-- ÂØÑ‰ø°ÂúñÁ§∫ -->
                    <div v-if="admins.includes(username)" class="relative group inline-block">
                        <img
                            src="../static/picture/mail.png"
                            alt="ÂØÑ‰ø°ÂúñÁ§∫"
                            class="w-8 h-8 object-contain cursor-pointer hover:scale-110 transition-transform"
                            @click="sendItemEmail"
                        />
                        <div
                            class="absolute top-full left-1/2 -translate-x-1/2 mt-2 px-4 py-2 bg-white text-gray-800 text-sm rounded-lg shadow-lg border z-50 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap"
                        >
                            üìß Âø´ÈÄüÂØÑÈÄÅÁ∞ΩÊ†∏‰ø°‰ª∂ÔºåÊèêÈÜíÁ∂ìÁêÜÁ∞ΩÊ†∏Ê≠§Ë´ãË≥ºÈ†ÖÁõÆ
                        </div>
                    </div>

                    <!-- Â∏∏Áî®ÊñáÂ≠óÂúñÁ§∫ -->
                    <div v-if="admins.includes(username)" class="relative group inline-block">
                        <img
                            src="../static/picture/can.png"
                            alt="Â∏∏Áî®ÊñáÂ≠óÂúñÁ§∫"
                            class="w-8 h-8 object-contain cursor-pointer hover:scale-110 transition-transform"
                            @click="copyCantext"
                        />
                        <div
                            class="absolute top-full left-1/2 -translate-x-1/2 mt-2 px-4 py-2 bg-white text-gray-800 text-sm rounded-lg shadow-lg border z-50 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap"
                        >
                        üìù Â•óÁî®Â∏∏Ë¶ãÂÇôË®ªÂÖßÂÆπÔºå‰æõÊé°Ë≥ºËÄÖ‰ΩøÁî®Âø´ÈÄüË§áË£ΩÁΩêÈ†≠Ë®äÊÅØ
                        </div>
                    </div>
                </h2>
                <div class="relative w-full text-center mt-4">
                    <!-- ÁΩÆ‰∏≠ÊñáÂ≠ó -->
                    <p class="text-sm text-gray-500">
                        <span class="text-red-500">*</span> Â≠óËôüÁÇ∫ÁÆ°ÁêÜÂì°ÈÅ∏Â°´ÔºåÂÖ∂È§ò‰∫∫ÁÑ°Ê¨äÈôê
                    </p>

                    <!-- Âè≥ÂÅ¥Âõ∫ÂÆöÁöÑ Radio + Select + Input -->
                    <div class="mt-2 flex justify-end items-center gap-3">
                        
                        <!-- Radio ÂçÄÂ°ä -->
                        <div class="flex gap-2">
                            <label class="flex items-center gap-1 cursor-pointer text-xs">
                                <input type="radio" name="settingType" value="none" v-model="settingType"  class="w-3 h-3 text-blue-500 focus:ring-blue-400" checked>
                                <span class="text-gray-700">ÁÑ°ÊåáÂÆöÈ†êË®≠</span>
                            </label>
                            <label class="flex items-center gap-1 cursor-pointer text-xs">
                                <input type="radio" name="settingType" value="cooperate" v-model="settingType"  class="w-3 h-3 text-blue-500 focus:ring-blue-400">
                                <span class="text-gray-700">Âêà‰ΩúÈñãÁôº</span>
                            </label>
                            <label class="flex items-center gap-1 cursor-pointer text-xs">
                                <input type="radio" name="settingType" value="suggestion" v-model="settingType" class="w-3 h-3 text-blue-500 focus:ring-blue-400">
                                <span class="text-gray-700">Âª∫Ë≠∞Âª†ÂïÜ</span>
                            </label>
                        </div>

                        <!-- Select Âª†ÂïÜ -->
                        <select 
                            v-model="selectedVender" 
                            :disabled="settingType === 'none'"
                            class="border border-gray-300 rounded px-2 py-0.5 text-xs focus:outline-none focus:ring-2 focus:ring-blue-400"
                            >
                            <option disabled value="">Ë´ãÈÅ∏ÊìáÂª†ÂïÜ</option>
                            <option v-for="v in venders" :key="v" :value="v">
                                {{ v }}
                            </option>
                        </select>

                        <!-- Âè≥ÂÅ¥Ëº∏ÂÖ•Ê°Ü -->
                        <input 
                            v-model="lasteprno"
                            type="text" 
                            placeholder="ÂâçË≥ºÂñÆËôü(ePR No. Or PO No.)"
                            class="border border-gray-300 rounded px-2 py-0.5 text-xs w-60 focus:outline-none focus:ring-2 focus:ring-blue-400"
                        />
                    </div>
                </div>


                <!-- ÂàÜ‰∫îÂàó -->
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
                    <div v-for="(label, key) in editableFields" :key="key" >
                        <label class="block text-sm font-semibold text-gray-700 mb-1">
                            <template v-if="key === 'ePR No.'">
                                ePR No.ÔºàÊ†ºÂºèÔºöYYMMDD+4Á¢ºÊµÅÊ∞¥ËôüÔºâ <span class="text-red-500 mr-1">*</span>
                            </template>
                            <template v-else>
                                {{ label }}
                            </template>
                        </label>

                        <!-- ÈúÄÊ±ÇÊó•ÔºöÈ°ØÁ§∫ + ÁúüÊ≠£Ëº∏ÂÖ• -->
                        <input
                            v-if="key === 'ÈúÄÊ±ÇÊó•'"
                            :value="formatDateInput(editItemData[key])"
                            @input="editItemData[key] = $event.target.value.replace(/-/g, '')"
                            type="date"
                            class="w-full border border-gray-300 px-3 py-2 rounded text-sm bg-gray-100 text-gray-700"
                        />


                        <!-- ‰∏ãÊãâÈÅ∏ÂñÆÔºöÈúÄÊ±ÇËÄÖ -->
                        <select
                            v-else-if="key === 'ÈúÄÊ±ÇËÄÖ'"
                            v-model="editItemData[key]"
                            class="w-full border border-gray-300 px-3 py-2 rounded text-sm bg-gray-100 text-gray-700"
                            >
                            <option disabled value="">Ë´ãÈÅ∏ÊìáÈúÄÊ±ÇËÄÖ</option>
                            <option v-for="p in requesters" :key="p" :value="p">{{ p }}</option>
                        </select>

                        <input
                            v-else-if="key === 'ePR No.'"
                            v-model="editItemData[key]"
                            @input="handleEPRChangeEdit"
                            class="w-full border border-gray-300 px-3 py-2 rounded text-sm bg-gray-100 text-gray-700"
                        />

                        <!-- Ë´ãË≥ºÈ†ÜÂ∫è -->
                        <textarea
                            v-else-if="key === 'Ë´ãË≥ºÈ†ÜÂ∫è'"
                            v-model="editItemData[key]"
                            :placeholder="`1 Ë∂ÖÊÄ•‰ª∂\n2 ÊÄ•‰ª∂\n3 ‰∏ÄËà¨‰ª∂`"
                            @focus="editItemData[key] === '' ? editItemData[key] = '' : null"
                            rows="3"
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40 whitespace-pre-line"
                        ></textarea>

                        <textarea
                            v-else-if="key==='Â∑≤ÈñãÂñÆÊó•Êúü'"
                            v-model="editItemData[key]"
                            rows="2"
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40"
                            readonly
                        ></textarea>

                        <textarea
                            v-else-if="key==='ÈÄ≤Â∫¶ËøΩËπ§Ë∂ÖÈÄ£Áµê'"
                            v-model="editItemData[key]"
                            rows="2"
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40"
                            readonly
                        ></textarea>

                        <input
                            v-else-if="key === 'Á∏ΩÈáëÈ°ç'"
                            :value="formatNumber(editItemData[key])"
                            readonly
                            class="w-full border border-gray-300 px-3 py-2 rounded text-sm bg-gray-100 text-gray-700"
                        />

                        <textarea
                            v-else-if="key==='Ë´ãË≥ºÈ†ÖÁõÆ'"
                            v-model="editItemData[key]"
                            rows="2"
                            @paste="handlePaste($event, editItemData, key)"
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40"
                        ></textarea>

                        <textarea
                            v-else-if="key==='ÈúÄÊ±ÇÂéüÂõ†'"
                            v-model="editItemData[key]"
                            rows="2"
                            @paste="handlePaste($event, editItemData, key)"
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40"
                        ></textarea>

                        <textarea
                            v-else-if="key==='Â†±ÂëäË∑ØÂæë'"
                            v-model="editItemData[key]"
                            rows="2"
                            @paste="handlePaste($event, editItemData, key)"
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40"
                        ></textarea>

                        <textarea
                            v-else-if="key==='Â†±ÂëäË∑ØÂæë'"
                            v-model="editItemData[key]"
                            rows="2"
                            @paste="handlePaste($event, editItemData, key)"
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40"
                        ></textarea>

                        <textarea
                            v-else-if="key==='È©óÊî∂Ë∑ØÂæë'"
                            v-model="editItemData[key]"
                            rows="2"
                            @paste="handlePaste($event, editItemData, key)"
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40"
                        ></textarea>

                        <!-- ÂÖ∂‰ªñÊ¨Ñ‰Ωç -->
                        <textarea
                            v-else
                            v-model="editItemData[key]"
                            rows="2"
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40"
                        ></textarea>
                    </div>
                </div>


                <!-- Á¥∞È†ÖË≥áÊñôË°®Ê†º -->
                <div class="mt-4 border border-gray-300 rounded-lg shadow overflow-x-auto">
                    <table class="min-w-full table-auto text-sm border bg-white rounded shadow">
                        <thead class="bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 text-sm font-semibold sticky top-0 z-10">
                            <tr>
                                <th
                                    v-for="field in detailTableFields"
                                    :key="field.key"
                                    class="border px-4 py-2 text-left align-top whitespace-pre-wrap break-words"
                                >
                                    {{ field.label }}
                                </th>
                                <th class="border px-4 py-2 text-left align-top whitespace-pre-wrap break-words">‚öôÔ∏è Êìç‰Ωú</th>
                            </tr>
                        </thead>

                        <tbody>
                            <tr
                                v-for="(row, index) in editTableRows"
                                :key="index"
                                class="hover:bg-gray-50"
                            >
                                <td
                                    v-for="field in detailTableFields"
                                    :key="field.key"
                                    class="border px-2 py-1 align-top text-left whitespace-pre-wrap break-words"
                                    >
                                    <!-- ‚úÖ ‰ΩøÁî® textarea ËôïÁêÜÂìÅÈ†ÖÊ¨Ñ‰Ωç -->
                                    <textarea
                                        v-if="row.isEditing && field.key === 'ÂìÅÈ†Ö'"
                                        :value="getDisplayValue(row, field.key)"
                                        @input="handleCellInput($event, row, field.key, { recalculateTotal: true }); handleItemLimit(row)"
                                        @keydown="preventTypingOverLimit($event, row)"
                                        @paste="handlePaste($event, row, 'ÂìÅÈ†Ö')"
                                        rows="2"
                                        class="w-full px-1 py-1 border rounded text-sm resize-y"
                                        style="word-break: break-word; white-space: pre-wrap;"
                                    ></textarea>
                                    <textarea
                                        v-else-if="row.isEditing && field.key === 'Ë¶èÊ†º'"
                                        v-model="row['Ë¶èÊ†º']"
                                        @paste="handlePaste($event, row, 'Ë¶èÊ†º')"
                                        rows="2"
                                        class="w-full px-1 py-1 border rounded text-sm resize-y"
                                        style="word-break: break-word; white-space: pre-wrap;"
                                    ></textarea>
                                    <input 
                                        v-else-if="row.isEditing && field.key === 'Êï∏Èáè'"
                                        v-model="row['Êï∏Èáè']" 
                                        @blur="formatField(row, 'Êï∏Èáè', 'edit')"
                                        class="w-full px-1 py-1 border rounded text-sm text-left"
                                        style="word-break: break-word; white-space: pre-wrap;"
                                    />
                                    <input 
                                        v-else-if="row.isEditing && field.key === 'ÂñÆÂÉπ'"
                                        v-model="row['ÂñÆÂÉπ']" 
                                        @blur="formatField(row, 'ÂñÆÂÉπ', 'edit')"
                                        class="w-full px-1 py-1 border rounded text-sm text-left"
                                        style="word-break: break-word; white-space: pre-wrap;"
                                    />
                                    <input 
                                        v-else-if="row.isEditing && field.key === 'RTÈáëÈ°ç'"
                                        v-model="row['RTÈáëÈ°ç']" 
                                        @blur="formatField(row, 'RTÈáëÈ°ç', 'edit')"
                                        class="w-full px-1 py-1 border rounded text-sm text-left"
                                        style="word-break: break-word; white-space: pre-wrap;"
                                    />
                                    <input 
                                        v-else-if="row.isEditing && field.key === 'RTÁ∏ΩÈáëÈ°ç'"
                                        v-model="row['RTÁ∏ΩÈáëÈ°ç']" 
                                        @blur="formatField(row, 'RTÁ∏ΩÈáëÈ°ç', 'edit')"
                                        class="w-full px-1 py-1 border rounded text-sm text-left"
                                        style="word-break: break-word; white-space: pre-wrap;"
                                    />
                                    <input 
                                        v-else-if="row.isEditing && field.key === 'Á∏ΩÊï∏'"
                                        v-model="row['Á∏ΩÊï∏']" 
                                        @blur="formatField(row, 'Á∏ΩÊï∏', 'edit')"
                                        class="w-full px-1 py-1 border rounded text-sm text-left"
                                        style="word-break: break-word; white-space: pre-wrap;"
                                    />
                                    <textarea
                                        v-else-if="row.isEditing && field.key === 'ÂÇôË®ª'"
                                        v-model="row['ÂÇôË®ª']"
                                        @paste="handlePaste($event, row, 'ÂÇôË®ª')"
                                        rows="2"
                                        class="w-full px-1 py-1 border rounded text-sm resize-y"
                                        style="word-break: break-word; white-space: pre-wrap;"
                                    ></textarea>
                                    <input
                                        v-else-if="row.isEditing"
                                        :value="getDisplayValue(row, field.key)"
                                        @input="handleCellInput($event, row, field.key, { recalculateTotal: true })"
                                        :readonly="field.key === 'Á∏ΩÂÉπ'"
                                        class="w-full px-1 py-1 border rounded text-sm"
                                        style="word-break: break-word; white-space: pre-wrap;"
                                    />
                                    <input
                                        v-else-if="row.isEditing"
                                        :value="getDisplayValue(row, field.key)"
                                        :readonly="field.key === 'Delivery Date Âª†ÂïÜÊâøË´æ‰∫§Êúü'"
                                        class="w-full px-1 py-1 border rounded text-sm"
                                        style="word-break: break-word; white-space: pre-wrap;"
                                    />
                                    <input
                                        v-else-if="row.isEditing"
                                        :value="getDisplayValue(row, field.key)"
                                        :readonly="field.key === 'SOD Qty Âª†ÂïÜÊâøË´æÊï∏Èáè'"
                                        class="w-full px-1 py-1 border rounded text-sm"
                                        style="word-break: break-word; white-space: pre-wrap;"
                                    />
                                    <span
                                        v-else
                                            class="block text-sm whitespace-pre-wrap break-words leading-normal"
                                            style="min-height: 2.5rem; word-break: break-word;"
                                        >
                                        {{ ['ÂñÆÂÉπ', 'Êï∏Èáè', 'Á∏ΩÂÉπ', 'Á∏ΩÊï∏', "RTÈáëÈ°ç", "RTÁ∏ΩÈáëÈ°ç"].includes(field.key) ? formatNumber(row[field.key]) : row[field.key] }}
                                    </span>
                                </td>
                                <td class="border px-2 py-1 align-top">
                                    <div class="flex flex-col items-center justify-center gap-0.5">
                                        <template v-if="!row.isEditing">
                                            <button @click="startRowEdit(row)" class="text-blue-600 font-bold hover:underline">‚úèÔ∏è</button>
                                        </template>
                                        <template v-else>
                                            <button @click="finishRowEdit(row, 'edit')" class="text-green-600 font-bold hover:underline">‚úîÔ∏è</button>
                                            <button @click="cancelRowEdit(row, index)" class="text-yellow-600 font-bold hover:underline">‚ùå</button>
                                            <button @click="deleteRowEdit(index, 'edit')" class="text-red-600 font-bold hover:underline">üóëÔ∏è</button>
                                        </template>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <!-- Âú®Ë°®Ê†ºÂ∫ï‰∏ãÂä†ÈÄôÊÆµ -->
                    <div class="sticky bottom-0 bg-white border-t border-gray-200 px-4 py-2 flex justify-end z-20">
                        <button
                            @click="addNewEditRow"
                            class="bg-blue-600 text-white px-4 py-1.5 rounded hover:bg-blue-700 text-sm font-semibold shadow"
                        >
                            ‚ûï Êñ∞Â¢û‰∏ÄÁ≠Ü
                        </button>
                    </div>
                </div>

                <!-- Â∫ïÈÉ®ÊåâÈàï -->
                <div class="flex justify-end gap-4 pt-4">
                    <button @click="cancelEdit" class="bg-gray-400 hover:bg-gray-500 text-white font-semibold px-6 py-2 rounded-lg transition">
                        ÂèñÊ∂à
                    </button>
                    <button @click="saveEdit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2 rounded-lg transition">
                        üíæ ÂÑ≤Â≠ò
                    </button>
                </div>
            </div>
        </div>


        <!-- Êñ∞Â¢ûÂç°Áâá UI -->
        <div v-if="showNewItemModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 overflow-y-auto py-10 px-4">
            <div class="relative bg-white w-full max-w-full rounded-xl shadow-xl p-6 space-y-6 mx-auto">
                <h2 class="text-3xl font-bold text-gray-800 text-center border-b pb-3">
                    Êñ∞Â¢ûË´ãË≥ºË≥áÊñô
                    <span class="text-red-500 ml-2 text-xl align-middle">*</span>
                </h2>

                <div class="relative w-full text-center mt-4">
                    <!-- ÁΩÆ‰∏≠ÊñáÂ≠ó -->
                    <p class="text-sm text-gray-500">
                        <span class="text-red-500">*</span> Â≠óËôüÁÇ∫ÁÆ°ÁêÜÂì°ÈÅ∏Â°´ÔºåÂÖ∂È§ò‰∫∫ÁÑ°Ê¨äÈôê
                    </p>

                    <!-- Âè≥ÂÅ¥Âõ∫ÂÆöÁöÑ Radio + Select + Input -->
                    <div class="mt-2 flex justify-end items-center gap-3">
                        
                        <!-- Radio ÂçÄÂ°ä -->
                        <div class="flex gap-2">
                            <label class="flex items-center gap-1 cursor-pointer text-xs">
                                <input type="radio" name="settingType" value="none" v-model="settingType"  class="w-3 h-3 text-blue-500 focus:ring-blue-400" checked>
                                <span class="text-gray-700">ÁÑ°ÊåáÂÆöÈ†êË®≠</span>
                            </label>
                            <label class="flex items-center gap-1 cursor-pointer text-xs">
                                <input type="radio" name="settingType" value="cooperate" v-model="settingType"  class="w-3 h-3 text-blue-500 focus:ring-blue-400">
                                <span class="text-gray-700">Âêà‰ΩúÈñãÁôº</span>
                            </label>
                            <label class="flex items-center gap-1 cursor-pointer text-xs">
                                <input type="radio" name="settingType" value="suggestion" v-model="settingType" class="w-3 h-3 text-blue-500 focus:ring-blue-400">
                                <span class="text-gray-700">Âª∫Ë≠∞Âª†ÂïÜ</span>
                            </label>
                        </div>

                        <!-- Select Âª†ÂïÜ -->
                        <select 
                            v-model="selectedVender" 
                            :disabled="settingType === 'none'"
                            class="border border-gray-300 rounded px-2 py-0.5 text-xs focus:outline-none focus:ring-2 focus:ring-blue-400"
                            >
                            <option disabled value="">Ë´ãÈÅ∏ÊìáÂª†ÂïÜ</option>
                            <option v-for="v in venders" :key="v" :value="v">
                                {{ v }}
                            </option>
                        </select>

                        <!-- Âè≥ÂÅ¥Ëº∏ÂÖ•Ê°Ü -->
                        <input 
                            v-model="lasteprno"
                            type="text" 
                            placeholder="ÂâçË≥ºÂñÆËôü(ePR No. Or PO No.)"
                            class="border border-gray-300 rounded px-2 py-0.5 text-xs w-60 focus:outline-none focus:ring-2 focus:ring-blue-400"
                        />
                    </div>
                </div>

                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
                    <div v-for="(label, key) in editableFields" :key="key">
                        <label class="block text-sm font-semibold text-gray-700 mb-1">
                            <template v-if="key === 'ePR No.'">
                                ePR No.ÔºàÊ†ºÂºèÔºöYYMMDD+4Á¢ºÊµÅÊ∞¥ËôüÔºâ <span class="text-red-500 mr-1">*</span>
                            </template>
                            <template v-else>
                                {{ label }}
                            </template>
                        </label>


                        <input
                            v-if="key === 'ÈúÄÊ±ÇÊó•'"
                            :value="newItem[key]"
                            readonly
                            class="w-full border border-gray-300 px-3 py-2 rounded text-sm bg-gray-100"
                        />
                        <input
                            v-if="key === 'ÈúÄÊ±ÇÊó•'"
                            type="date"
                            @input="handleDateInput($event.target.value)"
                            class="w-full border border-gray-300 px-3 py-2 rounded text-sm"
                        />
                        
                        <div v-else-if="key === 'ÈúÄÊ±ÇËÄÖ'" class="space-y-1 relative">
                            <input
                                v-model="newItem[key]"
                                @input="filterRequesterSuggestions"
                                @blur="hideRequesterSuggestions"
                                placeholder="Ë´ãËº∏ÂÖ•ÊàñÈÅ∏ÊìáÈúÄÊ±ÇËÄÖ"
                                class="w-full border border-gray-300 px-3 py-2 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-400"
                            />
                            <ul v-if="showRequesterSuggestions && filteredRequesters.length" class="absolute z-50 bg-white border w-full mt-1 rounded shadow text-sm max-h-40 overflow-y-auto">
                                <li
                                    v-for="(name, idx) in filteredRequesters"
                                    :key="idx"
                                    @click="selectRequester(name)"
                                    class="px-3 py-1 hover:bg-blue-100 cursor-pointer"
                                >
                                    {{ name }}
                                </li>
                            </ul>
                        </div>

                        <textarea v-else-if="key === 'Ë´ãË≥ºÈ†ÜÂ∫è'"
                            v-model="newItem[key]"
                            :placeholder="`1 Ë∂ÖÊÄ•‰ª∂\n2 ÊÄ•‰ª∂\n3 ‰∏ÄËà¨‰ª∂`"
                            @focus="newItem[key] === '' ? newItem[key] = '' : null"
                            rows="3"
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40 whitespace-pre-line"
                        ></textarea>

                        <input
                            v-else-if="key === 'Á∏ΩÈáëÈ°ç'"
                            v-model="newItem[key]"
                            readonly
                            class="w-full border border-gray-300 px-3 py-2 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-400"
                        />

                        <input
                            v-else-if="key === 'Â∑≤ÈñãÂñÆÊó•Êúü'"
                            v-model="newItem[key]"
                            class="w-full border border-gray-300 px-3 py-2 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-400"
                            readonly
                        />

                        <input
                            v-else-if="key === 'ePR No.'"
                            v-model="newItem[key]"
                            @input="handleEPRChange($event)"
                            class="w-full border border-gray-300 px-3 py-2 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-400"
                        />
                        <textarea
                            v-else-if="key === ''"
                            v-model="newItem[key]"
                            rows="2"
                            @paste="handlePaste($event, newItem, key)"
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40"
                        ></textarea>

                        <textarea
                            v-else-if="key === 'ÈÄ≤Â∫¶ËøΩËπ§Ë∂ÖÈÄ£Áµê'"
                            v-model="newItem[key]"
                            rows="2"
                            readonly
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40"
                        ></textarea>

                        <textarea
                            v-else-if="key === 'Ë´ãË≥ºÈ†ÖÁõÆ'"
                            v-model="newItem[key]"
                            rows="2"
                            @paste="handlePaste($event, newItem, key)"
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40"
                        ></textarea>

                        <textarea
                            v-else-if="key === 'ÈúÄÊ±ÇÂéüÂõ†'"
                            v-model="newItem[key]"
                            rows="2"
                            @paste="handlePaste($event, newItem, key)"
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40"
                        ></textarea>

                        <textarea
                            v-else-if="key === 'Â†±ÂëäË∑ØÂæë'"
                            v-model="newItem[key]"
                            rows="2"
                            @paste="handlePaste($event, newItem, key)"
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40"
                        ></textarea>

                        <textarea
                            v-else-if="key === 'È©óÊî∂Ë∑ØÂæë'"
                            v-model="newItem[key]"
                            rows="2"
                            readonly
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40"
                        ></textarea>

                        <textarea
                            v-else
                            v-model="newItem[key]"
                            rows="2"
                            class="w-full border border-gray-300 px-3 py-2 rounded resize-y text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 max-h-40"
                        ></textarea>
                    </div>
                </div>

                <div class="overflow-x-auto mt-6 rounded-lg shadow border border-gray-300">
                    <table class="min-w-full table-auto text-sm border bg-white rounded shadow">
                        <thead class="bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 text-sm font-semibold sticky top-0 z-10">
                            <tr>
                                <th
                                    v-for="header in tableHeaders"
                                    :key="header.key"
                                    class="border px-4 py-2 text-left align-top whitespace-pre-wrap break-words"
                                >
                                    {{ header.label }}
                                </th>
                                <th
                                    class="border px-4 py-2 text-left align-top break-words whitespace-nowrap min-w-[5rem]"
                                    >
                                ‚öôÔ∏è Êìç‰Ωú
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="(row, index) in yourTableData" :key="index" class="hover:bg-gray-50">
                                <td class="border px-2 py-1"><input v-model="row['‰∫§Ë≤®È©óË≠â']" class="w-full px-1 py-1 border rounded text-sm" /></td>
                                <td class="border px-2 py-1"><input v-model="row['ePR No.']" class="w-full px-1 py-1 border rounded text-sm" /></td>
                                <td class="border px-2 py-1"><input v-model="row['PO No.']" class="w-full px-1 py-1 border rounded text-sm" /></td>
                                <td class="border px-2 py-1"><input v-model="row.Item" class="w-full px-1 py-1 border rounded text-sm" /></td>
                                <td class="border px-2 py-1">
                                    <textarea
                                        v-model="row['ÂìÅÈ†Ö']"
                                        @input="handleItemLimit(row)"
                                        @keydown="preventTypingOverLimit($event, row)"
                                        @paste="handlePaste($event, row, 'ÂìÅÈ†Ö')"
                                        rows="2"
                                        class="w-full px-1 py-1 border rounded text-sm resize-y"
                                    ></textarea>
                                </td>
                                <td class="border px-2 py-1">
                                    <textarea 
                                        v-model="row['Ë¶èÊ†º']" 
                                        @paste="handlePaste($event, row, 'Ë¶èÊ†º')"
                                        rows="2"
                                        class="w-full px-1 py-1 border rounded text-sm resize-y"
                                    ></textarea>
                                </td>
                                <td class="border px-2 py-1">
                                    <input 
                                        v-model="row['Êï∏Èáè']" 
                                        @blur="formatField(row, 'Êï∏Èáè', 'new')"
                                        class="w-full px-1 py-1 border rounded text-sm"
                                    />
                                </td>
                                <td class="border px-2 py-1">
                                    <input 
                                        v-model="row['Á∏ΩÊï∏']" 
                                        @blur="formatField(row, 'Á∏ΩÊï∏', 'new')"
                                        class="w-full px-1 py-1 border rounded text-sm" 
                                    />
                                </td>
                                <td class="border px-2 py-1">
                                    <input 
                                        v-model="row['ÂñÆÂÉπ']"
                                        @blur="formatField(row, 'ÂñÆÂÉπ', 'new')" 
                                        class="w-full px-1 py-1 border rounded text-sm"
                                    />
                                </td>
                                <td class="border px-2 py-1">
                                    <input 
                                        :value="getDisplayValue(row, 'Á∏ΩÂÉπ')"
                                        readonly
                                        class="w-full px-1 py-1 border rounded text-sm" 
                                    />
                                </td>
                                <td class="border px-2 py-1">
                                    <textarea 
                                        v-model="row['ÂÇôË®ª']" 
                                        rows="2"
                                        class="w-full px-1 py-1 border rounded text-sm resize-y"
                                        @paste="handlePaste($event, row, 'ÂÇôË®ª')"
                                    ></textarea>
                                </td>
                                <td class="border px-2 py-1 text-center">
                                    <!-- <button @click="yourTableData.splice(index, 1)" class="text-red-600 text-lg hover:text-red-800">üóëÔ∏è</button> -->
                                    <button
                                        @click="removeNewItemRow(index)"
                                        class="text-red-600 text-lg hover:text-red-800"
                                    >
                                        üóëÔ∏è
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <!-- Âú®Ë°®Ê†ºÂ∫ï‰∏ãÂä†ÈÄôÊÆµ -->
                    <div class="sticky bottom-0 bg-white border-t border-gray-200 px-4 py-2 flex justify-end z-20">
                        <button
                            @click="addNewRow"
                            class="bg-blue-600 text-white px-4 py-1.5 rounded hover:bg-blue-700 text-sm font-semibold shadow"
                        >
                            ‚ûï Êñ∞Â¢û‰∏ÄÁ≠Ü
                        </button>
                    </div>
                </div>

                <div class="flex justify-end gap-4 pt-4">
                    <button @click="closeSaveNewItem" class="bg-gray-400 hover:bg-gray-500 text-white font-semibold px-6 py-2 rounded-lg transition">ÂèñÊ∂à</button>
                    <button @click="saveNewItem" class="bg-green-600 hover:bg-green-700 text-white font-semibold px-6 py-2 rounded-lg transition">‚úÖ Êñ∞Â¢û</button>
                </div>
            </div>
        </div>


    </div>


    <script src="../static/js/func/Planned_Purchase_Request_List.js"></script>
</body>

</html>