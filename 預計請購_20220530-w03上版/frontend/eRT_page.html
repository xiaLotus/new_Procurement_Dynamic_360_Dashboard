<!DOCTYPE html>
<html lang="zh-Hant" class="h-full">
<head>
  <meta charset="UTF-8" />
  <title>eRT È©óÊî∂Á∏ΩË°®</title>
  <script src="../static/js/vue.global.prod.js"></script>
  <script src="../static/js/axios.min.js"></script>
  <script src="../static/js/tailwinds.js"></script>
  <style>
    .fade-enter-active, .fade-leave-active {
        transition: opacity 0.3s;
    }
    .fade-enter-from, .fade-leave-to {
        opacity: 0;
    }
    .column-selector-card {
        animation: slideIn 0.3s ease-out;
    }
    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    html, body {
        height: 100%;
        overflow: hidden;
    }
    /* ...ÂÖ∂‰ªñÊ®£Âºè... */
    </style>
</head>
<body class="h-full bg-gray-100">
    <div id="app" class="h-full flex flex-col overflow-hidden">
        <!-- ÊõøÊèõ eRT_page.html ‰∏≠ÁöÑÊúÉË®àË≥áË®äÂçÄÂ°äÈÉ®ÂàÜ -->

        <div class="flex-shrink-0 px-4 h-20 flex items-center">
            <div class="w-full grid grid-cols-12 gap-4 items-center">
                <!-- Â∑¶ÂÅ¥ÔºöÊ®ôÈ°å - ‰ΩîÊìö 2 Ê¨Ñ -->
                <div class="col-span-2">
                    <div class="flex items-center justify-center h-20 w-full bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200 shadow-sm">
                        <h1 class="text-2xl font-bold text-blue-700 whitespace-nowrap">
                            üìã eRT È©óÊî∂Á∏ΩË°®
                        </h1>
                    </div>
                </div>

                <!-- ‰∏≠ÈñìÔºöÊúÉË®àË≥áË®äÂçÄÂ°ä - ‰ΩîÊìö 8 Ê¨Ñ -->
                <div class="col-span-8">
                    <div class="flex items-start justify-center gap-3 h-full">
                        <div class="flex flex-col w-52 h-20 gap-1">
                            <div @click="showUnaccountedModal = true" 
                                class="flex flex-col justify-center text-green-700 text-xs bg-green-100 px-3 py-1 rounded shadow text-center h-10 cursor-pointer hover:bg-green-200 transition-colors">
                                <label class="text-xs font-semibold text-green-800 whitespace-nowrap">
                                    üìÖ ÁõÆÂâçÂ∞öÊú™ÂÖ•Â∏≥ üí∞ {{ unaccounted_amount.toLocaleString() }} ÂÖÉ
                                </label>
                            </div>

                            <div @click="showActualAccountingModal('lastMonth')"  
                                class="flex flex-col justify-center text-blue-700 text-xs bg-blue-100 px-3 py-1 rounded shadow text-center h-10 cursor-pointer hover:bg-blue-200 transition-colors">
                                <label class="text-xs font-semibold text-blue-800 whitespace-nowrap">
                                    üí∞ ‰∏äÊúàÂØ¶ÈöõÂÖ•Â∏≥ üìÖ {{ lastmonthcurent.toLocaleString() }} ÂÖÉ
                                </label>
                            </div>
                        </div>

                        <div class="flex flex-col w-52 h-20 gap-1">
                            <div @click="showCurrentNoneModalHandler()" 
                                class="flex flex-col justify-center text-blue-700 text-xs bg-blue-100 px-3 py-1 rounded shadow text-center h-10 cursor-pointer hover:bg-blue-200 transition-colors">
                                <label class="text-xs font-semibold text-green-800 whitespace-nowrap">
                                    üìÖ Êú¨ÊúàÂ∞öÊú™ÂÖ•Â∏≥ üí∞ {{ currentNoneMonthAmount.toLocaleString() }} ÂÖÉ
                                </label>
                            </div>

                            <div @click="showActualAccountingModal('currentMonth')"  
                                class="flex flex-col justify-center text-blue-700 text-xs bg-blue-100 px-3 py-1 rounded shadow text-center h-10 cursor-pointer hover:bg-blue-200 transition-colors">
                                <label class="text-xs font-semibold text-green-800 whitespace-nowrap">
                                    üìÖ Êú¨ÊúàÂØ¶ÈöõÂÖ•Â∏≥ üí∞ {{ nowmonthcurent.toLocaleString() }} ÂÖÉ
                                </label>
                            </div>
                        </div>

                        <div class="flex flex-col w-52 h-20 gap-1">
                            <div class="flex flex-col justify-center text-orange-700 text-xs bg-orange-100 px-3 py-1 rounded shadow text-center h-10">
                                <label class="text-xs font-semibold text-orange-800 whitespace-nowrap">
                                    üéØ Êú¨ÊúàÂÖ•Ë≥¨‰∏äÈôê Max {{ maxpurchasebudget.toLocaleString() }} ÂÖÉ
                                </label>
                            </div>

                            <div class="flex flex-col justify-center text-red-700 text-xs bg-red-100 px-3 py-1 rounded shadow text-center h-10">
                                <label class="text-xs font-semibold text-red-800 whitespace-nowrap">
                                    üö® ‰∏äÈôêÁÆ°Âà∂ {{ budgetControlAmount.toLocaleString() }} ÂÖÉ
                                </label>
                            </div>
                        </div>

                        <div class="flex flex-col w-52 h-20 gap-1">
                            <div class="flex flex-col justify-center text-xs px-3 py-1 rounded shadow text-center h-10"
                                :class="{
                                    'text-green-700 bg-green-100': currentMonthStatus === 'safe',
                                    'text-yellow-700 bg-yellow-100': currentMonthStatus === 'warning', 
                                    'text-red-700 bg-red-100': currentMonthStatus === 'danger'
                                }">
                                <label class="text-xs font-semibold"
                                    :class="{
                                        'text-green-800': currentMonthStatus === 'safe',
                                        'text-yellow-800': currentMonthStatus === 'warning',
                                        'text-red-800': currentMonthStatus === 'danger'
                                    }">
                                    <span v-if="currentMonthStatus === 'safe'">üü¢ ÂÆâÂÖ®ÁØÑÂúç</span>
                                    <span v-else-if="currentMonthStatus === 'warning'">üü° ÈªÉÁáàË≠¶Á§∫</span>
                                    <span v-else>üî¥ Á¥ÖÁáàË≠¶Á§∫</span>
                                </label>
                            </div>

                            <div class="flex flex-col justify-center text-purple-700 text-xs bg-purple-100 px-3 py-1 rounded shadow text-center h-10">
                                <label v-if="currentMonthBalance !== undefined" class="text-xs font-semibold text-purple-800 whitespace-nowrap">
                                    üí∞ Êú¨ÊúàÂÖ•Â∏≥È§òÈ°ç {{ currentMonthBalance.toLocaleString() }} ÂÖÉ
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Âè≥ÂÅ¥ÔºöÊêúÂ∞ãÊ°ÜÂíåÊ¨Ñ‰ΩçÈÅ∏ÊìáÂô® - ‰ΩîÊìö 2 Ê¨Ñ -->
                <div class="col-span-2 flex items-center justify-end gap-3">
                    <!-- ÊêúÂ∞ãÊ°Ü -->
                    <div class="relative">
                        <input
                            v-model="globalSearch"
                            type="text"
                            placeholder="üîç ÂÖ®Ê¨Ñ‰ΩçÊ®°Á≥äÊêúÂ∞ã"
                            class="w-80 px-4 py-2 pr-10 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"
                        />
                        <svg class="absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                    </div>
                    
                    <!-- Ê¨Ñ‰ΩçÈÅ∏ÊìáÂô®ÊåâÈàï -->
                    <div class="relative" ref="columnSelectorRef">
                        <button
                            @click="toggleColumnSelector"
                            class="flex items-center justify-center w-12 h-12 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg shadow-lg transition-all duration-200 transform hover:scale-105 hover:shadow-xl"
                            title="ÈÅ∏ÊìáÈ°ØÁ§∫Ê¨Ñ‰Ωç"
                        >
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 10h16M4 14h16M4 18h16" />
                            </svg>
                        </button>

                        <!-- Ê¨Ñ‰ΩçÈÅ∏ÊìáÂô®Âç°Áâá -->
                        <transition name="fade">
                            <div v-if="showColumnSelector"
                                class="column-selector-card absolute top-12 right-0 w-80 bg-white rounded-lg shadow-2xl border border-gray-200 z-50 max-h-96 overflow-hidden">
                                
                                <!-- Âç°ÁâáÊ®ôÈ°å -->
                                <div class="bg-gradient-to-r from-indigo-500 to-indigo-600 text-white px-4 py-3 rounded-t-lg">
                                    <h3 class="text-lg font-semibold flex items-center gap-2">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                        </svg>
                                        ÈÅ∏ÊìáÈ°ØÁ§∫Ê¨Ñ‰Ωç
                                    </h3>
                                </div>

                                <!-- Êìç‰ΩúÊåâÈàïÂçÄ -->
                                <div class="px-4 py-2 border-b bg-gray-50 flex justify-between items-center">
                                    <button
                                        @click="selectAllColumns"
                                        class="px-3 py-1 text-xs bg-green-500 hover:bg-green-600 text-white rounded transition-colors"
                                    >
                                        ÂÖ®ÈÅ∏
                                    </button>
                                    <button
                                        @click="deselectAllColumns"
                                        class="px-3 py-1 text-xs bg-red-500 hover:bg-red-600 text-white rounded transition-colors"
                                    >
                                        ÂÖ®‰∏çÈÅ∏
                                    </button>
                                    <button
                                        @click="resetDefaultColumns"
                                        class="px-3 py-1 text-xs bg-blue-500 hover:bg-blue-600 text-white rounded transition-colors"
                                    >
                                        ÈáçÁΩÆÈ†êË®≠
                                    </button>
                                </div>

                                <!-- Ê¨Ñ‰ΩçÈÅ∏ÊìáÂàóË°® -->
                                <div class="max-h-72 overflow-y-auto p-4">
                                    <div class="grid grid-cols-1 gap-2">
                                        <label 
                                            v-for="(header, index) in tableHeaders" 
                                            :key="header"
                                            class="flex items-center gap-3 p-2 rounded hover:bg-gray-50 cursor-pointer transition-colors"
                                        >
                                            <input 
                                                type="checkbox" 
                                                :checked="visibleColumns.includes(header)"
                                                @change="toggleColumn(header)"
                                                class="w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"
                                            />
                                            <span class="text-sm text-gray-700 font-medium">{{ header }}</span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Â∫ïÈÉ®Ë™™Êòé -->
                                <div class="px-4 py-2 bg-gray-50 text-xs text-gray-500 text-center border-t rounded-b-lg">
                                    Â∑≤ÈÅ∏Êìá {{ visibleColumns.length }} / {{ tableHeaders.length }} ÂÄãÊ¨Ñ‰Ωç
                                </div>
                            </div>
                        </transition>
                    </div>
                </div>

            </div>
        </div>


        <!-- ‰∏≠ÈñìË°®Ê†º -->
        <div class="flex-1 px-2 pb-1 overflow-hidden">
            <div class="w-full h-full overflow-auto bg-white shadow-md rounded-lg border-4 border-gray-300">
                <!-- Áï∂Ê≤íÊúâÈÅ∏Êìá‰ªª‰ΩïÊ¨Ñ‰ΩçÊôÇÈ°ØÁ§∫ÊèêÁ§∫Ë®äÊÅØ -->
                <div v-show="visibleColumns.length === 0" class="flex items-center justify-center h-full">
                    <div class="text-center p-8">
                        <svg class="w-20 h-20 mx-auto mb-4 text-gray-400" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                        </svg>
                        <p class="text-2xl font-semibold text-gray-700 mb-3">Ë´ãÈÅ∏ÊìáË¶ÅÈ°ØÁ§∫ÁöÑÊ¨Ñ‰Ωç</p>
                        <p class="text-base text-gray-500 mb-6">ÈªûÊìäÂè≥‰∏äËßíÁöÑ 
                            <span class="inline-flex items-center justify-center w-6 h-6 bg-indigo-600 text-white rounded-full mx-1">
                                <svg class="w-3 h-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 10h16M4 14h16M4 18h16" />
                                </svg>
                            </span>
                            ÊåâÈàï‰æÜÈÅ∏ÊìáË¶ÅÈ°ØÁ§∫ÁöÑË≥áÊñôÊ¨Ñ‰Ωç
                        </p>
                        <div class="flex gap-3 justify-center">
                            <button 
                                @click="resetDefaultColumns"
                                class="px-6 py-2.5 bg-blue-500 hover:bg-blue-600 text-white font-medium rounded-lg transition-colors shadow-md hover:shadow-lg"
                            >
                                ËºâÂÖ•È†êË®≠Ê¨Ñ‰Ωç
                            </button>
                            <button 
                                @click="selectAllColumns"
                                class="px-6 py-2.5 bg-green-500 hover:bg-green-600 text-white font-medium rounded-lg transition-colors shadow-md hover:shadow-lg"
                            >
                                È°ØÁ§∫ÊâÄÊúâÊ¨Ñ‰Ωç
                            </button>
                        </div>
                    </div>
                </div>
            
                <table v-show="visibleColumns.length > 0" class="w-full text-sm border border-gray-300">
                    <thead class="bg-blue-100 text-gray-800 sticky top-0 z-10">
                        <tr>
                            <!-- ‰∫§Ë≤®È©óË≠â -->
                            <th v-if="visibleColumns.includes('‰∫§Ë≤®È©óË≠â')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="ACCEPTANCEFilter">
                                    <div @click="toggleDropdown('showAcceptanceFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>‰∫§Ë≤®È©óË≠â</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showAcceptanceFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showAcceptanceFilter"
                                            class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="acceptance in uniqueAcceptance" 
                                                    :key="acceptance" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                    >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="acceptance" 
                                                        v-model="checkedAcceptances" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ acceptance }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedAcceptances = []; showAcceptanceFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- È©óÊî∂ÁãÄÊÖã -->
                            <th v-if="visibleColumns.includes('È©óÊî∂ÁãÄÊÖã')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <span>È©óÊî∂ÁãÄÊÖã</span>
                            </th>

                            <!-- ePR No. -->
                            <th v-if="visibleColumns.includes('ePR No.')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="EPRFilter">
                                    <div @click="toggleDropdown('showEPRFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>ePR No.</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showEPRFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showEPRFilter"
                                            class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="epr in uniqueEpr" 
                                                    :key="epr" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                    >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="epr" 
                                                        v-model="checkedEPRs" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ epr }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedEPRs = []; showEPRFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- PO No. -->
                            <th v-if="visibleColumns.includes('PO No.')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="POFilter">
                                    <div @click="toggleDropdown('showPOFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>PO No.</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showPOFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showPOFilter"
                                            class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="po in uniquePo" 
                                                    :key="po" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                    >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="po" 
                                                        v-model="checkedPOs" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ po }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedPOs = []; showPOFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- Item -->
                            <th v-if="visibleColumns.includes('Item')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="ITEMFilter">
                                    <div @click="toggleDropdown('showITEMFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>Item</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showITEMFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showITEMFilter"
                                            class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="item in uniqueItem" 
                                                    :key="item" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                    >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="item" 
                                                        v-model="checkedItems" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ item }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedItems = []; showITEMFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- ÂìÅÈ†Ö -->
                            <th v-if="visibleColumns.includes('ÂìÅÈ†Ö')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="NAMEFilter">
                                    <div @click="toggleDropdown('showNAMEFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>ÂìÅÈ†Ö</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showNAMEFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showNAMEFilter"
                                            class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="name in uniqueName" 
                                                    :key="name" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="name" 
                                                        v-model="checkedNames" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ name }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedNames = []; showNAMEFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- Ë¶èÊ†º -->
                            <th v-if="visibleColumns.includes('Ë¶èÊ†º')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="SPECFilter">
                                    <div @click="toggleDropdown('showSPECFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>Ë¶èÊ†º</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showSPECFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showSPECFilter"
                                            class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="spec in uniqueSpec" 
                                                    :key="spec" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                    >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="spec" 
                                                        v-model="checkedSpecs" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ spec }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedSpecs = []; showSPECFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- Êï∏Èáè -->
                            <th v-if="visibleColumns.includes('Êï∏Èáè')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="QTYFilter">
                                    <div @click="toggleDropdown('showQTYFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>Êï∏Èáè</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showQTYFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showQTYFilter"
                                            class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="qty in uniqueQty" 
                                                    :key="qty" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                    >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="qty" 
                                                        v-model="checkedQtys" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ qty }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedQtys = []; showQTYFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- Á∏ΩÊï∏ -->
                            <th v-if="visibleColumns.includes('Á∏ΩÊï∏')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="TOTALQTYFilter">
                                    <div @click="toggleDropdown('showTOTALQTYFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>Á∏ΩÊï∏</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showTOTALQTYFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showTOTALQTYFilter"
                                            class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="totalqty in uniqueTotalQty" 
                                                    :key="totalqty" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                    >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="totalqty" 
                                                        v-model="checkedTotalQtys" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ totalqty }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedTotalQtys = []; showTOTALQTYFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- ÂñÆÂÉπ -->
                            <th v-if="visibleColumns.includes('ÂñÆÂÉπ')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="PRICEFilter">
                                    <div @click="toggleDropdown('showPRICEFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>ÂñÆÂÉπ</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showPRICEFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showPRICEFilter"
                                            class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="price in uniquePrice" 
                                                    :key="price" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                    >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="price" 
                                                        v-model="checkedPrices" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ price }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedPrices = []; showPRICEFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- Á∏ΩÂÉπ -->
                            <th v-if="visibleColumns.includes('Á∏ΩÂÉπ')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="TOTALFilter">
                                    <div @click="toggleDropdown('showTOTALFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>Á∏ΩÂÉπ</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showTOTALFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showTOTALFilter"
                                            class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="total in uniqueTotal" 
                                                    :key="total" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                    >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="total" 
                                                        v-model="checkedTotals" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ total }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedTotals = []; showTOTALFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- RTÈáëÈ°ç -->
                            <th v-if="visibleColumns.includes('RTÈáëÈ°ç')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <span>RTÈáëÈ°ç</span>
                            </th>

                            <!-- RTÁ∏ΩÈáëÈ°ç -->
                            <th v-if="visibleColumns.includes('RTÁ∏ΩÈáëÈ°ç')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <span>RTÁ∏ΩÈáëÈ°ç</span>
                            </th>

                            <!-- ÂÇôË®ª -->
                            <th v-if="visibleColumns.includes('ÂÇôË®ª')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="REMARKFilter">
                                    <div @click="toggleDropdown('showREMARKFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>ÂÇôË®ª</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showREMARKFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showREMARKFilter"
                                            class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="remark in uniqueRemark" 
                                                    :key="remark" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                    >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="remark" 
                                                        v-model="checkedRemarks" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ remark }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedRemarks = []; showREMARKFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- Delivery Date Âª†ÂïÜÊâøË´æ‰∫§Êúü -->
                            <th v-if="visibleColumns.includes('Delivery Date Âª†ÂïÜÊâøË´æ‰∫§Êúü')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="DELIVERYFilter">
                                    <div @click="toggleDropdown('showDELIVERYFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>Âª†ÂïÜÊâøË´æ‰∫§Êúü</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showDELIVERYFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showDELIVERYFilter"
                                            class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="delivery in uniqueDelivery" 
                                                    :key="delivery" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                    >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="delivery" 
                                                        v-model="checkedDeliverys" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ delivery }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedDeliverys = []; showDELIVERYFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- SOD Qty Âª†ÂïÜÊâøË´æÊï∏Èáè -->
                            <th v-if="visibleColumns.includes('SOD Qty Âª†ÂïÜÊâøË´æÊï∏Èáè')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="SODFilter">
                                    <div @click="toggleDropdown('showSODFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>Âª†ÂïÜÊâøË´æÊï∏Èáè</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showSODFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showSODFilter"
                                            class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="sod in uniqueSod" 
                                                    :key="sod" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                    >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="sod" 
                                                        v-model="checkedSods" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ sod }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedSods = []; showSODFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- È©óÊî∂Êï∏Èáè -->
                            <th v-if="visibleColumns.includes('È©óÊî∂Êï∏Èáè')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="ACCEPTFilter">
                                    <div @click="toggleDropdown('showACCEPTFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>È©óÊî∂Êï∏Èáè</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showACCEPTFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showACCEPTFilter"
                                            class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="accept in uniqueAccept" 
                                                    :key="accept" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                    >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="accept" 
                                                        v-model="checkedAccepts" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ accept }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedAccepts = []; showACCEPTFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- ÊãíÊî∂Êï∏Èáè -->
                            <th v-if="visibleColumns.includes('ÊãíÊî∂Êï∏Èáè')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="REJECTFilter">
                                    <div @click="toggleDropdown('showREJECTFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>ÊãíÊî∂Êï∏Èáè</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showREJECTFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showREJECTFilter"
                                            class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="reject in uniqueReject" 
                                                    :key="reject" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                    >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="reject" 
                                                        v-model="checkedRejects" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ reject }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedRejects = []; showREJECTFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- ÁôºÁ•®Êúà‰ªΩ -->
                            <th v-if="visibleColumns.includes('ÁôºÁ•®Êúà‰ªΩ')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="INVOICEFilter">
                                    <div @click="toggleDropdown('showINVOICEFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>ÁôºÁ•®Êúà‰ªΩ</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showINVOICEFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showINVOICEFilter"
                                            class="absolute top-full right-2 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="invoice in uniqueInvoice" 
                                                    :key="invoice" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                    >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="invoice" 
                                                        v-model="checkedInvoices" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ invoice }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedInvoices = []; showINVOICEFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- WBS -->
                            <th v-if="visibleColumns.includes('WBS')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="WBSFilter">
                                    <div @click="toggleDropdown('showWBSFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>WBS</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showWBSFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showWBSFilter"
                                            class="absolute top-full left-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="wbs in uniqueWBS" 
                                                    :key="wbs" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="wbs" 
                                                        v-model="checkedWBSs" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ wbs }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedWBSs = []; showWBSFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>

                            <!-- ÈúÄÊ±ÇÊó• -->
                            <th v-if="visibleColumns.includes('ÈúÄÊ±ÇÊó•')" class="relative py-3 px-4 text-sm font-semibold text-gray-700 text-center whitespace-nowrap bg-gray-100 z-30">
                                <div ref="DEMANDDATEFilter">
                                    <div @click="toggleDropdown('showDEMANDDATEFilter')"
                                        class="cursor-pointer select-none flex items-center justify-center gap-1 hover:text-blue-600 transition">
                                        <span>ÈúÄÊ±ÇÊó•</span>
                                        <span class="text-xs transform transition-transform" :class="{ 'rotate-180': showDEMANDDATEFilter }">‚ñº</span>
                                    </div>

                                    <!-- ‰∏ãÊãâÁØ©ÈÅ∏Âç°Áâá -->
                                    <transition name="fade">
                                        <div v-if="showDEMANDDATEFilter"
                                            class="absolute top-full right-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-xl z-50 w-40 p-2 space-y-2">

                                            <!-- Ê®ôÈ°åËàáÂ•óÁî® -->
                                            <div class="flex justify-between items-center">
                                                <label class="text-sm font-medium text-gray-700">ÁØ©ÈÅ∏</label>
                                            </div>
                                            <hr class="border-gray-200" />

                                            <!-- Â§öÈÅ∏Ê∏ÖÂñÆ -->
                                            <div class="max-h-52 overflow-y-auto space-y-1">
                                                <label 
                                                    v-for="demandDate in uniqueDemandDate" 
                                                    :key="demandDate" 
                                                    class="flex items-center gap-2 cursor-pointer hover:bg-blue-50 px-2 py-1 rounded transition"
                                                >
                                                    <input 
                                                        type="checkbox" 
                                                        :value="demandDate" 
                                                        v-model="checkedDemandDates" 
                                                        class="text-blue-600 focus:ring-blue-500 rounded"
                                                    />
                                                    <span class="text-sm text-gray-700">{{ demandDate }}</span>
                                                </label>
                                            </div>

                                            <!-- Ê∏ÖÈô§ÊåâÈàï -->
                                            <div class="pt-2 text-right">
                                                <button @click="checkedDemandDates = []; showDEMANDDATEFilter = false"
                                                    class="text-gray-500 text-xs hover:text-red-500">
                                                    Ê∏ÖÈô§ÁØ©ÈÅ∏
                                                </button>
                                            </div>
                                        </div>
                                    </transition>
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-if="filteredData.length === 0">
                            <td :colspan="visibleColumns.length" class="py-8 text-center">
                                <div class="flex flex-col items-center justify-center text-gray-500">
                                    <svg class="w-12 h-12 mb-2 text-gray-400" fill="none" stroke="currentColor" stroke-width="1.5"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round"
                                        d="M9.75 9.75h.008v.008H9.75V9.75zm4.5 0h.008v.008h-.008V9.75zm-6.5 6.5A4.75 4.75 0 0112 11a4.75 4.75 0 014.75 4.75m-9.5 0h9.5M12 17v2.25" />
                                    </svg>
                                    <p class="text-lg font-semibold mb-1">Êü•ÁÑ°Ë≥áÊñô</p>
                                    <p class="text-sm text-gray-400">Ë´ãË™øÊï¥ÁØ©ÈÅ∏Ê¢ù‰ª∂ÊàñÂòóË©¶ÂÖ∂‰ªñÈóúÈçµÂ≠ó</p>
                                </div>
                            </td>
                        </tr>

                        <tr v-for="(row, index) in filteredData" :key="index">
                            <td
                                v-for="col in visibleColumns"
                                :key="col"
                                :class="[
                                    'px-3 py-2 border text-sm align-top break-words whitespace-pre-wrap',
                                    col === 'Ë¶èÊ†º' ? 'align-top' : ''
                                ]"
                                >
                                <span v-if="col === 'PO No.'" v-html="row[col]"></span>
                                <span v-else>{{ row[col] }}</span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- HTML ÂΩàÁ™óÈÉ®ÂàÜ -->
        <!-- ÁõÆÂâçÂ∞öÊú™ÂÖ•Â∏≥Â∞àÁî®ÂΩàÁ™ó -->
        <div v-if="showUnaccountedModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" @click="showUnaccountedModal = false">
            <div class="bg-white rounded-lg shadow-2xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto" @click.stop>
                <!-- ÂΩàÁ™óÊ®ôÈ°å -->
                <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white px-6 py-4 flex justify-between items-center">
                    <h2 class="text-xl font-bold flex items-center gap-2">
                        üìã ÁõÆÂâçÂ∞öÊú™ÂÖ•Â∏≥ÊòéÁ¥∞
                    </h2>
                    <button @click="showUnaccountedModal = false" class="text-white hover:text-gray-300 text-2xl font-bold">&times;</button>
                </div>

                <!-- ÂΩàÁ™óÂÖßÂÆπ -->
                <div class="p-6 overflow-y-auto max-h-[75vh]">
                    <div class="overflow-x-auto">
                        <!-- ËºâÂÖ•‰∏≠ÁãÄÊÖã -->
                        <div v-if="isLoadingDetails" class="text-center py-8">
                            <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"></div>
                            <p class="mt-2 text-gray-600">ËºâÂÖ•‰∏≠...</p>
                        </div>
                        
                        <!-- ‰∏ªË¶ÅÂÖßÂÆπ -->
                        <div v-else>
                            <div class="mb-4 text-gray-700 bg-white rounded-lg shadow p-4">
                                <!-- Á∏ΩÈáëÈ°ç -->
                                <p class="mb-2">
                                    Á∏ΩÈáëÈ°ç: 
                                    <span class="font-bold text-2xl text-green-600">
                                        {{ unaccounted_amount.toLocaleString() }} ÂÖÉ
                                    </span>
                                </p>

                                <!-- ÁØ©ÈÅ∏Ê¢ù‰ª∂ -->
                                <div class="text-sm bg-gray-50 border border-gray-200 rounded-md p-3 mb-2">
                                    <p class="font-semibold text-gray-700 mb-1">üìå ÁØ©ÈÅ∏Ê¢ù‰ª∂</p>
                                    <ul class="list-disc list-inside space-y-1 text-gray-600">
                                        <li>ÊúâÊâøË´æ‰∫§Êúü</li>
                                        <li>ÊâøË´æ‰∫§Êúü ‚â§ ‰ªäÂ§©</li>
                                        <li>Â∞öÊú™ÈñãÁôºÁ•®(ÁôºÁ•®Êúà‰ªΩÁÇ∫Á©∫)</li>
                                        <li>ÁßªÈô§WBS</li>
                                    </ul>
                                </div>

                                <!-- Ë≥áÊñôÁ≠ÜÊï∏ -->
                                <p class="text-sm text-gray-500">ÂÖ± 
                                    <span class="font-semibold text-gray-700">{{ unaccountedDetails.length }}</span> Á≠ÜË≥áÊñô
                                </p>
                            </div>
                            
                            <table class="w-full border-collapse text-sm">
                                <thead class="bg-gray-100 sticky top-0">
                                    <tr>
                                        <th class="border px-3 py-2 text-center"></th>
                                        <th class="border px-3 py-2 text-center">ePR No.</th>
                                        <th class="border px-3 py-2 text-center">PO No.</th>
                                        <th class="border px-3 py-2 text-center">Item</th>
                                        <th class="border px-3 py-2 text-center">ÂìÅÈ†Ö</th>
                                        <th class="border px-3 py-2 text-center">Á∏ΩÂÉπ</th>
                                        <th class="border px-3 py-2 text-center">RTÁ∏ΩÈáëÈ°ç</th>
                                        <th class="border px-3 py-2 text-center">ÊâøË´æ‰∫§Êúü</th>
                                        <th class="border px-3 py-2 text-center">ÁôºÁ•®Êúà‰ªΩ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="(row, idx) in unaccountedDetails" 
                                        :key="idx" 
                                        class="hover:bg-gray-50"
                                        :class="{'bg-yellow-50': !row['RTÁ∏ΩÈáëÈ°ç'] || row['RTÁ∏ΩÈáëÈ°ç'] === '0'}">
                                        <td class="border px-3 py-2 text-gray-500">{{ idx + 1 }}</td>
                                        <td class="border px-3 py-2 font-mono">{{ row['ePR No.'] || '-' }}</td>
                                        <td class="border px-3 py-2 font-mono">{{ row['PO No.'] || '-' }}</td>
                                        <td class="border px-3 py-2 font-mono">{{ row['Item'] || '-' }}</td>
                                        <td class="border px-3 py-2 font-mono">{{ row['ÂìÅÈ†Ö'] || '-' }}</td>
                                        <td class="border px-3 py-2 text-right">
                                            {{
                                                row['Á∏ΩÂÉπ']
                                                ? Number(String(row['Á∏ΩÂÉπ']).replace(/,/g, '')).toLocaleString()
                                                : '-'
                                            }}
                                        </td>
                                        <td class="border px-3 py-2 text-right font-semibold"
                                            :class="{'text-red-500': !row['RTÁ∏ΩÈáëÈ°ç'] || row['RTÁ∏ΩÈáëÈ°ç'] === '0'}">
                                            {{ row['RTÁ∏ΩÈáëÈ°ç'] ? parseInt(row['RTÁ∏ΩÈáëÈ°ç']).toLocaleString() : 'Êú™Â°´' }}
                                        </td>
                                        <td class="border px-3 py-2 text-center">{{ formatDate(row['ÊâøË´æ‰∫§Êúü']) }}</td>
                                        <td class="border px-3 py-2 text-center">{{ row['ÁôºÁ•®Êúà‰ªΩ'] || '(Á©∫)' }}</td>
                                    </tr>
                                </tbody>
                                <tfoot class="bg-gray-100 font-bold">
                                    <tr>
                                        <!-- Ââç 5 Ê¨ÑÂêà‰Ωµ (Âà∞„ÄåÁ∏ΩÂÉπ„Äç) -->
                                        <td colspan="6" class="border px-3 py-2 text-right">ÂêàË®à:</td>

                                        <!-- RTÁ∏ΩÈáëÈ°çÂêàË®à -->
                                        <td class="border px-3 py-2 text-right text-green-600">
                                            {{ unaccounted_amount.toLocaleString() }} ÂÖÉ
                                        </td>

                                        <!-- Âæå 2 Ê¨ÑÁïôÁ©∫ -->
                                        <td colspan="2" class="border px-3 py-2"></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- ÂΩàÁ™óÂ∫ïÈÉ®ÊåâÈàï -->
                <div class="bg-gray-50 px-6 py-4 flex justify-end">
                    <button @click="showUnaccountedModal = false" class="px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg">
                        ÈóúÈñâ
                    </button>
                </div>
            </div>
        </div>

        <!-- ÂΩàÁ™ó2: ‰∏äÊúà/Êú¨ÊúàÂØ¶ÈöõÂÖ•Â∏≥ÂÖ±Áî®ÂΩàÁ™ó -->
        <div v-if="showActualModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" @click="showActualModal = false">
            <div class="bg-white rounded-lg shadow-2xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-hidden" @click.stop>
                <!-- ÂãïÊÖãÊ®ôÈ°å -->
                <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white px-6 py-4 flex justify-between items-center">
                    <h2 class="text-xl font-bold flex items-center gap-2">
                        üìã {{ actualModalType === 'lastMonth' ? '‰∏äÊúàÂØ¶ÈöõÂÖ•Â∏≥ÊòéÁ¥∞' : 'Êú¨ÊúàÂØ¶ÈöõÂÖ•Â∏≥ÊòéÁ¥∞' }}
                    </h2>
                    <button @click="showActualModal = false" class="text-white hover:text-gray-300 text-2xl font-bold">&times;</button>
                </div>

                <!-- ÂΩàÁ™óÂÖßÂÆπ -->
                <div class="p-6 overflow-y-auto max-h-[75vh]">
                    <div class="overflow-x-auto">
                        <!-- ËºâÂÖ•‰∏≠ÁãÄÊÖã -->
                        <div v-if="isLoadingActual" class="text-center py-8">
                            <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"></div>
                            <p class="mt-2 text-gray-600">ËºâÂÖ•‰∏≠...</p>
                        </div>
                        
                        <!-- ‰∏ªË¶ÅÂÖßÂÆπ -->
                        <div v-else>
                            <div class="mb-4 text-gray-600">
                                <p>
                                    Á∏ΩÈáëÈ°ç: 
                                    <span class="font-bold text-2xl text-blue-600">
                                    {{ getActualAmount().toLocaleString() }} ÂÖÉ
                                    </span>
                                </p>

                                <!-- ÁØ©ÈÅ∏Ê¢ù‰ª∂Ê¢ùÂàóÂºè -->
                                <div class="text-sm mt-2 bg-gray-50 border border-gray-200 rounded-md p-3">
                                    <p class="font-semibold text-gray-700 mb-1">
                                    üìå ÁØ©ÈÅ∏Ê¢ù‰ª∂ ({{ actualModalType === 'lastMonth' ? '‰∏äÊúàÂ∑≤ÂÖ•Â∏≥Ë≥áÊñô' : 'Êú¨ÊúàÂ∑≤ÂÖ•Â∏≥Ë≥áÊñô' }})
                                    </p>
                                    <ul class="list-disc list-inside space-y-1 text-gray-600">
                                    <li>ePR No. Ëàá PO No. ÂøÖÈ†àÊúâÂÄº</li>
                                    <li>WBS Ê¨Ñ‰ΩçÂøÖÈ†àÁÇ∫Á©∫</li>
                                    <li>ÁôºÁ•®Êúà‰ªΩÂøÖÈ†àÊúâÂÄºÔºå‰∏îËÉΩËΩâÊèõÊàêÊúâÊïàÊó•Êúü</li>
                                    <li>‰ª•„ÄåÁôºÁ•®Êúà‰ªΩ (YYYY-MM)„ÄçÂàÜÁµÑË®àÁÆó</li>
                                    <li>ÈáëÈ°çË®àÁÆó‰ª• RTÁ∏ΩÈáëÈ°ç ÁÇ∫‰∏ª</li>
                                    </ul>
                                </div>

                                <p class="text-sm mt-1 text-gray-500">
                                    ÂÖ± <span class="font-semibold">{{ getActualDetails().length }}</span> Á≠ÜË≥áÊñô
                                </p>
                            </div>
                            
                            <table class="w-full border-collapse text-sm">
                                <thead class="bg-gray-100 sticky top-0">
                                    <tr>
                                        <th class="border px-3 py-2 text-left"></th>
                                        <th class="border px-3 py-2 text-left">ePR No.</th>
                                        <th class="border px-3 py-2 text-left">PO No.</th>
                                        <th class="border px-3 py-2 text-left">ÂìÅÈ†Ö</th>
                                        <th class="border px-3 py-2 text-right">Á∏ΩÂÉπ</th>
                                        <th class="border px-3 py-2 text-right">RTÁ∏ΩÈáëÈ°ç</th>
                                        <th class="border px-3 py-2 text-center">ÁôºÁ•®Êúà‰ªΩ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="(row, idx) in getActualDetails()" 
                                        :key="idx" 
                                        class="hover:bg-gray-50">
                                        <td class="border px-3 py-2 text-gray-500">{{ idx + 1 }}</td>
                                        <td class="border px-3 py-2 font-mono">{{ row['ePR No.'] || '-' }}</td>
                                        <td class="border px-3 py-2 font-mono">{{ row['PO No.'] || '-' }}</td>
                                        <td class="border px-3 py-2">{{ row['ÂìÅÈ†Ö'] || '-' }}</td>
                                        <td class="border px-3 py-2 text-right">
                                            {{
                                                row['Á∏ΩÂÉπ']
                                                ? Number(String(row['Á∏ΩÂÉπ']).replace(/,/g, '')).toLocaleString()
                                                : 'Êú™Â°´ or ÂêåÊúàÂàÜÊâπ‰∫§Ë≤®'
                                            }}
                                        </td>
                                        <td class="border px-3 py-2 text-right font-semibold"
                                            :class="{'text-red-500': !row['RTÁ∏ΩÈáëÈ°ç'] || row['RTÁ∏ΩÈáëÈ°ç'] === '0'}">
                                             {{
                                                row['RTÁ∏ΩÈáëÈ°ç']
                                                ? Number(String(row['RTÁ∏ΩÈáëÈ°ç']).replace(/,/g, '')).toLocaleString()
                                                : 'Êú™Â°´ or ÂêåÊúàÂàÜÊâπ‰∫§Ë≤®'
                                            }}
                                        </td>
                                        <td class="border px-3 py-2 text-center">{{ row['ÁôºÁ•®Êúà‰ªΩ'] || '-' }}</td>
                                    </tr>
                                </tbody>
                                <tfoot class="bg-gray-100 font-bold">
                                    <tr>
                                        <td colspan="5" class="border px-3 py-2 text-right">ÂêàË®à:</td>
                                        <td class="border px-3 py-2 text-right text-blue-600">
                                            {{ getActualAmount().toLocaleString() }} ÂÖÉ
                                        </td>
                                        <td colspan="2" class="border px-3 py-2"></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- ÂΩàÁ™óÂ∫ïÈÉ®ÊåâÈàï -->
                <div class="bg-gray-50 px-6 py-4 flex justify-end">
                    <button @click="showActualModal = false" class="px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg">
                        ÈóúÈñâ
                    </button>
                </div>
            </div>
        </div>

        <!-- ÂΩàÁ™ó3: Êú¨ÊúàÂ∞öÊú™ÂÖ•Â∏≥Áç®Á´ãÂΩàÁ™ó -->
        <div v-if="showCurrentNoneModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" @click="showCurrentNoneModal = false">
            <div class="bg-white rounded-lg shadow-2xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto" @click.stop>
                <!-- ÂΩàÁ™óÊ®ôÈ°å -->
                <div class="bg-gradient-to-r from-orange-500 to-orange-600 text-white px-6 py-4 flex justify-between items-center">
                    <h2 class="text-xl font-bold flex items-center gap-2">
                        üìã Êú¨ÊúàÂ∞öÊú™ÂÖ•Â∏≥ÊòéÁ¥∞
                    </h2>
                    <button @click="showCurrentNoneModal = false" class="text-white hover:text-gray-300 text-2xl font-bold">&times;</button>
                </div>

                <!-- ÂΩàÁ™óÂÖßÂÆπ -->
                <div class="p-6 overflow-y-auto max-h-[75vh]">
                    <div class="overflow-x-auto">
                        <!-- ËºâÂÖ•‰∏≠ÁãÄÊÖã -->
                        <div v-if="isLoadingCurrentNone" class="text-center py-8">
                            <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"></div>
                            <p class="mt-2 text-gray-600">ËºâÂÖ•‰∏≠...</p>
                        </div>
                        
                        <!-- ‰∏ªË¶ÅÂÖßÂÆπ -->
                        <div v-else>
                            <div class="mb-4 text-gray-600">
                                <p>
                                    Á∏ΩÈáëÈ°ç: 
                                    <span class="font-bold text-2xl text-orange-600">
                                    {{ currentNoneMonthAmount.toLocaleString() }} ÂÖÉ
                                    </span>
                                </p>

                                <!-- ÁØ©ÈÅ∏Ê¢ù‰ª∂ -->
                                <div class="text-sm mt-2 bg-gray-50 border border-gray-200 rounded-md p-3">
                                    <p class="font-semibold text-gray-700 mb-1">üìå ÁØ©ÈÅ∏Ê¢ù‰ª∂</p>
                                    <ul class="list-disc list-inside space-y-1 text-gray-600">
                                        <li>Â∞öÊú™ÈñãÁôºÁ•®(ÁôºÁ•®Êúà‰ªΩÁÇ∫Á©∫)</li>
                                        <li>ÊâøË´æ‰∫§ÊúüËêΩÂú®Êú¨ÊúàÂçÄÈñì</li>
                                        <li>WBS Ê¨Ñ‰ΩçÁÇ∫Á©∫</li>
                                        <li>ÊéíÈô§Êú¨ÊúàÊàñ‰πãÂâçÂ∑≤ÈñãÁôºÁ•®ÁöÑË≥áÊñô</li>
                                    </ul>
                                </div>

                                <p class="text-sm mt-1 text-gray-500">
                                    ÂÖ± <span class="font-semibold">{{ currentNoneDetails.length }}</span> Á≠ÜË≥áÊñô
                                </p>
                            </div>
                            
                            <table class="w-full border-collapse text-sm">
                                <thead class="bg-gray-100 sticky top-0">
                                    <tr>
                                        <th class="border px-3 py-2 text-left"></th>
                                        <th class="border px-3 py-2 text-left">ePR No.</th>
                                        <th class="border px-3 py-2 text-left">PO No.</th>
                                        <th class="border px-3 py-2 text-left">ÂìÅÈ†Ö</th>
                                        <th class="border px-3 py-2 text-right">Á∏ΩÂÉπ</th>
                                        <th class="border px-3 py-2 text-right">RTÁ∏ΩÈáëÈ°ç</th>
                                        <th class="border px-3 py-2 text-center">ÊâøË´æ‰∫§Êúü</th>
                                        <th class="border px-3 py-2 text-center">ÁôºÁ•®Êúà‰ªΩ</th>
                                        <th class="border px-3 py-2 text-center">ÁãÄÊÖã</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="(row, idx) in currentNoneDetails" 
                                        :key="idx" 
                                        class="hover:bg-gray-50"
                                        :class="{'bg-yellow-50': !row['RTÁ∏ΩÈáëÈ°ç'] || row['RTÁ∏ΩÈáëÈ°ç'] === '0' || row['RTÁ∏ΩÈáëÈ°ç'] === 'nan'}">
                                        <td class="border px-3 py-2 text-gray-500">{{ idx + 1 }}</td>
                                        <td class="border px-3 py-2 font-mono">{{ row['ePR No.'] || '-' }}</td>
                                        <td class="border px-3 py-2 font-mono">{{ row['PO No.'] || '-' }}</td>
                                        <td class="border px-3 py-2">{{ row['ÂìÅÈ†Ö'] || '-' }}</td>
                                        <td class="border px-3 py-2 text-right">
                                            {{ formatCurrency(row['Á∏ΩÂÉπ']) }}
                                        </td>
                                        <td class="border px-3 py-2 text-right font-semibold"
                                            :class="{'text-red-500': !row['RTÁ∏ΩÈáëÈ°ç'] || row['RTÁ∏ΩÈáëÈ°ç'] === '0' || row['RTÁ∏ΩÈáëÈ°ç'] === 'nan'}">
                                            {{ formatCurrency(row['RTÁ∏ΩÈáëÈ°ç']) }}
                                        </td>
                                        <!-- Ê≥®ÊÑèÔºöÈÄôË£°ÊîπÁÇ∫‰ΩøÁî® 'ÊâøË´æ‰∫§Êúü' ËÄå‰∏çÊòØ 'È†êË®à‰∫§Êúü' -->
                                        <td class="border px-3 py-2 text-center">{{ formatDate(row['ÊâøË´æ‰∫§Êúü']) }}</td>
                                        <td class="border px-3 py-2 text-center">{{ formatDate(row['ÁôºÁ•®Êúà‰ªΩ']) }}</td>
                                        <td class="border px-3 py-2 text-center">
                                            <span class="px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs">
                                                ÂæÖÂÖ•Â∏≥
                                            </span>
                                        </td>
                                    </tr>
                                </tbody>
                                <tfoot class="bg-gray-100 font-bold">
                                    <tr>
                                        <td colspan="5" class="border px-3 py-2 text-right">ÂêàË®à:</td>
                                        <td class="border px-3 py-2 text-right text-orange-600">
                                            {{ currentNoneMonthAmount.toLocaleString() }} ÂÖÉ
                                        </td>
                                        <td colspan="3" class="border px-3 py-2"></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- ÂΩàÁ™óÂ∫ïÈÉ®ÊåâÈàï -->
                <div class="bg-gray-50 px-6 py-4 flex justify-end">
                    <button @click="showCurrentNoneModal = false" class="px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg">
                        ÈóúÈñâ
                    </button>
                </div>
            </div>
        </div>

        <!-- Â∫ïÈÉ®ÊåâÈàïÂçÄÂüü -->
        <div class="flex-shrink-0 flex justify-between items-center px-6 py-2 gap-6">
            <!-- Â∑¶ÂÅ¥ÔºöËøîÂõûÊåâÈàïÂíå‰∏ãËºâÊåâÈàï -->
            <div class="flex items-center gap-4">
                <!-- ËøîÂõûÊåâÈàï -->
                <button
                    @click="goDashboard()"
                    class="h-10 px-5 flex items-center gap-2 bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 text-white text-sm font-medium rounded-full shadow hover:shadow-md transition-transform hover:scale-105"
                >
                    <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                    </svg>
                    ËøîÂõû‰∏ä‰∏ÄÈ†Å
                </button>

                <!-- ‰∏ãËºâÁ¥∞È†ÖË≥áÊñôÊåâÈàï -->
                <button
                    @click="downloadDetailData"
                    class="h-10 px-5 flex items-center gap-2 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white text-sm font-medium rounded-full shadow hover:shadow-md transition-transform hover:scale-105"
                >
                    <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    ‰∏ãËºâÁ¥∞È†ÖË≥áÊñô (.xlsx)
                </button>
            </div>

            <!-- Âè≥ÂÅ¥ÔºöÊåâÈàïÁµÑ -->
            <div class="flex items-center gap-4">
                <!-- ‰æõÊáâÂïÜÊâøË´æ‰∫§ÊúüÊõ¥Êñ∞ -->
                <button
                    @click="goEHubpageInfo"
                    class="h-10 px-5 bg-amber-600 hover:bg-amber-700 text-white text-sm font-medium rounded-full shadow flex items-center gap-2 transition-transform hover:scale-105"
                >
                    <img src="../static/picture/promise.png" alt="Êõ¥Êñ∞" class="w-4 h-4" />
                    <span>‰æõÊáâÂïÜÊâøË´æ‰∫§ÊúüÊõ¥Êñ∞</span>
                </button>

                <!-- eRT Ëàá‰∏äÂÇ≥Ôºö‰∏ä‰∏ãÊéí -->
                <div class="flex flex-col gap-2">
                    <!-- eRT Web -->
                    <a
                        href="https://khwfap.kh.asegroup.com/ert/eRT_web/eRT_Search.aspx"
                        target="_blank"
                        class="h-5 px-4 flex items-center justify-center gap-1.5 text-xs font-medium text-blue-700 bg-blue-100 hover:bg-blue-200 rounded-full transition-all hover:scale-105"
                    >
                        üìÑ ÈªûÊàëÂâçÂæÄ eRT Web
                    </a>

                    <!-- ‰∏äÂÇ≥ -->
                    <input type="file" ref="fileInput" @change="autoUpload" class="hidden" accept=".csv,.xls,.xlsx" />
                    <button
                        @click="$refs.fileInput.click()"
                        class="h-5 px-4 flex items-center justify-center gap-1.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white text-xs font-medium rounded-full shadow hover:shadow-md transition-all hover:scale-105"
                    >
                        <img src="../static/picture/upload_ert.png" alt="Upload" class="w-3 h-3" />
                        <span>Áâ©ÊñôÊî∂Ë≤® xlsx ‰∏äÂÇ≥</span>
                    </button>
                </div>
                
                <!-- Á¨¨‰∏âÁµÑ‰∏ä‰∏ãÊåâÈàï -->
                <div class="flex flex-col gap-2">
                    <!-- ‰∏äÊñπÊåâÈàïÔºöÂâçÂæÄÂæÖÈ©óÊî∂ÊñôÊî∂Ë≤®ÂñÆ -->
                    <a
                        href="https://khwfap.kh.asegroup.com/ert/eRT_web/eRT_Apply.aspx"
                        target="_blank"
                        class="h-5 px-4 flex items-center justify-center gap-1.5 bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-medium rounded-full shadow-md transition-all hover:scale-105"
                    >
                        <img src="../static/picture/ase.png" alt="ASE" class="w-3 h-3" />
                        <span>ÂâçÂæÄÂæÖÈ©óÊî∂ÊñôÊî∂Ë≤®ÂñÆ</span>
                    </a>

                    <!-- ‰∏ãÊñπÊåâÈàïÔºöÁâ©ÊñôÊî∂Ë≤®ÂñÆ‰∏äÂÇ≥ -->
                    <button
                        @click="goMaterialReceivingNoteUpload"
                        class="h-5 px-4 flex items-center justify-center gap-1.5 bg-rose-600 hover:bg-rose-700 text-white text-xs font-medium rounded-full shadow-md transition-all hover:scale-105"
                    >
                        <img src="../static/picture/RT_upload.png" alt="Upload" class="w-3 h-3" />
                        <span>Áâ©ÊñôÊî∂Ë≤®ÂñÆ‰∏äÂÇ≥ (mhtml)</span>
                    </button>
                </div>
                <!-- Á¨¨ÂõõÁµÑ‰∏ä‰∏ãÊåâÈàïÔºöÈ©óÊî∂Áôº Mail -->
                <div class="flex flex-col gap-2">
                    <!-- ÊîæÂ§ßÂÖ©ÂÄçÁöÑÁôºÈÄÅÈ©óÊî∂ÈÄöÁü•ÊåâÈàï -->
                    <button
                        @click="goSendMail"
                        class="h-10 px-8 flex items-center justify-center gap-3 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-full shadow-lg transition-all hover:scale-105"
                    >
                        <img src="../static/picture/mail.png" alt="Mail" class="w-6 h-6" />
                        <span>ÁôºÈÄÅÈ©óÊî∂ÈÄöÁü•</span>
                    </button>
                </div>
            </div>
        </div>

    </div>

<script src="../static/js/func/eRT.js"></script>
</body>
</html>