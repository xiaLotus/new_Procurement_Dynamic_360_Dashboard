### è³‡è¨Šç´°é …
1. Planned_Purchase_Request_List.csv é è¨ˆè«‹è³¼è³‡æ–™è¡¨
2. Buyer_detail.csv


    # with lock:
    #     try:
    #         df = pd.read_csv(filepath)
    #         updates = []
    #         for _, row in df.iterrows():
    #             epr_no = str(row.get('E-PRè™Ÿç¢¼           ', '')).strip()
    #             status = str(row.get('ç‹€æ…‹', '')).strip()
    #             stage = str(row.get('ç°½æ ¸ä¸­é—œå¡', '')).strip()

    #             if epr_no and epr_no != 'nan':
    #                 updates.append({
    #                     'epr_no': epr_no,
    #                     'ç‹€æ…‹': status,
    #                     'ç°½æ ¸ä¸­é—œå¡': stage
    #             })
                    
    #         Planned_Purchase_Request_List_df = pd.read_csv(CSV_FILE)
    #         updated_count = 0

    #         for update in updates:
    #             epr = update['epr_no']
    #             status = update['ç‹€æ…‹']
    #             stage = update['ç°½æ ¸ä¸­é—œå¡']
            
    #             match = Planned_Purchase_Request_List_df['ePR No.'] == int(epr)
    #             if match.any():
    #                 idx = Planned_Purchase_Request_List_df[match].index[0]
    #                 Planned_Purchase_Request_List_df.at[idx, 'Status'] = status
    #                 Planned_Purchase_Request_List_df.at[idx, 'ç°½æ ¸ä¸­é—œå¡'] = stage
    #                 updated_count += 1
                    
    #         def safe_float_to_int64(val):
    #             try:
    #                 if pd.isna(val):
    #                     return ""
    #                 return str(int(float(val)))
    #             except:
    #                 return str(val).strip()
                
    #         numeric_fields = ["è«‹è³¼é †åº", "ç¸½é‡‘é¡", "éœ€æ±‚æ—¥", "å·²é–‹å–®æ—¥æœŸ", "ePR No."]
    #         for field in numeric_fields:
    #             if field in Planned_Purchase_Request_List_df.columns:
    #                 Planned_Purchase_Request_List_df[field] = Planned_Purchase_Request_List_df[field].apply(safe_float_to_int64)


    #         Planned_Purchase_Request_List_df.to_csv(CSV_FILE, index=False, encoding='utf-8-sig')
    #         # os.remove(filepath)
    #         return jsonify({'status': 'success', 'updated_count': updated_count})

    #     except Exception as e:
    #         return jsonify({'status': 'Fail', 'reason': e})


    b9f39165-96a1-429d-bb91-9d655bb01f51,V,,1,è¨±éŠ˜å‚‘,K22-5F 3400 ä¸‹è²¨å€å¤¾çˆªä¿®æ”¹,K22-5F 3400 ä¸‹è²¨å€å¤¾çˆªæ”¹å–„è«‹è³¼ï¼Œå› å¤©è»Š MAG èˆ‡å¤¾çˆªé–“éš™ç´„ 5â€¯mmï¼Œå–ç›’æ™‚é¡éƒ¨å¹²æ¶‰æè‡´è·³ Dieï¼Œå»ºè­°åŠ å¤§å¢Šå¡Šé–“è·é™ä½é¢¨éšªã€‚,19845,20250512,20250626,2506260003,https://khwfap.kh.asegroup.com/ePR/PRQuery/QueryPR?id=2506260003,C3166 ä»£ç”³è«‹,SAP PO å»ºç«‹å®Œæˆ,,,,,,



ğŸ“… ç›®å‰å°šæœªå…¥å¸³
2. å¿…é ˆ epr èˆ‡ po no éç©ºå€¼ï¼Œæœ‰å…§å®¹æ‰ç´å…¥è¨ˆç®—
3. æ‰£é™¤ WBS æ¬„ä½æœ‰å€¼
4. æ‰¿è«¾äº¤æœŸå¿…é ˆåœ¨é¸æ“‡ç•¶æœˆ
6. éœ€æ±‚æ—¥å¿…é ˆè¦åœ¨é¸æ“‡æœˆä»½ä¹‹å‰
5. ç™¼ç¥¨æœˆä»½å¦‚æœåœ¨ç•¶æœˆä»¥å¾Œå‰‡ç‚ºç©ºå€¼ç´å…¥è¨ˆç®—(æ¯”å¦‚ç¾åœ¨æ˜¯2025/6ï¼Œé‚£æˆ‘ç™¼ç¥¨é–‹åœ¨2025/7ï¼Œé€™å€‹å°±éœ€è¦ç´å…¥è¨ˆç®—äº†)

èˆ‰ä¾‹ï¼š
1. å¦‚æœé¸æ“‡8æœˆï¼Œé‚£é€™é‚Šçš„å…¥å¸³æ¢ä»¶ç‚ºï¼ŒEPR + PO æœ‰æ•¸å€¼ï¼Œæ‰£é™¤ WBS æ¬„ä½æœ‰å€¼ï¼Œæ‰¿è«¾äº¤æœŸåœ¨8æœˆå‰(å¦‚æœåœ¨8æœˆ1è™Ÿæˆ–ä»¥å¾Œå‰‡ä¸ç´å…¥è¨ˆç®—)ï¼Œç™¼ç¥¨æœˆä»½ç‚ºç©ºå€¼ï¼Œæ¥ä¸‹ä¾†æ‰æŠŠç¸½åƒ¹åŠ èµ·ä¾†
2. å¦‚æœé¸æ“‡7æœˆï¼Œé‚£é€™é‚Šçš„å…¥å¸³æ¢ä»¶ç‚ºï¼ŒEPR + PO æœ‰æ•¸å€¼ï¼Œæ‰£é™¤ WBS æ¬„ä½æœ‰å€¼ï¼Œæ‰¿è«¾äº¤æœŸåœ¨7æœˆå‰ï¼Œ(7æœˆ1è™ŸåŠä»¥å¾Œä¸ç´å…¥è¨ˆç®—)ï¼Œ(ç™¼ç¥¨æœˆä»½å¦‚åœ¨7æœˆä»½å¾Œç›´æ¥è®Šæˆç©ºå€¼)ï¼Œæ¥ä¸‹ä¾†æ‰æŠŠç¸½åƒ¹åŠ èµ·ä¾†


ğŸ’° ä¸Šæœˆå¯¦éš›å…¥å¸³
1. é€™é‚Šä¸€æ¨£æ˜¯å¯ä»¥é¸æ“‡æœˆä»½
2. å¿…é ˆ epr èˆ‡ po no éç©ºå€¼ï¼Œæœ‰å…§å®¹æ‰ç´å…¥è¨ˆç®—
3. æ‰£é™¤ WBS æ¬„ä½æœ‰å€¼
4. ç™¼ç¥¨æœˆä»½ = é¸æ“‡æœˆä»½
5. å¦‚æœé¸æ“‡æœˆä»½æ²’è³‡æ–™ï¼Œå¾€å‰æ‰¾ä¸Šå€‹æœˆ
6. å¦‚æœä¸Šå€‹æœˆä¹Ÿæ²’è³‡æ–™ï¼Œæ‰¾ä¸Šä¸Šå€‹æœˆ
ç´”ç²¹è¨ˆç®—å·²å…¥å¸³é‡‘é¡

ğŸ“… æœ¬æœˆå°šæœªå…¥å¸³ 
1. æ’é™¤æœ‰WBSçš„é …ç›®
2. å¿…è¦æ¬„ä½æª¢æŸ¥ï¼š ePR No.ã€PO No.ã€æ‰¿è«¾äº¤æœŸéƒ½ä¸èƒ½ç‚ºç©º
3. æ‰¿è«¾äº¤æœŸ â‰¤ é¸æ“‡æœˆä»½çš„å‰ä¸€å€‹æœˆï¼ˆä¾‹å¦‚é¸8æœˆï¼Œæ‰¿è«¾äº¤æœŸè¦åœ¨7æœˆæˆ–ä¹‹å‰ï¼‰
4. éœ€æ±‚æ—¥æª¢æŸ¥ï¼š å¦‚æœæœ‰éœ€æ±‚æ—¥ï¼Œéœ€æ±‚æ—¥ä¸èƒ½åœ¨é¸æ“‡æœˆä»½æˆ–ä¹‹å¾Œ
5. ç™¼ç¥¨æœˆä»½æª¢æŸ¥ï¼š ç™¼ç¥¨æœˆä»½ç‚ºç©º OR ç™¼ç¥¨æœˆä»½ < é¸æ“‡æœˆä»½

æœ€åš´æ ¼çš„æ¢ä»¶ï¼Œç”¨æ–¼ç²¾ç¢ºè¨ˆç®—æœ¬æœˆæ‡‰è©²å…¥å¸³ä½†é‚„æ²’å…¥å¸³çš„é …ç›®


ğŸ“… æœ¬æœˆå¯¦éš›å…¥å¸³ 

1. æ’é™¤æœ‰WBSçš„é …ç›®
2. ç™¼ç¥¨æœˆä»½ = é¸æ“‡æœˆä»½
3. å¦‚æœé¸æ“‡æœˆä»½æ²’è³‡æ–™ï¼Œæ‰¾ä¸Šå€‹æœˆ
4. å¿…è¦æ¬„ä½æª¢æŸ¥ï¼š ePR No.ã€PO No.ã€æ‰¿è«¾äº¤æœŸéƒ½ä¸èƒ½ç‚ºç©º

èˆ‡ä¸Šæœˆå¯¦éš›å…¥å¸³é‚è¼¯ç›¸åŒï¼Œåªæ˜¯é è¨­æœˆä»½ä¸åŒ

ä¾ç…§æˆ‘çš„è¦æ±‚ä¿®æ”¹ ç›®å‰çš„Rule,è¨˜ä½,ä¸€å®šéƒ½è¦æª¢æŸ¥ ePR No.,PO No. é€™å…©å€‹æ¬„ä½ä¸å¾—ç‚ºç©º

