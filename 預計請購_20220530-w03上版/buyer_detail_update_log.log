2025-10-17 20:57:40,294 INFO: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-10-17 20:57:40,294 INFO: [33mPress CTRL+C to quit[0m
2025-10-17 20:57:40,296 INFO:  * Restarting with stat
2025-10-17 20:57:41,498 WARNING:  * Debugger is active!
2025-10-17 20:57:41,502 INFO:  * Debugger PIN: 448-687-441
2025-10-17 20:57:51,135 INFO: 127.0.0.1 - - [17/Oct/2025 20:57:51] "OPTIONS /api/save_csv HTTP/1.1" 200 -
2025-10-17 20:57:51,148 INFO: ✅ 已儲存 uploads/6100822325.csv (4 筆資料)
2025-10-17 20:57:51,150 INFO: ✅ 已儲存 uploads/6100817457.csv (4 筆資料)
2025-10-17 20:57:51,169 INFO: 總資料筆數: 390, 有效資料(狀態=V): 329
2025-10-17 20:57:51,194 INFO: ⚠️ 筆數不符: PO=6100817457, Item=0010, XLS=2筆, CSV=1筆
2025-10-17 20:57:51,195 INFO: ⚠️ 筆數不符: PO=6100817457, Item=0020, XLS=2筆, CSV=1筆
2025-10-17 20:57:51,197 INFO: 處理 PO 6100822325 的 Item 0010
2025-10-17 20:57:51,198 INFO:   找到 Buyer Item 0010, 品名: SMC KQ2H06-00A 快速接頭
2025-10-17 20:57:51,198 INFO:   ✅ 完全相同
2025-10-17 20:57:51,198 INFO: 處理 PO 6100822325 的 Item 0020
2025-10-17 20:57:51,199 INFO:   找到 Buyer Item 0020, 品名: SMC TU0604B-100 AIR管
2025-10-17 20:57:51,199 INFO:   ✅ 完全相同
2025-10-17 20:57:51,199 INFO: 處理 PO 6100822325 的 Item 0030
2025-10-17 20:57:51,200 INFO:   找到 Buyer Item 0030, 品名: SMC TU0805B-100 AIR管
2025-10-17 20:57:51,200 INFO:   ✅ 完全相同
2025-10-17 20:57:51,200 INFO: 處理 PO 6100822325 的 Item 0040
2025-10-17 20:57:51,201 INFO:   找到 Buyer Item 0040, 品名: SMC TU1065B-100 AIR管
2025-10-17 20:57:51,201 INFO:   ✅ 完全相同
2025-10-17 20:57:51,201 INFO: 📊 PO 6100822325 統計: 相同=4, 衝突=0
2025-10-17 20:57:51,201 INFO: ⏭️ 跳過 PO 6100817457 的正常比對 (有分批問題)
2025-10-17 20:57:51,201 INFO: 🚨 發現 2 個項目筆數不符
2025-10-17 20:57:51,201 INFO: ✅ 同時處理了 1 個正常 PO
2025-10-17 20:57:51,202 INFO: 127.0.0.1 - - [17/Oct/2025 20:57:51] "POST /api/save_csv HTTP/1.1" 200 -
2025-10-17 20:57:53,144 INFO: 127.0.0.1 - - [17/Oct/2025 20:57:53] "OPTIONS /api/save_override_all HTTP/1.1" 200 -
2025-10-17 20:57:53,159 INFO: 總資料筆數: 390, 有效資料(狀態=V): 329
2025-10-17 20:57:53,159 INFO: 
================================================================================
2025-10-17 20:57:53,159 INFO: 開始處理資料比對 (Version 31 - 品名優先)
2025-10-17 20:57:53,159 INFO: ================================================================================
2025-10-17 20:57:53,159 INFO: 
[第 1 筆]
2025-10-17 20:57:53,159 INFO:   新資料 => PO: 6100822325, Item: 0010
2025-10-17 20:57:53,159 INFO:   品名: SMC KQ2H06-00A 快速接頭
2025-10-17 20:57:53,160 INFO:      在 PO 6100822325 找到 4 筆資料
2025-10-17 20:57:53,160 INFO:      品名相似度排名：
2025-10-17 20:57:53,161 INFO:        1. Item 0010: 100.0% [Item相同] - SMC KQ2H06-00A 快速接頭...
2025-10-17 20:57:53,161 INFO:        2. Item 0020: 51.3% - SMC TU0604B-100 AIR管...
2025-10-17 20:57:53,161 INFO:        3. Item 0040: 51.3% - SMC TU1065B-100 AIR管...
2025-10-17 20:57:53,161 INFO:   ✅ 品名完全相同且 Item 相同（相似度 100.0%） => 直接更新
2025-10-17 20:57:53,161 INFO: 
[第 2 筆]
2025-10-17 20:57:53,161 INFO:   新資料 => PO: 6100822325, Item: 0020
2025-10-17 20:57:53,161 INFO:   品名: SMC TU0604B-100 AIR管
2025-10-17 20:57:53,162 INFO:      在 PO 6100822325 找到 4 筆資料
2025-10-17 20:57:53,162 INFO:      品名相似度排名：
2025-10-17 20:57:53,162 INFO:        1. Item 0020: 100.0% [Item相同] - SMC TU0604B-100 AIR管...
2025-10-17 20:57:53,162 INFO:        2. Item 0030: 90.0% - SMC TU0805B-100 AIR管...
2025-10-17 20:57:53,162 INFO:        3. Item 0040: 90.0% - SMC TU1065B-100 AIR管...
2025-10-17 20:57:53,162 INFO:   ✅ 品名完全相同且 Item 相同（相似度 100.0%） => 直接更新
2025-10-17 20:57:53,163 INFO: 
[第 3 筆]
2025-10-17 20:57:53,163 INFO:   新資料 => PO: 6100822325, Item: 0030
2025-10-17 20:57:53,163 INFO:   品名: SMC TU0805B-100 AIR管
2025-10-17 20:57:53,163 INFO:      在 PO 6100822325 找到 4 筆資料
2025-10-17 20:57:53,164 INFO:      品名相似度排名：
2025-10-17 20:57:53,164 INFO:        1. Item 0030: 100.0% [Item相同] - SMC TU0805B-100 AIR管...
2025-10-17 20:57:53,164 INFO:        2. Item 0020: 90.0% - SMC TU0604B-100 AIR管...
2025-10-17 20:57:53,164 INFO:        3. Item 0040: 90.0% - SMC TU1065B-100 AIR管...
2025-10-17 20:57:53,164 INFO:   ✅ 品名完全相同且 Item 相同（相似度 100.0%） => 直接更新
2025-10-17 20:57:53,164 INFO: 
[第 4 筆]
2025-10-17 20:57:53,164 INFO:   新資料 => PO: 6100822325, Item: 0040
2025-10-17 20:57:53,164 INFO:   品名: SMC TU1065B-100 AIR管
2025-10-17 20:57:53,165 INFO:      在 PO 6100822325 找到 4 筆資料
2025-10-17 20:57:53,165 INFO:      品名相似度排名：
2025-10-17 20:57:53,165 INFO:        1. Item 0040: 100.0% [Item相同] - SMC TU1065B-100 AIR管...
2025-10-17 20:57:53,165 INFO:        2. Item 0020: 90.0% - SMC TU0604B-100 AIR管...
2025-10-17 20:57:53,165 INFO:        3. Item 0030: 90.0% - SMC TU0805B-100 AIR管...
2025-10-17 20:57:53,165 INFO:   ✅ 品名完全相同且 Item 相同（相似度 100.0%） => 直接更新
2025-10-17 20:57:53,166 INFO: 
================================================================================
2025-10-17 20:57:53,166 INFO: 比對結果摘要 (Version 31 - 品名優先)
2025-10-17 20:57:53,166 INFO: ================================================================================
2025-10-17 20:57:53,166 INFO: 總處理筆數: 4
2025-10-17 20:57:53,166 INFO: 更新筆數: 4
2025-10-17 20:57:53,166 INFO: 新增筆數: 0
2025-10-17 20:57:53,166 INFO: 失敗筆數: 0
2025-10-17 20:57:53,166 INFO: 待確認筆數: 0
2025-10-17 20:57:53,166 INFO: 自動更新筆數: 4
2025-10-17 20:57:53,166 INFO: 
詳細比對結果:
2025-10-17 20:57:53,166 INFO: --------------------------------------------------------------------------------
2025-10-17 20:57:53,166 INFO: 筆數    PO No.          Item       比對方式                 處理       備註
2025-10-17 20:57:53,166 INFO: --------------------------------------------------------------------------------
2025-10-17 20:57:53,166 INFO: 1     6100822325      0010       品名完全相同+Item相同        已更新      
2025-10-17 20:57:53,166 INFO: 2     6100822325      0020       品名完全相同+Item相同        已更新      
2025-10-17 20:57:53,166 INFO: 3     6100822325      0030       品名完全相同+Item相同        已更新      
2025-10-17 20:57:53,166 INFO: 4     6100822325      0040       品名完全相同+Item相同        已更新      
2025-10-17 20:57:53,166 INFO: ================================================================================

2025-10-17 20:57:53,173 INFO: 127.0.0.1 - - [17/Oct/2025 20:57:53] "POST /api/save_override_all HTTP/1.1" 200 -
2025-10-17 20:57:57,830 INFO: 127.0.0.1 - - [17/Oct/2025 20:57:57] "OPTIONS /api/confirm_quantity_update HTTP/1.1" 200 -
2025-10-17 20:57:57,838 INFO: ================================================================================
2025-10-17 20:57:57,838 INFO: 🚀 confirm_quantity_update 函數被調用
2025-10-17 20:57:57,838 INFO: ================================================================================
2025-10-17 20:57:57,838 INFO: 📥 收到的完整資料: {
  "po_no": "6100817457",
  "item": "0010",
  "rows": [
    {
      "delivery": "2025/10/15",
      "description": "CIM K25-8F 手臂整合 Fork 特仕版",
      "sod_qty": "1"
    },
    {
      "delivery": "2025/11/11",
      "description": "CIM K25-8F 手臂整合 Fork 特仕版",
      "sod_qty": "1"
    }
  ],
  "expected_total": 0
}
2025-10-17 20:57:57,839 INFO: 📦 解析後的參數:
2025-10-17 20:57:57,839 INFO:    PO No: 6100817457
2025-10-17 20:57:57,839 INFO:    Item: 0010
2025-10-17 20:57:57,839 INFO:    新筆數: 2
2025-10-17 20:57:57,839 INFO:    預期總和: 0
2025-10-17 20:57:57,840 INFO: 📂 開始載入 static/data/Buyer_detail.csv
2025-10-17 20:57:57,849 INFO: ✅ 成功載入 Buyer_detail.csv,共 390 筆資料
2025-10-17 20:57:57,849 INFO: 🔢 SOD 總和計算:
2025-10-17 20:57:57,849 INFO:    預期: 0
2025-10-17 20:57:57,849 INFO:    實際: 2.0
2025-10-17 20:57:57,849 INFO:    差異: 2.0
2025-10-17 20:57:57,849 WARNING: ⚠️ SOD 總和不符!預期=0, 實際=2.0, 差異=2.0
2025-10-17 20:57:57,849 WARNING:    使用者選擇強制儲存,將繼續處理...
2025-10-17 20:57:57,849 INFO: 🔍 開始尋找要刪除的資料 (PO=6100817457, Item=0010, 狀態=V)
2025-10-17 20:57:57,850 INFO: 📊 找到 1 筆符合條件的資料
2025-10-17 20:57:57,850 INFO: 📋 取得第一筆舊資料作為範本
2025-10-17 20:57:57,851 INFO: 🗑️ 將刪除的資料:
2025-10-17 20:57:57,851 INFO:    第 1 筆: {'品項': 'CIM K25-8F 手臂整合 Fork 特仕版', '規格': '設備型號：AERJ2583_V1、包含零組件、安裝與測試工程', '單價': '47800', '總價': '95600', '交期': '', 'SOD': ''}
2025-10-17 20:57:57,851 INFO: 🗑️ 執行刪除操作...
2025-10-17 20:57:57,851 INFO: ✅ 刪除完成,剩餘 389 筆資料
2025-10-17 20:57:57,851 INFO: 💰 原始單價: 47800.0
2025-10-17 20:57:57,851 INFO: ➕ 開始準備新資料...
2025-10-17 20:57:57,851 INFO:    處理第 1/2 筆新資料...
2025-10-17 20:57:57,851 INFO:       品項: CIM K25-8F 手臂整合 Fork 特仕版, SOD: 1, 總價: 47800
2025-10-17 20:57:57,851 INFO:    處理第 2/2 筆新資料...
2025-10-17 20:57:57,852 INFO:       品項: CIM K25-8F 手臂整合 Fork 特仕版, SOD: 1, 總價: 47800
2025-10-17 20:57:57,852 INFO: ✅ 準備完成 2 筆新資料
2025-10-17 20:57:57,852 INFO: 📥 將新資料添加到最後...
2025-10-17 20:57:57,853 INFO: ✅ 添加完成,現有 391 筆資料
2025-10-17 20:57:57,853 INFO: 💾 開始儲存到 static/data/Buyer_detail.csv...
2025-10-17 20:57:57,857 INFO: ✅ 儲存完成
2025-10-17 20:57:57,857 INFO: ================================================================================
2025-10-17 20:57:57,857 INFO: ✅ 成功更新 PO 6100817457 Item 0010: 刪除 1 筆,新增 2 筆 (已加到最後) (⚠️ SOD差異: +2.00)
2025-10-17 20:57:57,857 INFO: ================================================================================
2025-10-17 20:57:57,858 INFO: ✅ 已刪除: uploads\6100817457.csv
2025-10-17 20:57:57,858 INFO: 127.0.0.1 - - [17/Oct/2025 20:57:57] "POST /api/confirm_quantity_update HTTP/1.1" 200 -
2025-10-17 20:57:57,867 INFO: 127.0.0.1 - - [17/Oct/2025 20:57:57] "OPTIONS /api/confirm_quantity_update HTTP/1.1" 200 -
2025-10-17 20:57:57,874 INFO: ================================================================================
2025-10-17 20:57:57,875 INFO: 🚀 confirm_quantity_update 函數被調用
2025-10-17 20:57:57,875 INFO: ================================================================================
2025-10-17 20:57:57,875 INFO: 📥 收到的完整資料: {
  "po_no": "6100817457",
  "item": "0020",
  "rows": [
    {
      "delivery": "2025/10/15",
      "description": "CIM K25-8F 新增設備護蓋加固補強",
      "sod_qty": "1"
    },
    {
      "delivery": "2025/11/11",
      "description": "CIM K25-8F 新增設備護蓋加固補強",
      "sod_qty": "1"
    }
  ],
  "expected_total": 0
}
2025-10-17 20:57:57,875 INFO: 📦 解析後的參數:
2025-10-17 20:57:57,875 INFO:    PO No: 6100817457
2025-10-17 20:57:57,875 INFO:    Item: 0020
2025-10-17 20:57:57,875 INFO:    新筆數: 2
2025-10-17 20:57:57,875 INFO:    預期總和: 0
2025-10-17 20:57:57,876 INFO: 📂 開始載入 static/data/Buyer_detail.csv
2025-10-17 20:57:57,895 INFO: ✅ 成功載入 Buyer_detail.csv,共 391 筆資料
2025-10-17 20:57:57,895 INFO: 🔢 SOD 總和計算:
2025-10-17 20:57:57,895 INFO:    預期: 0
2025-10-17 20:57:57,895 INFO:    實際: 2.0
2025-10-17 20:57:57,895 INFO:    差異: 2.0
2025-10-17 20:57:57,895 WARNING: ⚠️ SOD 總和不符!預期=0, 實際=2.0, 差異=2.0
2025-10-17 20:57:57,895 WARNING:    使用者選擇強制儲存,將繼續處理...
2025-10-17 20:57:57,895 INFO: 🔍 開始尋找要刪除的資料 (PO=6100817457, Item=0020, 狀態=V)
2025-10-17 20:57:57,896 INFO: 📊 找到 1 筆符合條件的資料
2025-10-17 20:57:57,896 INFO: 📋 取得第一筆舊資料作為範本
2025-10-17 20:57:57,897 INFO: 🗑️ 將刪除的資料:
2025-10-17 20:57:57,897 INFO:    第 1 筆: {'品項': 'CIM K25-8F 新增設備護蓋加固補強', '規格': '包含零組件、安裝與測試工程', '單價': '12600', '總價': '25200', '交期': '', 'SOD': ''}
2025-10-17 20:57:57,897 INFO: 🗑️ 執行刪除操作...
2025-10-17 20:57:57,897 INFO: ✅ 刪除完成,剩餘 390 筆資料
2025-10-17 20:57:57,897 INFO: 💰 原始單價: 12600.0
2025-10-17 20:57:57,897 INFO: ➕ 開始準備新資料...
2025-10-17 20:57:57,897 INFO:    處理第 1/2 筆新資料...
2025-10-17 20:57:57,897 INFO:       品項: CIM K25-8F 新增設備護蓋加固補強, SOD: 1, 總價: 12600
2025-10-17 20:57:57,897 INFO:    處理第 2/2 筆新資料...
2025-10-17 20:57:57,897 INFO:       品項: CIM K25-8F 新增設備護蓋加固補強, SOD: 1, 總價: 12600
2025-10-17 20:57:57,897 INFO: ✅ 準備完成 2 筆新資料
2025-10-17 20:57:57,897 INFO: 📥 將新資料添加到最後...
2025-10-17 20:57:57,899 INFO: ✅ 添加完成,現有 392 筆資料
2025-10-17 20:57:57,899 INFO: 💾 開始儲存到 static/data/Buyer_detail.csv...
2025-10-17 20:57:57,903 INFO: ✅ 儲存完成
2025-10-17 20:57:57,903 INFO: ================================================================================
2025-10-17 20:57:57,903 INFO: ✅ 成功更新 PO 6100817457 Item 0020: 刪除 1 筆,新增 2 筆 (已加到最後) (⚠️ SOD差異: +2.00)
2025-10-17 20:57:57,903 INFO: ================================================================================
2025-10-17 20:57:57,904 INFO: 127.0.0.1 - - [17/Oct/2025 20:57:57] "POST /api/confirm_quantity_update HTTP/1.1" 200 -
2025-10-17 20:58:25,734 INFO: 127.0.0.1 - - [17/Oct/2025 20:58:25] "OPTIONS /api/save_csv HTTP/1.1" 200 -
2025-10-17 20:58:25,743 INFO: ✅ 已儲存 uploads/6100820115.csv (2 筆資料)
2025-10-17 20:58:25,768 INFO: 總資料筆數: 392, 有效資料(狀態=V): 331
2025-10-17 20:58:25,800 INFO: 處理 PO 6100820115 的 Item 0010
2025-10-17 20:58:25,800 INFO:   找到 Buyer Item 0010, 品名: Sharp AQUOS Wish4五金鎧甲防摔殼
2025-10-17 20:58:25,800 INFO:   ⚠️ 品名不同
2025-10-17 20:58:25,801 INFO: 處理 PO 6100820115 的 Item 0020
2025-10-17 20:58:25,801 INFO:   找到 Buyer Item 0020, 品名: Sharp AQUOS Wish4保護貼(全透明玻璃膜)
2025-10-17 20:58:25,801 INFO:   ⚠️ 品名不同
2025-10-17 20:58:25,801 INFO: 📊 PO 6100820115 統計: 相同=0, 衝突=2
2025-10-17 20:58:25,803 INFO: 
✅ 總共處理 1 個 PO
2025-10-17 20:58:25,803 INFO: 127.0.0.1 - - [17/Oct/2025 20:58:25] "POST /api/save_csv HTTP/1.1" 200 -
2025-10-17 20:58:38,341 INFO: 127.0.0.1 - - [17/Oct/2025 20:58:38] "OPTIONS /api/save_override_all HTTP/1.1" 200 -
2025-10-17 20:58:38,354 INFO: 總資料筆數: 392, 有效資料(狀態=V): 331
2025-10-17 20:58:38,354 INFO: 
================================================================================
2025-10-17 20:58:38,354 INFO: 開始處理資料比對 (Version 31 - 品名優先)
2025-10-17 20:58:38,354 INFO: ================================================================================
2025-10-17 20:58:38,354 INFO: 
[第 1 筆]
2025-10-17 20:58:38,354 INFO:   新資料 => PO: 6100820115, Item: 0010
2025-10-17 20:58:38,354 INFO:   品名: Sharp AQUOS Wish4保護貼(全透明玻璃膜)
2025-10-17 20:58:38,356 INFO:      在 PO 6100820115 找到 2 筆資料
2025-10-17 20:58:38,356 INFO:      品名相似度排名：
2025-10-17 20:58:38,356 INFO:        1. Item 0020: 100.0% - Sharp AQUOS Wish4保護貼(全透明玻璃膜)...
2025-10-17 20:58:38,356 INFO:        2. Item 0010: 65.4% [Item相同] - Sharp AQUOS Wish4五金鎧甲防摔殼...
2025-10-17 20:58:38,356 INFO:   ⚠️ 品名完全相同但 Item 不同（0020 → 0010）
2025-10-17 20:58:38,357 INFO:      品名相似度: 100.0%
2025-10-17 20:58:38,357 INFO:      需要確認是否要更新 Item
2025-10-17 20:58:38,357 INFO: 
[第 2 筆]
2025-10-17 20:58:38,357 INFO:   新資料 => PO: 6100820115, Item: 0020
2025-10-17 20:58:38,357 INFO:   品名: Sharp AQUOS Wish4五金鎧甲防摔殼
2025-10-17 20:58:38,357 INFO:      在 PO 6100820115 找到 2 筆資料
2025-10-17 20:58:38,357 INFO:      品名相似度排名：
2025-10-17 20:58:38,358 INFO:        1. Item 0010: 100.0% - Sharp AQUOS Wish4五金鎧甲防摔殼...
2025-10-17 20:58:38,358 INFO:        2. Item 0020: 65.4% [Item相同] - Sharp AQUOS Wish4保護貼(全透明玻璃膜)...
2025-10-17 20:58:38,358 INFO:   ⚠️ 品名完全相同但 Item 不同（0010 → 0020）
2025-10-17 20:58:38,358 INFO:      品名相似度: 100.0%
2025-10-17 20:58:38,358 INFO:      需要確認是否要更新 Item
2025-10-17 20:58:38,358 INFO: 
================================================================================
2025-10-17 20:58:38,358 INFO: 比對結果摘要 (Version 31 - 品名優先)
2025-10-17 20:58:38,358 INFO: ================================================================================
2025-10-17 20:58:38,358 INFO: 總處理筆數: 2
2025-10-17 20:58:38,358 INFO: 更新筆數: 0
2025-10-17 20:58:38,358 INFO: 新增筆數: 0
2025-10-17 20:58:38,358 INFO: 失敗筆數: 0
2025-10-17 20:58:38,358 INFO: 待確認筆數: 2
2025-10-17 20:58:38,358 INFO: 自動更新筆數: 0
2025-10-17 20:58:38,358 INFO: 
詳細比對結果:
2025-10-17 20:58:38,358 INFO: --------------------------------------------------------------------------------
2025-10-17 20:58:38,358 INFO: 筆數    PO No.          Item       比對方式                 處理       備註
2025-10-17 20:58:38,358 INFO: --------------------------------------------------------------------------------
2025-10-17 20:58:38,359 INFO: 1     6100820115      0020→0010  品名完全相同(Item:0020→0010) 待確認      品名相同但Item不同
2025-10-17 20:58:38,359 INFO: 2     6100820115      0010→0020  品名完全相同(Item:0010→0020) 待確認      品名相同但Item不同
2025-10-17 20:58:38,359 INFO: ================================================================================

2025-10-17 20:58:38,359 INFO: 127.0.0.1 - - [17/Oct/2025 20:58:38] "POST /api/save_override_all HTTP/1.1" 200 -
2025-10-17 20:58:39,988 INFO: 127.0.0.1 - - [17/Oct/2025 20:58:39] "OPTIONS /api/save_override_all HTTP/1.1" 200 -
2025-10-17 20:58:40,006 INFO: 總資料筆數: 392, 有效資料(狀態=V): 331
2025-10-17 20:58:40,006 INFO: 
================================================================================
2025-10-17 20:58:40,006 INFO: 開始處理資料比對 (Version 31 - 品名優先)
2025-10-17 20:58:40,006 INFO: ================================================================================
2025-10-17 20:58:40,006 INFO: 
[第 1 筆]
2025-10-17 20:58:40,006 INFO:   新資料 => PO: 6100820115, Item: 0010
2025-10-17 20:58:40,006 INFO:   品名: Sharp AQUOS Wish4保護貼(全透明玻璃膜)
2025-10-17 20:58:40,007 INFO:      在 PO 6100820115 找到 2 筆資料
2025-10-17 20:58:40,007 INFO:      品名相似度排名：
2025-10-17 20:58:40,007 INFO:        1. Item 0020: 100.0% - Sharp AQUOS Wish4保護貼(全透明玻璃膜)...
2025-10-17 20:58:40,007 INFO:        2. Item 0010: 65.4% [Item相同] - Sharp AQUOS Wish4五金鎧甲防摔殼...
2025-10-17 20:58:40,007 INFO:   ⚠️ 品名完全相同但 Item 不同（0020 → 0010）
2025-10-17 20:58:40,007 INFO:      品名相似度: 100.0%
2025-10-17 20:58:40,007 INFO:      => 已確認，將更新 Item
2025-10-17 20:58:40,008 INFO:      Item變更: 0020 → 0010
2025-10-17 20:58:40,008 INFO:      交期變更:  → 2025/11/14
2025-10-17 20:58:40,008 INFO:      數量變更:  → 20
2025-10-17 20:58:40,008 INFO: 
[第 2 筆]
2025-10-17 20:58:40,008 INFO:   新資料 => PO: 6100820115, Item: 0020
2025-10-17 20:58:40,008 INFO:   品名: Sharp AQUOS Wish4五金鎧甲防摔殼
2025-10-17 20:58:40,009 INFO:      在 PO 6100820115 找到 2 筆資料
2025-10-17 20:58:40,009 INFO:      品名相似度排名：
2025-10-17 20:58:40,009 INFO:        1. Item 0010: 100.0% - Sharp AQUOS Wish4五金鎧甲防摔殼...
2025-10-17 20:58:40,009 INFO:        2. Item 0020: 65.4% [Item相同] - Sharp AQUOS Wish4保護貼(全透明玻璃膜)...
2025-10-17 20:58:40,009 INFO:   ⚠️ 品名完全相同但 Item 不同（0010 → 0020）
2025-10-17 20:58:40,009 INFO:      品名相似度: 100.0%
2025-10-17 20:58:40,009 INFO:      => 已確認，將更新 Item
2025-10-17 20:58:40,009 INFO:      Item變更: 0010 → 0020
2025-10-17 20:58:40,009 INFO:      交期變更:  → 2025/11/14
2025-10-17 20:58:40,009 INFO:      數量變更:  → 20
2025-10-17 20:58:40,009 INFO: 
================================================================================
2025-10-17 20:58:40,009 INFO: 比對結果摘要 (Version 31 - 品名優先)
2025-10-17 20:58:40,009 INFO: ================================================================================
2025-10-17 20:58:40,010 INFO: 總處理筆數: 2
2025-10-17 20:58:40,010 INFO: 更新筆數: 2
2025-10-17 20:58:40,010 INFO: 新增筆數: 0
2025-10-17 20:58:40,010 INFO: 失敗筆數: 0
2025-10-17 20:58:40,010 INFO: 待確認筆數: 0
2025-10-17 20:58:40,010 INFO: 自動更新筆數: 0
2025-10-17 20:58:40,010 INFO: 
詳細比對結果:
2025-10-17 20:58:40,010 INFO: --------------------------------------------------------------------------------
2025-10-17 20:58:40,010 INFO: 筆數    PO No.          Item       比對方式                 處理       備註
2025-10-17 20:58:40,010 INFO: --------------------------------------------------------------------------------
2025-10-17 20:58:40,010 INFO: 1     6100820115      0020→0010  品名完全相同(Item:0020→0010) 已更新      
2025-10-17 20:58:40,010 INFO: 2     6100820115      0010→0020  品名完全相同(Item:0010→0020) 已更新      
2025-10-17 20:58:40,010 INFO: ================================================================================

2025-10-17 20:58:40,017 INFO: 127.0.0.1 - - [17/Oct/2025 20:58:40] "POST /api/save_override_all HTTP/1.1" 200 -
2025-10-17 21:02:31,325 INFO: 127.0.0.1 - - [17/Oct/2025 21:02:31] "GET /api/admins HTTP/1.1" 200 -
2025-10-17 21:02:31,376 INFO: 127.0.0.1 - - [17/Oct/2025 21:02:31] "GET /api/buyer_detail HTTP/1.1" 200 -
2025-10-17 21:02:31,431 INFO: 127.0.0.1 - - [17/Oct/2025 21:02:31] "GET /api/get_unaccounted_amount HTTP/1.1" 200 -
2025-10-17 21:02:31,785 INFO: 127.0.0.1 - - [17/Oct/2025 21:02:31] "GET /api/accounting_summary HTTP/1.1" 200 -
2025-10-17 21:02:31,854 INFO: 127.0.0.1 - - [17/Oct/2025 21:02:31] "GET /api/monthly_actual_accounting HTTP/1.1" 200 -
2025-10-17 21:02:31,902 INFO: 127.0.0.1 - - [17/Oct/2025 21:02:31] "GET /api/getrestofmoney HTTP/1.1" 200 -
2025-10-17 21:02:57,721 INFO: 收到檔案: 物料收貨單-20251013.mhtml, 大小: 278159 字元
2025-10-17 21:02:57,721 INFO: 開始解析 MHTML 文件
2025-10-17 21:02:57,745 INFO: 使用選擇器 'table[id*="GridView1"]' 找到表格
2025-10-17 21:02:57,746 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:02:57,746 INFO: 成功使用 utf-8 解碼: '=E4=BF=9D=E8=AD=B7=E5=82=98=E4=B8=83=E5=88=87=E5=85=
=AD=E5=BA=A7PU-3763S(2.7M)9=E5=B0=BA=E5=BB=B6=E9=95=B7=E7=B7=9A' -> '保護傘七切六座PU-3763S(2.7M)9尺延長線'
2025-10-17 21:02:57,746 INFO: 成功使用 utf-8 解碼: '=E7=8E=8B=E6=B7=91=E6=80=A1/14168' -> '王淑怡/14168'
2025-10-17 21:02:57,746 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:02:57,747 INFO: 成功使用 utf-8 解碼: '=E4=BF=9D=E8=AD=B7=E5=82=98=E4=B8=83=E5=88=87=E5=85=
=AD=E5=BA=A7PU-3763S(4.5M)15=E5=B0=BA=E5=BB=B6=E9=95=B7=E7=B7=9A' -> '保護傘七切六座PU-3763S(4.5M)15尺延長線'
2025-10-17 21:02:57,747 INFO: 成功使用 utf-8 解碼: '=E7=8E=8B=E6=B7=91=E6=80=A1/14168' -> '王淑怡/14168'
2025-10-17 21:02:57,747 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:02:57,747 INFO: 成功使用 utf-8 解碼: '=E4=BF=9D=E8=AD=B7=E5=82=98=E4=B8=83=E5=88=87=E5=85=
=AD=E5=BA=A7PU-3763S(1.8M)6=E5=B0=BA=E5=BB=B6=E9=95=B7=E7=B7=9A' -> '保護傘七切六座PU-3763S(1.8M)6尺延長線'
2025-10-17 21:02:57,747 INFO: 成功使用 utf-8 解碼: '=E7=8E=8B=E6=B7=91=E6=80=A1/14168' -> '王淑怡/14168'
2025-10-17 21:02:57,747 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:02:57,748 INFO: 成功使用 utf-8 解碼: 'Service Labor K11-8F 3450 RB4=E6=9B=B4=E6=8F=9B=E9=
=9B=BB=E7=A3=81=E9=96=A5' -> 'Service Labor K11-8F 3450 RB4更換電磁閥'
2025-10-17 21:02:57,748 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:02:57,748 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:02:57,748 INFO: 成功使用 utf-8 解碼: 'Service Labor K11-8F 3450 PLC =E4=BF=AE=E6=94=B9' -> 'Service Labor K11-8F 3450 PLC 修改'
2025-10-17 21:02:57,749 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:02:57,749 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:02:57,749 INFO: 成功使用 utf-8 解碼: 'Service Labor PLC=E5=BE=A9=E6=AD=B8=E4=B8=8A=E7=B7=
=9A(=E6=B0=A3=E7=AE=A1=E6=9B=B4=E6=8F=9B)' -> 'Service Labor PLC復歸上線(氣管更換)'
2025-10-17 21:02:57,749 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:02:57,749 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:02:57,749 INFO: 成功使用 utf-8 解碼: 'Service Labor PLC=E5=BE=A9=E6=AD=B8=E4=B8=8A=E7=B7=
=9A(=E9=A6=AC=E9=81=94=E4=BF=AE=E6=94=B9=E5=AE=9A=E4=BD=8D)' -> 'Service Labor PLC復歸上線(馬達修改定位)'
2025-10-17 21:02:57,750 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:02:57,750 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:02:57,750 INFO: 成功使用 utf-8 解碼: 'Service Labor PC=E7=95=B0=E5=B8=B8=E6=9F=A5=E6=89=BE=
&=E5=BE=A9=E6=AD=B8=E4=B8=8A=E7=B7=9A' -> 'Service Labor PC異常查找&復歸上線'
2025-10-17 21:02:57,750 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:02:57,750 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:02:57,750 INFO: 成功使用 utf-8 解碼: 'Service Labor PC=E7=95=B0=E5=B8=B8=E6=9F=A5=E6=89=BE=
&=E5=BE=A9=E6=AD=B8=E4=B8=8A=E7=B7=9A' -> 'Service Labor PC異常查找&復歸上線'
2025-10-17 21:02:57,750 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:02:57,750 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:02:57,751 INFO: 成功使用 utf-8 解碼: 'SICK GTE2F-N1131 =E5=85=89=E9=9B=BB=E6=84=9F=E6=B8=
=AC=E5=99=A8' -> 'SICK GTE2F-N1131 光電感測器'
2025-10-17 21:02:57,751 INFO: 成功使用 utf-8 解碼: 'AB=E9=96=80' -> 'AB門'
2025-10-17 21:02:57,751 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:02:57,751 INFO: 成功使用 utf-8 解碼: 'SICK GTE2F-E1131 =E5=85=89=E9=9B=BB=E6=84=9F=E6=B8=
=AC=E5=99=A8' -> 'SICK GTE2F-E1131 光電感測器'
2025-10-17 21:02:57,751 INFO: 成功使用 utf-8 解碼: 'AB=E9=96=80' -> 'AB門'
2025-10-17 21:02:57,751 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:02:57,752 INFO: 成功使用 utf-8 解碼: 'Mitsubishi AJ65VBTCE32-32DT CC-Link=E6=A8=A1=E7=B5=
=84' -> 'Mitsubishi AJ65VBTCE32-32DT CC-Link模組'
2025-10-17 21:02:57,752 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:02:57,752 INFO: 成功使用 utf-8 解碼: 'ESD=E6=A8=99=E7=A4=BA=E8=86=A0=E5=B8=B6 30mmX33M=E9=
=BB=83=E9=BB=91=E8=89=B2' -> 'ESD標示膠帶 30mmX33M黃黑色'
2025-10-17 21:02:57,752 INFO: 成功使用 utf-8 解碼: '=E7=8E=8B=E6=B7=91=E6=80=A1/14168' -> '王淑怡/14168'
2025-10-17 21:02:57,752 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:02:57,752 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:02:57,753 INFO: 成功解析 15 筆資料
2025-10-17 21:02:57,753 INFO: ==================================================
2025-10-17 21:02:57,753 INFO: 解析結果:
2025-10-17 21:02:57,753 INFO: 檔案名稱: 物料收貨單-20251013.mhtml
2025-10-17 21:02:57,753 INFO: 解析筆數: 15
2025-10-17 21:02:57,753 INFO: ------------------------------
2025-10-17 21:02:57,753 INFO: 第 1 筆:
2025-10-17 21:02:57,753 INFO:   RT No: 5000401840
2025-10-17 21:02:57,753 INFO:   項次: 0001
2025-10-17 21:02:57,753 INFO:   PO No: 6100819549
2025-10-17 21:02:57,753 INFO:   科目指派: K - 費用
2025-10-17 21:02:57,753 INFO:   品名: Kuka Robot Cable 5m BUS-smartPAD
2025-10-17 21:02:57,753 INFO:   數量: 3
2025-10-17 21:02:57,753 INFO:   取件者: C5
2025-10-17 21:02:57,753 INFO: ------------------------------
2025-10-17 21:02:57,753 INFO: 第 2 筆:
2025-10-17 21:02:57,753 INFO:   RT No: 5000402209
2025-10-17 21:02:57,753 INFO:   項次: 0001
2025-10-17 21:02:57,753 INFO:   PO No: A000421817
2025-10-17 21:02:57,753 INFO:   科目指派: K - 費用
2025-10-17 21:02:57,753 INFO:   品名: 保護傘七切六座PU-3763S(2.7M)9尺延長線
2025-10-17 21:02:57,753 INFO:   數量: 10
2025-10-17 21:02:57,753 INFO:   取件者: 王淑怡/14168
2025-10-17 21:02:57,753 INFO: ------------------------------
2025-10-17 21:02:57,753 INFO: 第 3 筆:
2025-10-17 21:02:57,753 INFO:   RT No: 5000402209
2025-10-17 21:02:57,753 INFO:   項次: 0002
2025-10-17 21:02:57,753 INFO:   PO No: A000421817
2025-10-17 21:02:57,753 INFO:   科目指派: K - 費用
2025-10-17 21:02:57,753 INFO:   品名: 保護傘七切六座PU-3763S(4.5M)15尺延長線
2025-10-17 21:02:57,754 INFO:   數量: 6
2025-10-17 21:02:57,754 INFO:   取件者: 王淑怡/14168
2025-10-17 21:02:57,754 INFO: ------------------------------
2025-10-17 21:02:57,754 INFO: 第 4 筆:
2025-10-17 21:02:57,754 INFO:   RT No: 5000402209
2025-10-17 21:02:57,754 INFO:   項次: 0003
2025-10-17 21:02:57,754 INFO:   PO No: A000421817
2025-10-17 21:02:57,754 INFO:   科目指派: K - 費用
2025-10-17 21:02:57,754 INFO:   品名: 保護傘七切六座PU-3763S(1.8M)6尺延長線
2025-10-17 21:02:57,754 INFO:   數量: 4
2025-10-17 21:02:57,754 INFO:   取件者: 王淑怡/14168
2025-10-17 21:02:57,754 INFO: ------------------------------
2025-10-17 21:02:57,754 INFO: 第 5 筆:
2025-10-17 21:02:57,754 INFO:   RT No: 5000403919
2025-10-17 21:02:57,754 INFO:   項次: 0001
2025-10-17 21:02:57,754 INFO:   PO No: 6100814451
2025-10-17 21:02:57,754 INFO:   科目指派: K - 費用
2025-10-17 21:02:57,754 INFO:   品名: Service Labor K11-8F 3450 RB4更換電磁閥
2025-10-17 21:02:57,754 INFO:   數量: 3
2025-10-17 21:02:57,754 INFO:   取件者: 郭任?
2025-10-17 21:02:57,754 INFO: ------------------------------
2025-10-17 21:02:57,754 INFO: 第 6 筆:
2025-10-17 21:02:57,754 INFO:   RT No: 5000403919
2025-10-17 21:02:57,754 INFO:   項次: 0002
2025-10-17 21:02:57,754 INFO:   PO No: 6100814451
2025-10-17 21:02:57,754 INFO:   科目指派: K - 費用
2025-10-17 21:02:57,754 INFO:   品名: Service Labor K11-8F 3450 PLC 修改
2025-10-17 21:02:57,754 INFO:   數量: 3
2025-10-17 21:02:57,754 INFO:   取件者: 郭任?
2025-10-17 21:02:57,754 INFO: ------------------------------
2025-10-17 21:02:57,754 INFO: 第 7 筆:
2025-10-17 21:02:57,756 INFO:   RT No: 5000403920
2025-10-17 21:02:57,756 INFO:   項次: 0001
2025-10-17 21:02:57,756 INFO:   PO No: 6100815280
2025-10-17 21:02:57,756 INFO:   科目指派: K - 費用
2025-10-17 21:02:57,756 INFO:   品名: Service Labor PLC復歸上線(氣管更換)
2025-10-17 21:02:57,756 INFO:   數量: 3
2025-10-17 21:02:57,756 INFO:   取件者: 郭任?
2025-10-17 21:02:57,756 INFO: ------------------------------
2025-10-17 21:02:57,756 INFO: 第 8 筆:
2025-10-17 21:02:57,756 INFO:   RT No: 5000403920
2025-10-17 21:02:57,756 INFO:   項次: 0002
2025-10-17 21:02:57,756 INFO:   PO No: 6100815280
2025-10-17 21:02:57,756 INFO:   科目指派: K - 費用
2025-10-17 21:02:57,756 INFO:   品名: Service Labor PLC復歸上線(馬達修改定位)
2025-10-17 21:02:57,756 INFO:   數量: 3
2025-10-17 21:02:57,756 INFO:   取件者: 郭任?
2025-10-17 21:02:57,756 INFO: ------------------------------
2025-10-17 21:02:57,756 INFO: 第 9 筆:
2025-10-17 21:02:57,756 INFO:   RT No: 5000403920
2025-10-17 21:02:57,756 INFO:   項次: 0003
2025-10-17 21:02:57,756 INFO:   PO No: 6100815280
2025-10-17 21:02:57,756 INFO:   科目指派: K - 費用
2025-10-17 21:02:57,756 INFO:   品名: Service Labor PC異常查找&復歸上線
2025-10-17 21:02:57,756 INFO:   數量: 3
2025-10-17 21:02:57,756 INFO:   取件者: 郭任?
2025-10-17 21:02:57,756 INFO: ------------------------------
2025-10-17 21:02:57,756 INFO: 第 10 筆:
2025-10-17 21:02:57,757 INFO:   RT No: 5000403920
2025-10-17 21:02:57,757 INFO:   項次: 0004
2025-10-17 21:02:57,757 INFO:   PO No: 6100815280
2025-10-17 21:02:57,757 INFO:   科目指派: K - 費用
2025-10-17 21:02:57,757 INFO:   品名: Service Labor PC異常查找&復歸上線
2025-10-17 21:02:57,757 INFO:   數量: 3
2025-10-17 21:02:57,757 INFO:   取件者: 郭任?
2025-10-17 21:02:57,757 INFO: ------------------------------
2025-10-17 21:02:57,757 INFO: 第 11 筆:
2025-10-17 21:02:57,757 INFO:   RT No: 5000404571
2025-10-17 21:02:57,757 INFO:   項次: 0001
2025-10-17 21:02:57,757 INFO:   PO No: 6100815224
2025-10-17 21:02:57,757 INFO:   科目指派: K - 費用
2025-10-17 21:02:57,757 INFO:   品名: SICK GTE2F-N1131 光電感測器
2025-10-17 21:02:57,757 INFO:   數量: 5
2025-10-17 21:02:57,757 INFO:   取件者: AB門
2025-10-17 21:02:57,757 INFO: ------------------------------
2025-10-17 21:02:57,757 INFO: 第 12 筆:
2025-10-17 21:02:57,757 INFO:   RT No: 5000404571
2025-10-17 21:02:57,757 INFO:   項次: 0002
2025-10-17 21:02:57,757 INFO:   PO No: 6100815224
2025-10-17 21:02:57,757 INFO:   科目指派: K - 費用
2025-10-17 21:02:57,758 INFO:   品名: SICK GTE2F-E1131 光電感測器
2025-10-17 21:02:57,758 INFO:   數量: 5
2025-10-17 21:02:57,758 INFO:   取件者: AB門
2025-10-17 21:02:57,758 INFO: ------------------------------
2025-10-17 21:02:57,758 INFO: 第 13 筆:
2025-10-17 21:02:57,758 INFO:   RT No: 5000408665
2025-10-17 21:02:57,758 INFO:   項次: 0001
2025-10-17 21:02:57,758 INFO:   PO No: 6100822171
2025-10-17 21:02:57,758 INFO:   科目指派: K - 費用
2025-10-17 21:02:57,758 INFO:   品名: Mitsubishi AJ65VBTCE32-32DT CC-Link模組
2025-10-17 21:02:57,758 INFO:   數量: 2
2025-10-17 21:02:57,758 INFO:   取件者: D1
2025-10-17 21:02:57,758 INFO: ------------------------------
2025-10-17 21:02:57,758 INFO: 第 14 筆:
2025-10-17 21:02:57,758 INFO:   RT No: 5000412517
2025-10-17 21:02:57,758 INFO:   項次: 0001
2025-10-17 21:02:57,758 INFO:   PO No: A000421770
2025-10-17 21:02:57,758 INFO:   科目指派: K - 費用
2025-10-17 21:02:57,758 INFO:   品名: ESD標示膠帶 30mmX33M黃黑色
2025-10-17 21:02:57,758 INFO:   數量: 5
2025-10-17 21:02:57,758 INFO:   取件者: 王淑怡/14168
2025-10-17 21:02:57,758 INFO: ------------------------------
2025-10-17 21:02:57,758 INFO: 第 15 筆:
2025-10-17 21:02:57,758 INFO:   RT No: 5000413507
2025-10-17 21:02:57,758 INFO:   項次: 0001
2025-10-17 21:02:57,758 INFO:   PO No: 6100822075
2025-10-17 21:02:57,758 INFO:   科目指派: K - 費用
2025-10-17 21:02:57,758 INFO:   品名: CyberLink PowerDirector 365
2025-10-17 21:02:57,758 INFO:   數量: 1
2025-10-17 21:02:57,758 INFO:   取件者: C2
2025-10-17 21:02:57,758 INFO: ------------------------------
2025-10-17 21:02:57,758 INFO: ==================================================
2025-10-17 21:02:57,758 INFO: 127.0.0.1 - - [17/Oct/2025 21:02:57] "POST /api/parse-mhtml HTTP/1.1" 200 -
2025-10-17 21:03:03,691 INFO: 127.0.0.1 - - [17/Oct/2025 21:03:03] "OPTIONS /api/get-user-epr-data HTTP/1.1" 200 -
2025-10-17 21:03:03,717 INFO: 收到查詢請求，PO 號碼: ['6100819549', 'A000421817', 'A000421817', 'A000421817', '6100814451', '6100814451', '6100815280', '6100815280', '6100815280', '6100815280', '6100815224', '6100815224', '6100822171', 'A000421770', '6100822075']
2025-10-17 21:03:03,717 INFO: buyer_detail_df 狀態: 已載入
2025-10-17 21:03:03,717 INFO: planned_purchase_df 狀態: 已載入
2025-10-17 21:03:03,717 INFO: Buyer_detail 資料筆數: 392
2025-10-17 21:03:03,717 INFO: Buyer_detail 欄位: ['Id', '開單狀態', '交貨驗證', 'User', 'ePR No.', 'PO No.', 'Item', '品項', '規格', '數量', '總數', '單價', '總價', '備註', '字數', 'isEditing', 'backup', '_alertedItemLimit', 'Delivery Date 廠商承諾交期', 'SOD Qty 廠商承諾數量', '驗收數量', '拒收數量', '發票月份', 'WBS', '需求日', 'RT金額', 'RT總金額', '驗收狀態']
2025-10-17 21:03:03,717 INFO: Buyer_detail 前3筆 PO No.: [nan, nan, nan]
2025-10-17 21:03:03,717 INFO: Planned_purchase 資料筆數: 161
2025-10-17 21:03:03,717 INFO: Planned_purchase 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:03:03,717 INFO: Planned_purchase 前3筆 PO No.: [nan, '6100793959<br />6100793960', '6100794178']
2025-10-17 21:03:03,718 INFO: 開始處理 PO: 6100819549
2025-10-17 21:03:03,726 INFO: 查詢需求者，PO No: '6100819549'
2025-10-17 21:03:03,726 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:03:03,726 INFO: 查詢結果數量: 1
2025-10-17 21:03:03,726 INFO: 找到 PO 6100819549 的需求者: 周彥良 -> 周彥良
2025-10-17 21:03:03,726 INFO: 查詢 ePR No.，PO No: '6100819549'
2025-10-17 21:03:03,732 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:03:03,732 INFO: 將 PO No. 轉換為數字: 6100819549
2025-10-17 21:03:03,732 INFO: 數字匹配查詢到 1 筆結果
2025-10-17 21:03:03,733 INFO: 找到的 ePR No. 原始值: '2508310009', 類型: <class 'str'>
2025-10-17 21:03:03,733 INFO: ✓ 在 Buyer_detail 找到 PO 6100819549 的 ePR No.: 2508310009
2025-10-17 21:03:03,733 INFO: PO 6100819549 最終結果: User=周彥良, ePR=2508310009
2025-10-17 21:03:03,733 INFO: 開始處理 PO: A000421817
2025-10-17 21:03:03,739 INFO: 查詢需求者，PO No: 'A000421817'
2025-10-17 21:03:03,739 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:03:03,740 INFO: 查詢結果數量: 0
2025-10-17 21:03:03,740 INFO: 精確匹配失敗，嘗試部分匹配...
2025-10-17 21:03:03,741 INFO: 前5筆 PO No. 資料: ['', '6100793959<br />6100793960', '6100794178', '6100793173', '6100791953']
2025-10-17 21:03:03,741 INFO: 查詢 ePR No.，PO No: 'A000421817'
2025-10-17 21:03:03,746 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:03:03,746 INFO: 將 PO No. 轉換為數字: A000421817
2025-10-17 21:03:03,747 INFO: 數字匹配查詢到 0 筆結果
2025-10-17 21:03:03,747 WARNING: 在 Buyer_detail 中未找到 PO A000421817
2025-10-17 21:03:03,748 INFO: Buyer_detail 中的有效 PO No. 樣本: ['6100805547', '6100805547', '6100792926', '6100795093', '6100795095', '6100795094', '6100795093', '6100795981', '6100794681', '6100794897']
2025-10-17 21:03:03,748 INFO: Buyer_detail 查詢失敗，嘗試 Planned_Purchase 作為備用
2025-10-17 21:03:03,753 INFO: 從 Planned_Purchase 查詢 (共 161 筆資料)
2025-10-17 21:03:03,754 ERROR: ✗ 最終未找到 PO A000421817 的 ePR No.
2025-10-17 21:03:03,754 INFO: PO A000421817 最終結果: User=查無此資訊, ePR=查無此資訊
2025-10-17 21:03:03,754 INFO: 開始處理 PO: A000421817
2025-10-17 21:03:03,760 INFO: 查詢需求者，PO No: 'A000421817'
2025-10-17 21:03:03,760 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:03:03,761 INFO: 查詢結果數量: 0
2025-10-17 21:03:03,761 INFO: 精確匹配失敗，嘗試部分匹配...
2025-10-17 21:03:03,761 INFO: 前5筆 PO No. 資料: ['', '6100793959<br />6100793960', '6100794178', '6100793173', '6100791953']
2025-10-17 21:03:03,761 INFO: 查詢 ePR No.，PO No: 'A000421817'
2025-10-17 21:03:03,766 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:03:03,766 INFO: 將 PO No. 轉換為數字: A000421817
2025-10-17 21:03:03,767 INFO: 數字匹配查詢到 0 筆結果
2025-10-17 21:03:03,767 WARNING: 在 Buyer_detail 中未找到 PO A000421817
2025-10-17 21:03:03,767 INFO: Buyer_detail 中的有效 PO No. 樣本: ['6100805547', '6100805547', '6100792926', '6100795093', '6100795095', '6100795094', '6100795093', '6100795981', '6100794681', '6100794897']
2025-10-17 21:03:03,767 INFO: Buyer_detail 查詢失敗，嘗試 Planned_Purchase 作為備用
2025-10-17 21:03:03,772 INFO: 從 Planned_Purchase 查詢 (共 161 筆資料)
2025-10-17 21:03:03,773 ERROR: ✗ 最終未找到 PO A000421817 的 ePR No.
2025-10-17 21:03:03,773 INFO: PO A000421817 最終結果: User=查無此資訊, ePR=查無此資訊
2025-10-17 21:03:03,773 INFO: 開始處理 PO: A000421817
2025-10-17 21:03:03,779 INFO: 查詢需求者，PO No: 'A000421817'
2025-10-17 21:03:03,779 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:03:03,779 INFO: 查詢結果數量: 0
2025-10-17 21:03:03,779 INFO: 精確匹配失敗，嘗試部分匹配...
2025-10-17 21:03:03,780 INFO: 前5筆 PO No. 資料: ['', '6100793959<br />6100793960', '6100794178', '6100793173', '6100791953']
2025-10-17 21:03:03,780 INFO: 查詢 ePR No.，PO No: 'A000421817'
2025-10-17 21:03:03,785 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:03:03,785 INFO: 將 PO No. 轉換為數字: A000421817
2025-10-17 21:03:03,786 INFO: 數字匹配查詢到 0 筆結果
2025-10-17 21:03:03,786 WARNING: 在 Buyer_detail 中未找到 PO A000421817
2025-10-17 21:03:03,786 INFO: Buyer_detail 中的有效 PO No. 樣本: ['6100805547', '6100805547', '6100792926', '6100795093', '6100795095', '6100795094', '6100795093', '6100795981', '6100794681', '6100794897']
2025-10-17 21:03:03,786 INFO: Buyer_detail 查詢失敗，嘗試 Planned_Purchase 作為備用
2025-10-17 21:03:03,791 INFO: 從 Planned_Purchase 查詢 (共 161 筆資料)
2025-10-17 21:03:03,791 ERROR: ✗ 最終未找到 PO A000421817 的 ePR No.
2025-10-17 21:03:03,791 INFO: PO A000421817 最終結果: User=查無此資訊, ePR=查無此資訊
2025-10-17 21:03:03,791 INFO: 開始處理 PO: 6100814451
2025-10-17 21:03:03,796 INFO: 查詢需求者，PO No: '6100814451'
2025-10-17 21:03:03,796 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:03:03,796 INFO: 查詢結果數量: 1
2025-10-17 21:03:03,796 INFO: 找到 PO 6100814451 的需求者: 郭任群 -> 郭任群
2025-10-17 21:03:03,796 INFO: 查詢 ePR No.，PO No: '6100814451'
2025-10-17 21:03:03,802 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:03:03,802 INFO: 將 PO No. 轉換為數字: 6100814451
2025-10-17 21:03:03,803 INFO: 數字匹配查詢到 2 筆結果
2025-10-17 21:03:03,803 INFO: 找到的 ePR No. 原始值: '2508200047', 類型: <class 'str'>
2025-10-17 21:03:03,803 INFO: ✓ 在 Buyer_detail 找到 PO 6100814451 的 ePR No.: 2508200047
2025-10-17 21:03:03,803 INFO: PO 6100814451 最終結果: User=郭任群, ePR=2508200047
2025-10-17 21:03:03,803 INFO: 開始處理 PO: 6100814451
2025-10-17 21:03:03,807 INFO: 查詢需求者，PO No: '6100814451'
2025-10-17 21:03:03,807 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:03:03,808 INFO: 查詢結果數量: 1
2025-10-17 21:03:03,808 INFO: 找到 PO 6100814451 的需求者: 郭任群 -> 郭任群
2025-10-17 21:03:03,808 INFO: 查詢 ePR No.，PO No: '6100814451'
2025-10-17 21:03:03,813 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:03:03,813 INFO: 將 PO No. 轉換為數字: 6100814451
2025-10-17 21:03:03,814 INFO: 數字匹配查詢到 2 筆結果
2025-10-17 21:03:03,814 INFO: 找到的 ePR No. 原始值: '2508200047', 類型: <class 'str'>
2025-10-17 21:03:03,814 INFO: ✓ 在 Buyer_detail 找到 PO 6100814451 的 ePR No.: 2508200047
2025-10-17 21:03:03,814 INFO: PO 6100814451 最終結果: User=郭任群, ePR=2508200047
2025-10-17 21:03:03,814 INFO: 開始處理 PO: 6100815280
2025-10-17 21:03:03,819 INFO: 查詢需求者，PO No: '6100815280'
2025-10-17 21:03:03,819 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:03:03,820 INFO: 查詢結果數量: 1
2025-10-17 21:03:03,820 INFO: 找到 PO 6100815280 的需求者: 郭任群 -> 郭任群
2025-10-17 21:03:03,820 INFO: 查詢 ePR No.，PO No: '6100815280'
2025-10-17 21:03:03,825 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:03:03,825 INFO: 將 PO No. 轉換為數字: 6100815280
2025-10-17 21:03:03,826 INFO: 數字匹配查詢到 4 筆結果
2025-10-17 21:03:03,826 INFO: 找到的 ePR No. 原始值: '2508200063', 類型: <class 'str'>
2025-10-17 21:03:03,826 INFO: ✓ 在 Buyer_detail 找到 PO 6100815280 的 ePR No.: 2508200063
2025-10-17 21:03:03,826 INFO: PO 6100815280 最終結果: User=郭任群, ePR=2508200063
2025-10-17 21:03:03,826 INFO: 開始處理 PO: 6100815280
2025-10-17 21:03:03,832 INFO: 查詢需求者，PO No: '6100815280'
2025-10-17 21:03:03,832 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:03:03,833 INFO: 查詢結果數量: 1
2025-10-17 21:03:03,833 INFO: 找到 PO 6100815280 的需求者: 郭任群 -> 郭任群
2025-10-17 21:03:03,833 INFO: 查詢 ePR No.，PO No: '6100815280'
2025-10-17 21:03:03,838 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:03:03,838 INFO: 將 PO No. 轉換為數字: 6100815280
2025-10-17 21:03:03,839 INFO: 數字匹配查詢到 4 筆結果
2025-10-17 21:03:03,839 INFO: 找到的 ePR No. 原始值: '2508200063', 類型: <class 'str'>
2025-10-17 21:03:03,839 INFO: ✓ 在 Buyer_detail 找到 PO 6100815280 的 ePR No.: 2508200063
2025-10-17 21:03:03,839 INFO: PO 6100815280 最終結果: User=郭任群, ePR=2508200063
2025-10-17 21:03:03,839 INFO: 開始處理 PO: 6100815280
2025-10-17 21:03:03,843 INFO: 查詢需求者，PO No: '6100815280'
2025-10-17 21:03:03,843 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:03:03,844 INFO: 查詢結果數量: 1
2025-10-17 21:03:03,844 INFO: 找到 PO 6100815280 的需求者: 郭任群 -> 郭任群
2025-10-17 21:03:03,844 INFO: 查詢 ePR No.，PO No: '6100815280'
2025-10-17 21:03:03,850 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:03:03,850 INFO: 將 PO No. 轉換為數字: 6100815280
2025-10-17 21:03:03,850 INFO: 數字匹配查詢到 4 筆結果
2025-10-17 21:03:03,850 INFO: 找到的 ePR No. 原始值: '2508200063', 類型: <class 'str'>
2025-10-17 21:03:03,851 INFO: ✓ 在 Buyer_detail 找到 PO 6100815280 的 ePR No.: 2508200063
2025-10-17 21:03:03,851 INFO: PO 6100815280 最終結果: User=郭任群, ePR=2508200063
2025-10-17 21:03:03,851 INFO: 開始處理 PO: 6100815280
2025-10-17 21:03:03,856 INFO: 查詢需求者，PO No: '6100815280'
2025-10-17 21:03:03,856 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:03:03,856 INFO: 查詢結果數量: 1
2025-10-17 21:03:03,856 INFO: 找到 PO 6100815280 的需求者: 郭任群 -> 郭任群
2025-10-17 21:03:03,856 INFO: 查詢 ePR No.，PO No: '6100815280'
2025-10-17 21:03:03,861 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:03:03,861 INFO: 將 PO No. 轉換為數字: 6100815280
2025-10-17 21:03:03,861 INFO: 數字匹配查詢到 4 筆結果
2025-10-17 21:03:03,861 INFO: 找到的 ePR No. 原始值: '2508200063', 類型: <class 'str'>
2025-10-17 21:03:03,861 INFO: ✓ 在 Buyer_detail 找到 PO 6100815280 的 ePR No.: 2508200063
2025-10-17 21:03:03,861 INFO: PO 6100815280 最終結果: User=郭任群, ePR=2508200063
2025-10-17 21:03:03,861 INFO: 開始處理 PO: 6100815224
2025-10-17 21:03:03,866 INFO: 查詢需求者，PO No: '6100815224'
2025-10-17 21:03:03,867 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:03:03,867 INFO: 查詢結果數量: 1
2025-10-17 21:03:03,867 INFO: 找到 PO 6100815224 的需求者: 魏劭宇 -> 魏劭宇
2025-10-17 21:03:03,867 INFO: 查詢 ePR No.，PO No: '6100815224'
2025-10-17 21:03:03,873 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:03:03,873 INFO: 將 PO No. 轉換為數字: 6100815224
2025-10-17 21:03:03,873 INFO: 數字匹配查詢到 2 筆結果
2025-10-17 21:03:03,873 INFO: 找到的 ePR No. 原始值: '2508200102', 類型: <class 'str'>
2025-10-17 21:03:03,873 INFO: ✓ 在 Buyer_detail 找到 PO 6100815224 的 ePR No.: 2508200102
2025-10-17 21:03:03,874 INFO: PO 6100815224 最終結果: User=魏劭宇, ePR=2508200102
2025-10-17 21:03:03,874 INFO: 開始處理 PO: 6100815224
2025-10-17 21:03:03,878 INFO: 查詢需求者，PO No: '6100815224'
2025-10-17 21:03:03,878 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:03:03,879 INFO: 查詢結果數量: 1
2025-10-17 21:03:03,879 INFO: 找到 PO 6100815224 的需求者: 魏劭宇 -> 魏劭宇
2025-10-17 21:03:03,879 INFO: 查詢 ePR No.，PO No: '6100815224'
2025-10-17 21:03:03,884 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:03:03,884 INFO: 將 PO No. 轉換為數字: 6100815224
2025-10-17 21:03:03,884 INFO: 數字匹配查詢到 2 筆結果
2025-10-17 21:03:03,884 INFO: 找到的 ePR No. 原始值: '2508200102', 類型: <class 'str'>
2025-10-17 21:03:03,884 INFO: ✓ 在 Buyer_detail 找到 PO 6100815224 的 ePR No.: 2508200102
2025-10-17 21:03:03,884 INFO: PO 6100815224 最終結果: User=魏劭宇, ePR=2508200102
2025-10-17 21:03:03,885 INFO: 開始處理 PO: 6100822171
2025-10-17 21:03:03,889 INFO: 查詢需求者，PO No: '6100822171'
2025-10-17 21:03:03,889 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:03:03,890 INFO: 查詢結果數量: 0
2025-10-17 21:03:03,890 INFO: 精確匹配失敗，嘗試部分匹配...
2025-10-17 21:03:03,891 INFO: 部分匹配找到 PO 6100822171 的需求者: 周彥良 -> 周彥良
2025-10-17 21:03:03,891 INFO: 查詢 ePR No.，PO No: '6100822171'
2025-10-17 21:03:03,895 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:03:03,895 INFO: 將 PO No. 轉換為數字: 6100822171
2025-10-17 21:03:03,896 INFO: 數字匹配查詢到 1 筆結果
2025-10-17 21:03:03,896 INFO: 找到的 ePR No. 原始值: '2509080222', 類型: <class 'str'>
2025-10-17 21:03:03,896 INFO: ✓ 在 Buyer_detail 找到 PO 6100822171 的 ePR No.: 2509080222
2025-10-17 21:03:03,896 INFO: PO 6100822171 最終結果: User=周彥良, ePR=2509080222
2025-10-17 21:03:03,896 INFO: 開始處理 PO: A000421770
2025-10-17 21:03:03,901 INFO: 查詢需求者，PO No: 'A000421770'
2025-10-17 21:03:03,901 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:03:03,902 INFO: 查詢結果數量: 0
2025-10-17 21:03:03,902 INFO: 精確匹配失敗，嘗試部分匹配...
2025-10-17 21:03:03,902 INFO: 前5筆 PO No. 資料: ['', '6100793959<br />6100793960', '6100794178', '6100793173', '6100791953']
2025-10-17 21:03:03,902 INFO: 查詢 ePR No.，PO No: 'A000421770'
2025-10-17 21:03:03,907 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:03:03,907 INFO: 將 PO No. 轉換為數字: A000421770
2025-10-17 21:03:03,907 INFO: 數字匹配查詢到 0 筆結果
2025-10-17 21:03:03,907 WARNING: 在 Buyer_detail 中未找到 PO A000421770
2025-10-17 21:03:03,909 INFO: Buyer_detail 中的有效 PO No. 樣本: ['6100805547', '6100805547', '6100792926', '6100795093', '6100795095', '6100795094', '6100795093', '6100795981', '6100794681', '6100794897']
2025-10-17 21:03:03,909 INFO: Buyer_detail 查詢失敗，嘗試 Planned_Purchase 作為備用
2025-10-17 21:03:03,913 INFO: 從 Planned_Purchase 查詢 (共 161 筆資料)
2025-10-17 21:03:03,914 ERROR: ✗ 最終未找到 PO A000421770 的 ePR No.
2025-10-17 21:03:03,914 INFO: PO A000421770 最終結果: User=查無此資訊, ePR=查無此資訊
2025-10-17 21:03:03,914 INFO: 開始處理 PO: 6100822075
2025-10-17 21:03:03,918 INFO: 查詢需求者，PO No: '6100822075'
2025-10-17 21:03:03,918 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:03:03,919 INFO: 查詢結果數量: 0
2025-10-17 21:03:03,919 INFO: 精確匹配失敗，嘗試部分匹配...
2025-10-17 21:03:03,920 INFO: 部分匹配找到 PO 6100822075 的需求者: 黃心雨 -> 黃心雨
2025-10-17 21:03:03,920 INFO: 查詢 ePR No.，PO No: '6100822075'
2025-10-17 21:03:03,925 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:03:03,925 INFO: 將 PO No. 轉換為數字: 6100822075
2025-10-17 21:03:03,926 INFO: 數字匹配查詢到 1 筆結果
2025-10-17 21:03:03,926 INFO: 找到的 ePR No. 原始值: '2509160377', 類型: <class 'str'>
2025-10-17 21:03:03,926 INFO: ✓ 在 Buyer_detail 找到 PO 6100822075 的 ePR No.: 2509160377
2025-10-17 21:03:03,926 INFO: PO 6100822075 最終結果: User=黃心雨, ePR=2509160377
2025-10-17 21:03:03,926 INFO: 回傳完整結果: {'6100819549': {'user': '周彥良', 'eprNo': '2508310009'}, 'A000421817': {'user': '查無此資訊', 'eprNo': '查無此資訊'}, '6100814451': {'user': '郭任群', 'eprNo': '2508200047'}, '6100815280': {'user': '郭任群', 'eprNo': '2508200063'}, '6100815224': {'user': '魏劭宇', 'eprNo': '2508200102'}, '6100822171': {'user': '周彥良', 'eprNo': '2509080222'}, 'A000421770': {'user': '查無此資訊', 'eprNo': '查無此資訊'}, '6100822075': {'user': '黃心雨', 'eprNo': '2509160377'}}
2025-10-17 21:03:03,926 INFO: 127.0.0.1 - - [17/Oct/2025 21:03:03] "POST /api/get-user-epr-data HTTP/1.1" 200 -
2025-10-17 21:15:39,970 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\app.py', reloading
2025-10-17 21:15:40,054 INFO:  * Restarting with stat
2025-10-17 21:15:41,114 WARNING:  * Debugger is active!
2025-10-17 21:15:41,118 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:15:54,322 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\app.py', reloading
2025-10-17 21:15:54,411 INFO:  * Restarting with stat
2025-10-17 21:15:55,588 WARNING:  * Debugger is active!
2025-10-17 21:15:55,594 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:16:02,680 INFO: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-10-17 21:16:02,680 INFO: [33mPress CTRL+C to quit[0m
2025-10-17 21:16:02,681 INFO:  * Restarting with stat
2025-10-17 21:16:03,756 WARNING:  * Debugger is active!
2025-10-17 21:16:03,761 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:16:03,977 INFO: 127.0.0.1 - - [17/Oct/2025 21:16:03] "OPTIONS /api/save-mail HTTP/1.1" 200 -
2025-10-17 21:16:03,986 INFO: 準備發送郵件，共 15 筆資料
2025-10-17 21:16:03,993 INFO: ✅ 郵件發送成功，處理了 15 筆資料
2025-10-17 21:16:03,993 INFO: 127.0.0.1 - - [17/Oct/2025 21:16:03] "POST /api/save-mail HTTP/1.1" 200 -
2025-10-17 21:30:10,184 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\app.py', reloading
2025-10-17 21:30:10,282 INFO:  * Restarting with stat
2025-10-17 21:30:11,560 WARNING:  * Debugger is active!
2025-10-17 21:30:11,565 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:31:01,278 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\app.py', reloading
2025-10-17 21:31:01,368 INFO:  * Restarting with stat
2025-10-17 21:31:02,545 WARNING:  * Debugger is active!
2025-10-17 21:31:02,551 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:31:04,596 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\app.py', reloading
2025-10-17 21:31:04,697 INFO:  * Restarting with stat
2025-10-17 21:31:07,529 INFO: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-10-17 21:31:07,529 INFO: [33mPress CTRL+C to quit[0m
2025-10-17 21:31:07,532 INFO:  * Restarting with stat
2025-10-17 21:31:08,562 WARNING:  * Debugger is active!
2025-10-17 21:31:08,566 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:31:33,940 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\MailFunction\\acceptanceMail.py', reloading
2025-10-17 21:31:34,013 INFO:  * Restarting with stat
2025-10-17 21:31:35,214 WARNING:  * Debugger is active!
2025-10-17 21:31:35,218 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:32:31,100 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\MailFunction\\acceptanceMail.py', reloading
2025-10-17 21:32:31,195 INFO:  * Restarting with stat
2025-10-17 21:32:32,306 WARNING:  * Debugger is active!
2025-10-17 21:32:32,309 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:32:44,498 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\MailFunction\\acceptanceMail.py', reloading
2025-10-17 21:32:44,592 INFO:  * Restarting with stat
2025-10-17 21:32:45,767 WARNING:  * Debugger is active!
2025-10-17 21:32:45,771 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:32:46,808 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\MailFunction\\acceptanceMail.py', reloading
2025-10-17 21:32:46,895 INFO:  * Restarting with stat
2025-10-17 21:32:48,028 WARNING:  * Debugger is active!
2025-10-17 21:32:48,033 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:32:50,064 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\MailFunction\\acceptanceMail.py', reloading
2025-10-17 21:32:50,131 INFO:  * Restarting with stat
2025-10-17 21:32:51,106 WARNING:  * Debugger is active!
2025-10-17 21:32:51,111 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:33:04,302 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\MailFunction\\acceptanceMail.py', reloading
2025-10-17 21:33:04,367 INFO:  * Restarting with stat
2025-10-17 21:33:05,360 WARNING:  * Debugger is active!
2025-10-17 21:33:05,365 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:33:20,659 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\MailFunction\\acceptanceMail.py', reloading
2025-10-17 21:33:20,735 INFO:  * Restarting with stat
2025-10-17 21:33:21,688 WARNING:  * Debugger is active!
2025-10-17 21:33:21,692 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:33:29,824 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\MailFunction\\acceptanceMail.py', reloading
2025-10-17 21:33:29,889 INFO:  * Restarting with stat
2025-10-17 21:33:30,841 WARNING:  * Debugger is active!
2025-10-17 21:33:30,845 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:33:37,955 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\MailFunction\\acceptanceMail.py', reloading
2025-10-17 21:33:38,053 INFO:  * Restarting with stat
2025-10-17 21:33:39,118 WARNING:  * Debugger is active!
2025-10-17 21:33:39,123 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:33:49,298 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\MailFunction\\acceptanceMail.py', reloading
2025-10-17 21:33:49,389 INFO:  * Restarting with stat
2025-10-17 21:33:50,367 WARNING:  * Debugger is active!
2025-10-17 21:33:50,371 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:34:25,937 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\MailFunction\\acceptanceMail.py', reloading
2025-10-17 21:34:26,023 INFO:  * Restarting with stat
2025-10-17 21:34:28,469 INFO: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-10-17 21:34:28,469 INFO: [33mPress CTRL+C to quit[0m
2025-10-17 21:34:28,470 INFO:  * Restarting with stat
2025-10-17 21:34:29,547 WARNING:  * Debugger is active!
2025-10-17 21:34:29,551 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:34:53,168 INFO: 收到檔案: 物料收貨單-20250927.mhtml, 大小: 266738 字元
2025-10-17 21:34:53,168 INFO: 開始解析 MHTML 文件
2025-10-17 21:34:53,189 INFO: 使用選擇器 'table[id*="GridView1"]' 找到表格
2025-10-17 21:34:53,190 INFO: 成功使用 utf-8 解碼: 'cp20250806 =E5=AE=89=E5=85=A8=E6=8A=8A=E6=89=8B=E6=
=8E=A7=E5=88=B6=E7=B7=9A' -> 'cp20250806 安全把手控制線'
2025-10-17 21:34:53,190 INFO: 成功使用 utf-8 解碼: '=E9=BB=83=E9=83=81=E6=96=87' -> '黃郁文'
2025-10-17 21:34:53,190 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:34:53,191 INFO: 成功使用 utf-8 解碼: 'ASEK25-20259F-010 =E9=AB=98=E7=A9=BA=E6=B5=81=E9=81=
=93=E7=9B=B4=E7=AB=8B=E6=94=AF=E6=92=90=E6=9E=B6' -> 'ASEK25-20259F-010 高空流道直立支撐架'
2025-10-17 21:34:53,191 INFO: 成功使用 utf-8 解碼: '=E9=BB=83=E9=83=81=E6=96=87' -> '黃郁文'
2025-10-17 21:34:53,191 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:34:53,191 INFO: 成功使用 utf-8 解碼: 'CIM K25-8F =E6=89=8B=E8=87=82=E6=95=B4=E5=90=88 Fork=
 =E7=89=B9=E4=BB=95=E7=89=88' -> 'CIM K25-8F 手臂整合 Fork 特仕版'
2025-10-17 21:34:53,191 INFO: 成功使用 utf-8 解碼: '=E9=AD=8F=E5=8A=AD=E5=AE=87' -> '魏劭宇'
2025-10-17 21:34:53,191 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:34:53,191 INFO: 成功使用 utf-8 解碼: 'CIM K25-8F =E6=96=B0=E5=A2=9E=E8=A8=AD=E5=82=99=E8=
=AD=B7=E8=93=8B=E5=8A=A0=E5=9B=BA=E8=A3=9C=E5=BC=B7' -> 'CIM K25-8F 新增設備護蓋加固補強'
2025-10-17 21:34:53,191 INFO: 成功使用 utf-8 解碼: '=E9=AD=8F=E5=8A=AD=E5=AE=87' -> '魏劭宇'
2025-10-17 21:34:53,192 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:34:53,192 INFO: 成功使用 utf-8 解碼: 'KEYENCE LR-ZB250AN =E9=9B=B7=E5=B0=84=E5=82=B3=E6=84=
=9F=E5=99=A8' -> 'KEYENCE LR-ZB250AN 雷射傳感器'
2025-10-17 21:34:53,193 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:34:53,193 INFO: 成功使用 utf-8 解碼: 'KEYENCE LR-ZH500N =E9=9B=B7=E5=B0=84=E5=82=B3=E6=84=
=9F=E5=99=A8' -> 'KEYENCE LR-ZH500N 雷射傳感器'
2025-10-17 21:34:53,193 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:34:53,193 INFO: 成功使用 utf-8 解碼: 'S-Z2000000014  K11-8F_3800=E5=A4=A9=E8=BB=8A=E8=BC=
=89=E5=85=B7' -> 'S-Z2000000014  K11-8F_3800天車載具'
2025-10-17 21:34:53,193 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:34:53,194 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:34:53,194 INFO: 成功使用 utf-8 解碼: 'S-Z2000000014 VA-110B 3670Plasma=E6=89=8B=E8=87=82=
=E5=A4=BE=E7=88=AA' -> 'S-Z2000000014 VA-110B 3670Plasma手臂夾爪'
2025-10-17 21:34:53,194 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:34:53,194 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:34:53,195 INFO: 成功使用 utf-8 解碼: 'CIM K11-5F Underfill =E7=AC=AC23=E5=8D=80=E8=B5=B0=
=E8=A1=8C=E8=BB=B8' -> 'CIM K11-5F Underfill 第23區走行軸'
2025-10-17 21:34:53,195 INFO: 成功使用 utf-8 解碼: '=E5=91=A8=E5=BD=A5=E8=89=AF' -> '周彥良'
2025-10-17 21:34:53,195 INFO: 成功使用 utf-8 解碼: '=E8=B3=87=E7=94=A2' -> '資產'
2025-10-17 21:34:53,195 INFO: 成功使用 utf-8 解碼: 'CIM K11-5F Underfill =E7=AC=AC24=E5=8D=80=E8=B5=B0=
=E8=A1=8C=E8=BB=B8' -> 'CIM K11-5F Underfill 第24區走行軸'
2025-10-17 21:34:53,195 INFO: 成功使用 utf-8 解碼: '=E5=91=A8=E5=BD=A5=E8=89=AF' -> '周彥良'
2025-10-17 21:34:53,195 INFO: 成功使用 utf-8 解碼: '=E8=B3=87=E7=94=A2' -> '資產'
2025-10-17 21:34:53,195 INFO: 成功解析 10 筆資料
2025-10-17 21:34:53,195 INFO: ==================================================
2025-10-17 21:34:53,195 INFO: 解析結果:
2025-10-17 21:34:53,196 INFO: 檔案名稱: 物料收貨單-20250927.mhtml
2025-10-17 21:34:53,196 INFO: 解析筆數: 10
2025-10-17 21:34:53,196 INFO: ------------------------------
2025-10-17 21:34:53,196 INFO: 第 1 筆:
2025-10-17 21:34:53,196 INFO:   RT No: 5000388779
2025-10-17 21:34:53,196 INFO:   項次: 0001
2025-10-17 21:34:53,196 INFO:   PO No: 6100815363
2025-10-17 21:34:53,196 INFO:   科目指派: K - 費用
2025-10-17 21:34:53,196 INFO:   品名: cp20250806 安全把手控制線
2025-10-17 21:34:53,196 INFO:   數量: 80
2025-10-17 21:34:53,196 INFO:   取件者: 黃郁文
2025-10-17 21:34:53,196 INFO: ------------------------------
2025-10-17 21:34:53,196 INFO: 第 2 筆:
2025-10-17 21:34:53,196 INFO:   RT No: 5000388820
2025-10-17 21:34:53,196 INFO:   項次: 0001
2025-10-17 21:34:53,196 INFO:   PO No: 6100812964
2025-10-17 21:34:53,196 INFO:   科目指派: K - 費用
2025-10-17 21:34:53,196 INFO:   品名: ASEK25-20259F-010 高空流道直立支撐架
2025-10-17 21:34:53,196 INFO:   數量: 9
2025-10-17 21:34:53,196 INFO:   取件者: 黃郁文
2025-10-17 21:34:53,196 INFO: ------------------------------
2025-10-17 21:34:53,196 INFO: 第 3 筆:
2025-10-17 21:34:53,196 INFO:   RT No: 5000388880
2025-10-17 21:34:53,196 INFO:   項次: 0001
2025-10-17 21:34:53,196 INFO:   PO No: 6100802894
2025-10-17 21:34:53,196 INFO:   科目指派: K - 費用
2025-10-17 21:34:53,196 INFO:   品名: CIM K25-8F 手臂整合 Fork 特仕版
2025-10-17 21:34:53,197 INFO:   數量: 2
2025-10-17 21:34:53,197 INFO:   取件者: 魏劭宇
2025-10-17 21:34:53,197 INFO: ------------------------------
2025-10-17 21:34:53,197 INFO: 第 4 筆:
2025-10-17 21:34:53,197 INFO:   RT No: 5000388880
2025-10-17 21:34:53,197 INFO:   項次: 0002
2025-10-17 21:34:53,197 INFO:   PO No: 6100802894
2025-10-17 21:34:53,197 INFO:   科目指派: K - 費用
2025-10-17 21:34:53,197 INFO:   品名: CIM K25-8F 新增設備護蓋加固補強
2025-10-17 21:34:53,197 INFO:   數量: 2
2025-10-17 21:34:53,197 INFO:   取件者: 魏劭宇
2025-10-17 21:34:53,197 INFO: ------------------------------
2025-10-17 21:34:53,197 INFO: 第 5 筆:
2025-10-17 21:34:53,197 INFO:   RT No: 5000389962
2025-10-17 21:34:53,197 INFO:   項次: 0001
2025-10-17 21:34:53,197 INFO:   PO No: 6100818853
2025-10-17 21:34:53,197 INFO:   科目指派: K - 費用
2025-10-17 21:34:53,197 INFO:   品名: KEYENCE LR-ZB250AN 雷射傳感器
2025-10-17 21:34:53,197 INFO:   數量: 4
2025-10-17 21:34:53,197 INFO:   取件者: D1
2025-10-17 21:34:53,197 INFO: ------------------------------
2025-10-17 21:34:53,197 INFO: 第 6 筆:
2025-10-17 21:34:53,197 INFO:   RT No: 5000389963
2025-10-17 21:34:53,197 INFO:   項次: 0001
2025-10-17 21:34:53,197 INFO:   PO No: 6100818853
2025-10-17 21:34:53,197 INFO:   科目指派: K - 費用
2025-10-17 21:34:53,197 INFO:   品名: KEYENCE LR-ZH500N 雷射傳感器
2025-10-17 21:34:53,197 INFO:   數量: 4
2025-10-17 21:34:53,197 INFO:   取件者: D1
2025-10-17 21:34:53,197 INFO: ------------------------------
2025-10-17 21:34:53,197 INFO: 第 7 筆:
2025-10-17 21:34:53,197 INFO:   RT No: 5000395425
2025-10-17 21:34:53,197 INFO:   項次: 0001
2025-10-17 21:34:53,197 INFO:   PO No: 6100807975
2025-10-17 21:34:53,197 INFO:   科目指派: K - 費用
2025-10-17 21:34:53,197 INFO:   品名: S-Z2000000014  K11-8F_3800天車載具
2025-10-17 21:34:53,197 INFO:   數量: 3
2025-10-17 21:34:53,199 INFO:   取件者: 郭任?
2025-10-17 21:34:53,199 INFO: ------------------------------
2025-10-17 21:34:53,199 INFO: 第 8 筆:
2025-10-17 21:34:53,199 INFO:   RT No: 5000395426
2025-10-17 21:34:53,199 INFO:   項次: 0001
2025-10-17 21:34:53,199 INFO:   PO No: 6100812155
2025-10-17 21:34:53,199 INFO:   科目指派: K - 費用
2025-10-17 21:34:53,199 INFO:   品名: S-Z2000000014 VA-110B 3670Plasma手臂夾爪
2025-10-17 21:34:53,199 INFO:   數量: 2
2025-10-17 21:34:53,199 INFO:   取件者: 郭任?
2025-10-17 21:34:53,199 INFO: ------------------------------
2025-10-17 21:34:53,199 INFO: 第 9 筆:
2025-10-17 21:34:53,199 INFO:   RT No: 5000395696
2025-10-17 21:34:53,199 INFO:   項次: 0001
2025-10-17 21:34:53,199 INFO:   PO No: 6100800908
2025-10-17 21:34:53,199 INFO:   科目指派: A - 資產
2025-10-17 21:34:53,199 INFO:   品名: CIM K11-5F Underfill 第23區走行軸
2025-10-17 21:34:53,199 INFO:   數量: 1
2025-10-17 21:34:53,199 INFO:   取件者: 周彥良
2025-10-17 21:34:53,199 INFO: ------------------------------
2025-10-17 21:34:53,199 INFO: 第 10 筆:
2025-10-17 21:34:53,199 INFO:   RT No: 5000395696
2025-10-17 21:34:53,199 INFO:   項次: 0002
2025-10-17 21:34:53,199 INFO:   PO No: 6100800908
2025-10-17 21:34:53,199 INFO:   科目指派: A - 資產
2025-10-17 21:34:53,199 INFO:   品名: CIM K11-5F Underfill 第24區走行軸
2025-10-17 21:34:53,199 INFO:   數量: 1
2025-10-17 21:34:53,199 INFO:   取件者: 周彥良
2025-10-17 21:34:53,199 INFO: ------------------------------
2025-10-17 21:34:53,199 INFO: ==================================================
2025-10-17 21:34:53,200 INFO: 127.0.0.1 - - [17/Oct/2025 21:34:53] "POST /api/parse-mhtml HTTP/1.1" 200 -
2025-10-17 21:35:02,454 INFO: 127.0.0.1 - - [17/Oct/2025 21:35:02] "OPTIONS /api/get-user-epr-data HTTP/1.1" 200 -
2025-10-17 21:35:02,480 INFO: 收到查詢請求，PO 號碼: ['6100815363', '6100812964', '6100802894', '6100802894', '6100818853', '6100818853', '6100807975', '6100812155', '6100800908', '6100800908']
2025-10-17 21:35:02,480 INFO: buyer_detail_df 狀態: 已載入
2025-10-17 21:35:02,480 INFO: planned_purchase_df 狀態: 已載入
2025-10-17 21:35:02,480 INFO: Buyer_detail 資料筆數: 392
2025-10-17 21:35:02,480 INFO: Buyer_detail 欄位: ['Id', '開單狀態', '交貨驗證', 'User', 'ePR No.', 'PO No.', 'Item', '品項', '規格', '數量', '總數', '單價', '總價', '備註', '字數', 'isEditing', 'backup', '_alertedItemLimit', 'Delivery Date 廠商承諾交期', 'SOD Qty 廠商承諾數量', '驗收數量', '拒收數量', '發票月份', 'WBS', '需求日', 'RT金額', 'RT總金額', '驗收狀態']
2025-10-17 21:35:02,480 INFO: Buyer_detail 前3筆 PO No.: [nan, nan, nan]
2025-10-17 21:35:02,480 INFO: Planned_purchase 資料筆數: 161
2025-10-17 21:35:02,481 INFO: Planned_purchase 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:02,481 INFO: Planned_purchase 前3筆 PO No.: [nan, '6100793959<br />6100793960', '6100794178']
2025-10-17 21:35:02,481 INFO: 開始處理 PO: 6100815363
2025-10-17 21:35:02,487 INFO: 查詢需求者，PO No: '6100815363'
2025-10-17 21:35:02,487 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:02,488 INFO: 查詢結果數量: 1
2025-10-17 21:35:02,489 INFO: 找到 PO 6100815363 的需求者: 黃郁文 -> 黃郁文
2025-10-17 21:35:02,489 INFO: 查詢 ePR No.，PO No: '6100815363'
2025-10-17 21:35:02,495 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:02,495 INFO: 將 PO No. 轉換為數字: 6100815363
2025-10-17 21:35:02,496 INFO: 數字匹配查詢到 1 筆結果
2025-10-17 21:35:02,496 INFO: 找到的 ePR No. 原始值: '2508120166', 類型: <class 'str'>
2025-10-17 21:35:02,496 INFO: ✓ 在 Buyer_detail 找到 PO 6100815363 的 ePR No.: 2508120166
2025-10-17 21:35:02,496 INFO: PO 6100815363 最終結果: User=黃郁文, ePR=2508120166
2025-10-17 21:35:02,496 INFO: 開始處理 PO: 6100812964
2025-10-17 21:35:02,501 INFO: 查詢需求者，PO No: '6100812964'
2025-10-17 21:35:02,501 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:02,502 INFO: 查詢結果數量: 1
2025-10-17 21:35:02,502 INFO: 找到 PO 6100812964 的需求者: 黃郁文 -> 黃郁文
2025-10-17 21:35:02,502 INFO: 查詢 ePR No.，PO No: '6100812964'
2025-10-17 21:35:02,507 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:02,507 INFO: 將 PO No. 轉換為數字: 6100812964
2025-10-17 21:35:02,508 INFO: 數字匹配查詢到 1 筆結果
2025-10-17 21:35:02,508 INFO: 找到的 ePR No. 原始值: '2507240279', 類型: <class 'str'>
2025-10-17 21:35:02,508 INFO: ✓ 在 Buyer_detail 找到 PO 6100812964 的 ePR No.: 2507240279
2025-10-17 21:35:02,508 INFO: PO 6100812964 最終結果: User=黃郁文, ePR=2507240279
2025-10-17 21:35:02,508 INFO: 開始處理 PO: 6100802894
2025-10-17 21:35:02,514 INFO: 查詢需求者，PO No: '6100802894'
2025-10-17 21:35:02,514 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:02,515 INFO: 查詢結果數量: 1
2025-10-17 21:35:02,515 INFO: 找到 PO 6100802894 的需求者: 魏劭宇 -> 魏劭宇
2025-10-17 21:35:02,515 INFO: 查詢 ePR No.，PO No: '6100802894'
2025-10-17 21:35:02,521 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:02,522 INFO: 將 PO No. 轉換為數字: 6100802894
2025-10-17 21:35:02,522 INFO: 數字匹配查詢到 4 筆結果
2025-10-17 21:35:02,522 INFO: 找到的 ePR No. 原始值: '2506260125', 類型: <class 'str'>
2025-10-17 21:35:02,522 INFO: ✓ 在 Buyer_detail 找到 PO 6100802894 的 ePR No.: 2506260125
2025-10-17 21:35:02,522 INFO: PO 6100802894 最終結果: User=魏劭宇, ePR=2506260125
2025-10-17 21:35:02,522 INFO: 開始處理 PO: 6100802894
2025-10-17 21:35:02,528 INFO: 查詢需求者，PO No: '6100802894'
2025-10-17 21:35:02,528 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:02,529 INFO: 查詢結果數量: 1
2025-10-17 21:35:02,529 INFO: 找到 PO 6100802894 的需求者: 魏劭宇 -> 魏劭宇
2025-10-17 21:35:02,529 INFO: 查詢 ePR No.，PO No: '6100802894'
2025-10-17 21:35:02,534 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:02,534 INFO: 將 PO No. 轉換為數字: 6100802894
2025-10-17 21:35:02,534 INFO: 數字匹配查詢到 4 筆結果
2025-10-17 21:35:02,535 INFO: 找到的 ePR No. 原始值: '2506260125', 類型: <class 'str'>
2025-10-17 21:35:02,535 INFO: ✓ 在 Buyer_detail 找到 PO 6100802894 的 ePR No.: 2506260125
2025-10-17 21:35:02,535 INFO: PO 6100802894 最終結果: User=魏劭宇, ePR=2506260125
2025-10-17 21:35:02,535 INFO: 開始處理 PO: 6100818853
2025-10-17 21:35:02,540 INFO: 查詢需求者，PO No: '6100818853'
2025-10-17 21:35:02,540 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:02,541 INFO: 查詢結果數量: 1
2025-10-17 21:35:02,541 INFO: 找到 PO 6100818853 的需求者: 郭任群 -> 郭任群
2025-10-17 21:35:02,541 INFO: 查詢 ePR No.，PO No: '6100818853'
2025-10-17 21:35:02,546 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:02,546 INFO: 將 PO No. 轉換為數字: 6100818853
2025-10-17 21:35:02,547 INFO: 數字匹配查詢到 4 筆結果
2025-10-17 21:35:02,547 INFO: 找到的 ePR No. 原始值: '2509080424', 類型: <class 'str'>
2025-10-17 21:35:02,547 INFO: ✓ 在 Buyer_detail 找到 PO 6100818853 的 ePR No.: 2509080424
2025-10-17 21:35:02,547 INFO: PO 6100818853 最終結果: User=郭任群, ePR=2509080424
2025-10-17 21:35:02,547 INFO: 開始處理 PO: 6100818853
2025-10-17 21:35:02,551 INFO: 查詢需求者，PO No: '6100818853'
2025-10-17 21:35:02,551 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:02,551 INFO: 查詢結果數量: 1
2025-10-17 21:35:02,553 INFO: 找到 PO 6100818853 的需求者: 郭任群 -> 郭任群
2025-10-17 21:35:02,553 INFO: 查詢 ePR No.，PO No: '6100818853'
2025-10-17 21:35:02,557 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:02,557 INFO: 將 PO No. 轉換為數字: 6100818853
2025-10-17 21:35:02,558 INFO: 數字匹配查詢到 4 筆結果
2025-10-17 21:35:02,558 INFO: 找到的 ePR No. 原始值: '2509080424', 類型: <class 'str'>
2025-10-17 21:35:02,558 INFO: ✓ 在 Buyer_detail 找到 PO 6100818853 的 ePR No.: 2509080424
2025-10-17 21:35:02,558 INFO: PO 6100818853 最終結果: User=郭任群, ePR=2509080424
2025-10-17 21:35:02,558 INFO: 開始處理 PO: 6100807975
2025-10-17 21:35:02,563 INFO: 查詢需求者，PO No: '6100807975'
2025-10-17 21:35:02,563 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:02,563 INFO: 查詢結果數量: 1
2025-10-17 21:35:02,564 INFO: 找到 PO 6100807975 的需求者: 郭任群 -> 郭任群
2025-10-17 21:35:02,564 INFO: 查詢 ePR No.，PO No: '6100807975'
2025-10-17 21:35:02,569 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:02,569 INFO: 將 PO No. 轉換為數字: 6100807975
2025-10-17 21:35:02,569 INFO: 數字匹配查詢到 1 筆結果
2025-10-17 21:35:02,570 INFO: 找到的 ePR No. 原始值: '2507180202', 類型: <class 'str'>
2025-10-17 21:35:02,570 INFO: ✓ 在 Buyer_detail 找到 PO 6100807975 的 ePR No.: 2507180202
2025-10-17 21:35:02,570 INFO: PO 6100807975 最終結果: User=郭任群, ePR=2507180202
2025-10-17 21:35:02,570 INFO: 開始處理 PO: 6100812155
2025-10-17 21:35:02,575 INFO: 查詢需求者，PO No: '6100812155'
2025-10-17 21:35:02,575 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:02,576 INFO: 查詢結果數量: 1
2025-10-17 21:35:02,576 INFO: 找到 PO 6100812155 的需求者: 郭任群 -> 郭任群
2025-10-17 21:35:02,576 INFO: 查詢 ePR No.，PO No: '6100812155'
2025-10-17 21:35:02,581 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:02,583 INFO: 將 PO No. 轉換為數字: 6100812155
2025-10-17 21:35:02,583 INFO: 數字匹配查詢到 1 筆結果
2025-10-17 21:35:02,584 INFO: 找到的 ePR No. 原始值: '2508120185', 類型: <class 'str'>
2025-10-17 21:35:02,584 INFO: ✓ 在 Buyer_detail 找到 PO 6100812155 的 ePR No.: 2508120185
2025-10-17 21:35:02,584 INFO: PO 6100812155 最終結果: User=郭任群, ePR=2508120185
2025-10-17 21:35:02,584 INFO: 開始處理 PO: 6100800908
2025-10-17 21:35:02,588 INFO: 查詢需求者，PO No: '6100800908'
2025-10-17 21:35:02,588 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:02,589 INFO: 查詢結果數量: 1
2025-10-17 21:35:02,589 INFO: 找到 PO 6100800908 的需求者: 郭任群 -> 郭任群
2025-10-17 21:35:02,589 INFO: 查詢 ePR No.，PO No: '6100800908'
2025-10-17 21:35:02,595 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:02,595 INFO: 將 PO No. 轉換為數字: 6100800908
2025-10-17 21:35:02,595 INFO: 數字匹配查詢到 2 筆結果
2025-10-17 21:35:02,595 INFO: 找到的 ePR No. 原始值: '2506090320', 類型: <class 'str'>
2025-10-17 21:35:02,595 INFO: ✓ 在 Buyer_detail 找到 PO 6100800908 的 ePR No.: 2506090320
2025-10-17 21:35:02,596 INFO: PO 6100800908 最終結果: User=郭任群, ePR=2506090320
2025-10-17 21:35:02,596 INFO: 開始處理 PO: 6100800908
2025-10-17 21:35:02,601 INFO: 查詢需求者，PO No: '6100800908'
2025-10-17 21:35:02,601 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:02,602 INFO: 查詢結果數量: 1
2025-10-17 21:35:02,602 INFO: 找到 PO 6100800908 的需求者: 郭任群 -> 郭任群
2025-10-17 21:35:02,602 INFO: 查詢 ePR No.，PO No: '6100800908'
2025-10-17 21:35:02,606 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:02,606 INFO: 將 PO No. 轉換為數字: 6100800908
2025-10-17 21:35:02,606 INFO: 數字匹配查詢到 2 筆結果
2025-10-17 21:35:02,606 INFO: 找到的 ePR No. 原始值: '2506090320', 類型: <class 'str'>
2025-10-17 21:35:02,606 INFO: ✓ 在 Buyer_detail 找到 PO 6100800908 的 ePR No.: 2506090320
2025-10-17 21:35:02,606 INFO: PO 6100800908 最終結果: User=郭任群, ePR=2506090320
2025-10-17 21:35:02,606 INFO: 回傳完整結果: {'6100815363': {'user': '黃郁文', 'eprNo': '2508120166'}, '6100812964': {'user': '黃郁文', 'eprNo': '2507240279'}, '6100802894': {'user': '魏劭宇', 'eprNo': '2506260125'}, '6100818853': {'user': '郭任群', 'eprNo': '2509080424'}, '6100807975': {'user': '郭任群', 'eprNo': '2507180202'}, '6100812155': {'user': '郭任群', 'eprNo': '2508120185'}, '6100800908': {'user': '郭任群', 'eprNo': '2506090320'}}
2025-10-17 21:35:02,607 INFO: 127.0.0.1 - - [17/Oct/2025 21:35:02] "POST /api/get-user-epr-data HTTP/1.1" 200 -
2025-10-17 21:35:10,709 INFO: 127.0.0.1 - - [17/Oct/2025 21:35:10] "OPTIONS /api/save-mail HTTP/1.1" 200 -
2025-10-17 21:35:10,716 INFO: 準備發送郵件,共 10 筆資料
2025-10-17 21:35:10,719 INFO: 提取到的使用者: ['黃郁文', '魏劭宇', '郭任群']
2025-10-17 21:35:10,719 INFO: 使用者 黃郁文 -> 英文名: AlanYW
2025-10-17 21:35:10,720 INFO: 使用者 魏劭宇 -> 英文名: ShaoYu
2025-10-17 21:35:10,720 INFO: 使用者 郭任群 -> 英文名: Erix
2025-10-17 21:35:10,720 INFO: 生成的問候語: Dear AlanYW, ShaoYu, Erix
2025-10-17 21:35:10,720 INFO: 生成的問候語: Dear AlanYW, ShaoYu, Erix
2025-10-17 21:35:10,737 INFO: ✅ 郵件發送成功,處理了 10 筆資料
2025-10-17 21:35:10,738 INFO: 127.0.0.1 - - [17/Oct/2025 21:35:10] "POST /api/save-mail HTTP/1.1" 200 -
2025-10-17 21:35:47,556 INFO: 收到檔案: 物料收貨單-20250922.mhtml, 大小: 275281 字元
2025-10-17 21:35:47,557 INFO: 開始解析 MHTML 文件
2025-10-17 21:35:47,581 INFO: 使用選擇器 'table[id*="GridView1"]' 找到表格
2025-10-17 21:35:47,581 INFO: 成功使用 utf-8 解碼: 'Mitsubishi GS2110 HMI=E4=BA=BA=E6=A9=9F' -> 'Mitsubishi GS2110 HMI人機'
2025-10-17 21:35:47,581 INFO: 成功使用 utf-8 解碼: '=E6=B8=B8=E5=81=89=E6=98=93' -> '游偉易'
2025-10-17 21:35:47,581 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:35:47,583 INFO: 成功使用 utf-8 解碼: 'JVC 65W2 =E6=B6=B2=E6=99=B6=E9=A1=AF=E7=A4=BA=E5=99=
=A8 (65=E5=90=8B)' -> 'JVC 65W2 液晶顯示器 (65吋)'
2025-10-17 21:35:47,583 INFO: 成功使用 utf-8 解碼: '=E8=B6=99=E7=A5=A5=E5=AF=8C' -> '趙祥富'
2025-10-17 21:35:47,583 INFO: 成功使用 utf-8 解碼: '=E4=BD=8E=E9=A1=8D' -> '低額'
2025-10-17 21:35:47,583 INFO: 成功使用 utf-8 解碼: 'JVC 55W2 =E6=B6=B2=E6=99=B6=E9=A1=AF=E7=A4=BA=E5=99=
=A8 (55=E5=90=8B)' -> 'JVC 55W2 液晶顯示器 (55吋)'
2025-10-17 21:35:47,583 INFO: 成功使用 utf-8 解碼: '=E7=8E=8B=E6=9F=8F=E7=BF=B0/14547' -> '王柏翰/14547'
2025-10-17 21:35:47,583 INFO: 成功使用 utf-8 解碼: '=E4=BD=8E=E9=A1=8D' -> '低額'
2025-10-17 21:35:47,584 INFO: 成功使用 utf-8 解碼: 'Service Labor K11-8F 4110 =E7=A7=BB=E8=BC=89=E5=8F=
=B0=E8=BB=8A=E5=8F=AB=E4=BF=AE=E8=B2=BB' -> 'Service Labor K11-8F 4110 移載台車叫修費'
2025-10-17 21:35:47,584 INFO: 成功使用 utf-8 解碼: '=E6=96=BD=E6=96=87=E6=97=8C' -> '施文旌'
2025-10-17 21:35:47,584 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:35:47,584 INFO: 成功使用 utf-8 解碼: '=E9=8B=81=E6=93=A0=E5=9E=8B=E8=85=B3=E8=B8=8F=E6=A2=
=AF' -> '鋁擠型腳踏梯'
2025-10-17 21:35:47,585 INFO: 成功使用 utf-8 解碼: '=E9=BB=83=E9=83=81=E6=96=87' -> '黃郁文'
2025-10-17 21:35:47,585 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:35:47,585 INFO: 成功使用 utf-8 解碼: 'Basler A2A1920-51GMBAS =E5=B7=A5=E6=A5=ADCCD' -> 'Basler A2A1920-51GMBAS 工業CCD'
2025-10-17 21:35:47,585 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:35:47,585 INFO: 成功使用 utf-8 解碼: 'TUSS KV0814M2 =E5=B7=A5=E6=A5=AD=E9=8F=A1=E9=A0=AD' -> 'TUSS KV0814M2 工業鏡頭'
2025-10-17 21:35:47,585 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:35:47,586 INFO: 成功使用 utf-8 解碼: 'Basler GIGE-CABLE-5M-LEF CCD=E4=BF=A1=E8=99=9F=E7=B7=
=9A' -> 'Basler GIGE-CABLE-5M-LEF CCD信號線'
2025-10-17 21:35:47,586 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:35:47,586 INFO: 成功使用 utf-8 解碼: 'Basler Power-12V-6P-B-5M CCD=E9=9B=BB=E6=BA=90=E7=B7=
=9A' -> 'Basler Power-12V-6P-B-5M CCD電源線'
2025-10-17 21:35:47,586 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:35:47,586 INFO: 成功使用 utf-8 解碼: 'TBD-06-3450-1501 CV1#TURN=E4=B9=98=E8=BC=89=E5=8F=B0=' -> 'TBD-06-3450-1501 CV1#TURN乘載台'
2025-10-17 21:35:47,587 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:35:47,587 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:35:47,587 INFO: 成功使用 utf-8 解碼: 'TBD-06-3450-1502 CV1#TURN =E4=B9=98=E8=BC=89=E5=8F=
=B0(=E5=AF=AC=E6=9D=BF)' -> 'TBD-06-3450-1502 CV1#TURN 乘載台(寬板)'
2025-10-17 21:35:47,587 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:35:47,587 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:35:47,587 INFO: 成功使用 utf-8 解碼: 'TBD-06-3450-1503 =E9=99=90=E4=BD=8D=E5=A1=8A(=E7=9F=
=AD)' -> 'TBD-06-3450-1503 限位塊(短)'
2025-10-17 21:35:47,587 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:35:47,587 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:35:47,588 INFO: 成功使用 utf-8 解碼: 'TBD-06-3450-1504 =E9=99=90=E4=BD=8D=E5=A1=8A(=E9=95=
=B7)' -> 'TBD-06-3450-1504 限位塊(長)'
2025-10-17 21:35:47,588 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:35:47,588 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:35:47,588 INFO: 成功使用 utf-8 解碼: 'TBD-06-3450-1520 =E6=99=82=E8=A6=8F=E7=9A=AE=E5=B8=
=B6=E6=9E=B6=E6=A9=8B' -> 'TBD-06-3450-1520 時規皮帶架橋'
2025-10-17 21:35:47,588 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:35:47,588 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:35:47,588 INFO: 成功解析 14 筆資料
2025-10-17 21:35:47,588 INFO: ==================================================
2025-10-17 21:35:47,588 INFO: 解析結果:
2025-10-17 21:35:47,588 INFO: 檔案名稱: 物料收貨單-20250922.mhtml
2025-10-17 21:35:47,589 INFO: 解析筆數: 14
2025-10-17 21:35:47,589 INFO: ------------------------------
2025-10-17 21:35:47,589 INFO: 第 1 筆:
2025-10-17 21:35:47,589 INFO:   RT No: 5000375090
2025-10-17 21:35:47,589 INFO:   項次: 0001
2025-10-17 21:35:47,589 INFO:   PO No: 6100816013
2025-10-17 21:35:47,589 INFO:   科目指派: K - 費用
2025-10-17 21:35:47,589 INFO:   品名: Mitsubishi GS2110 HMI人機
2025-10-17 21:35:47,589 INFO:   數量: 2
2025-10-17 21:35:47,589 INFO:   取件者: 游偉易
2025-10-17 21:35:47,589 INFO: ------------------------------
2025-10-17 21:35:47,589 INFO: 第 2 筆:
2025-10-17 21:35:47,589 INFO:   RT No: 5000377903
2025-10-17 21:35:47,589 INFO:   項次: 0001
2025-10-17 21:35:47,589 INFO:   PO No: 6100814131
2025-10-17 21:35:47,589 INFO:   科目指派: R - 低額
2025-10-17 21:35:47,589 INFO:   品名: JVC 65W2 液晶顯示器 (65吋)
2025-10-17 21:35:47,589 INFO:   數量: 3
2025-10-17 21:35:47,589 INFO:   取件者: 趙祥富
2025-10-17 21:35:47,589 INFO: ------------------------------
2025-10-17 21:35:47,589 INFO: 第 3 筆:
2025-10-17 21:35:47,589 INFO:   RT No: 5000377904
2025-10-17 21:35:47,589 INFO:   項次: 0001
2025-10-17 21:35:47,589 INFO:   PO No: 6100814131
2025-10-17 21:35:47,589 INFO:   科目指派: R - 低額
2025-10-17 21:35:47,589 INFO:   品名: JVC 55W2 液晶顯示器 (55吋)
2025-10-17 21:35:47,589 INFO:   數量: 5
2025-10-17 21:35:47,589 INFO:   取件者: 王柏翰/14547
2025-10-17 21:35:47,589 INFO: ------------------------------
2025-10-17 21:35:47,590 INFO: 第 4 筆:
2025-10-17 21:35:47,590 INFO:   RT No: 5000379478
2025-10-17 21:35:47,590 INFO:   項次: 0001
2025-10-17 21:35:47,590 INFO:   PO No: 6100815040
2025-10-17 21:35:47,590 INFO:   科目指派: K - 費用
2025-10-17 21:35:47,590 INFO:   品名: Service Labor K11-8F 4110 移載台車叫修費
2025-10-17 21:35:47,590 INFO:   數量: 7.50
2025-10-17 21:35:47,590 INFO:   取件者: 施文旌
2025-10-17 21:35:47,590 INFO: ------------------------------
2025-10-17 21:35:47,590 INFO: 第 5 筆:
2025-10-17 21:35:47,590 INFO:   RT No: 5000379536
2025-10-17 21:35:47,590 INFO:   項次: 0001
2025-10-17 21:35:47,590 INFO:   PO No: 6100809343
2025-10-17 21:35:47,590 INFO:   科目指派: K - 費用
2025-10-17 21:35:47,590 INFO:   品名: 鋁擠型腳踏梯
2025-10-17 21:35:47,590 INFO:   數量: 6
2025-10-17 21:35:47,590 INFO:   取件者: 黃郁文
2025-10-17 21:35:47,590 INFO: ------------------------------
2025-10-17 21:35:47,590 INFO: 第 6 筆:
2025-10-17 21:35:47,590 INFO:   RT No: 5000384631
2025-10-17 21:35:47,590 INFO:   項次: 0001
2025-10-17 21:35:47,590 INFO:   PO No: 6100814986
2025-10-17 21:35:47,590 INFO:   科目指派: K - 費用
2025-10-17 21:35:47,590 INFO:   品名: Basler A2A1920-51GMBAS 工業CCD
2025-10-17 21:35:47,590 INFO:   數量: 4
2025-10-17 21:35:47,590 INFO:   取件者: X2
2025-10-17 21:35:47,590 INFO: ------------------------------
2025-10-17 21:35:47,590 INFO: 第 7 筆:
2025-10-17 21:35:47,591 INFO:   RT No: 5000384632
2025-10-17 21:35:47,591 INFO:   項次: 0001
2025-10-17 21:35:47,591 INFO:   PO No: 6100814986
2025-10-17 21:35:47,591 INFO:   科目指派: K - 費用
2025-10-17 21:35:47,591 INFO:   品名: TUSS KV0814M2 工業鏡頭
2025-10-17 21:35:47,591 INFO:   數量: 4
2025-10-17 21:35:47,591 INFO:   取件者: X2
2025-10-17 21:35:47,591 INFO: ------------------------------
2025-10-17 21:35:47,591 INFO: 第 8 筆:
2025-10-17 21:35:47,591 INFO:   RT No: 5000384633
2025-10-17 21:35:47,591 INFO:   項次: 0001
2025-10-17 21:35:47,591 INFO:   PO No: 6100814986
2025-10-17 21:35:47,591 INFO:   科目指派: K - 費用
2025-10-17 21:35:47,591 INFO:   品名: Basler GIGE-CABLE-5M-LEF CCD信號線
2025-10-17 21:35:47,591 INFO:   數量: 4
2025-10-17 21:35:47,591 INFO:   取件者: X2
2025-10-17 21:35:47,591 INFO: ------------------------------
2025-10-17 21:35:47,591 INFO: 第 9 筆:
2025-10-17 21:35:47,591 INFO:   RT No: 5000384634
2025-10-17 21:35:47,591 INFO:   項次: 0001
2025-10-17 21:35:47,591 INFO:   PO No: 6100814986
2025-10-17 21:35:47,592 INFO:   科目指派: K - 費用
2025-10-17 21:35:47,592 INFO:   品名: Basler Power-12V-6P-B-5M CCD電源線
2025-10-17 21:35:47,592 INFO:   數量: 4
2025-10-17 21:35:47,592 INFO:   取件者: X2
2025-10-17 21:35:47,592 INFO: ------------------------------
2025-10-17 21:35:47,592 INFO: 第 10 筆:
2025-10-17 21:35:47,592 INFO:   RT No: 5000386045
2025-10-17 21:35:47,592 INFO:   項次: 0001
2025-10-17 21:35:47,592 INFO:   PO No: 6100815414
2025-10-17 21:35:47,592 INFO:   科目指派: K - 費用
2025-10-17 21:35:47,592 INFO:   品名: TBD-06-3450-1501 CV1#TURN乘載台
2025-10-17 21:35:47,592 INFO:   數量: 1
2025-10-17 21:35:47,592 INFO:   取件者: 郭任?
2025-10-17 21:35:47,592 INFO: ------------------------------
2025-10-17 21:35:47,592 INFO: 第 11 筆:
2025-10-17 21:35:47,592 INFO:   RT No: 5000386045
2025-10-17 21:35:47,592 INFO:   項次: 0002
2025-10-17 21:35:47,592 INFO:   PO No: 6100815414
2025-10-17 21:35:47,592 INFO:   科目指派: K - 費用
2025-10-17 21:35:47,592 INFO:   品名: TBD-06-3450-1502 CV1#TURN 乘載台(寬板)
2025-10-17 21:35:47,592 INFO:   數量: 1
2025-10-17 21:35:47,592 INFO:   取件者: 郭任?
2025-10-17 21:35:47,592 INFO: ------------------------------
2025-10-17 21:35:47,593 INFO: 第 12 筆:
2025-10-17 21:35:47,593 INFO:   RT No: 5000386045
2025-10-17 21:35:47,593 INFO:   項次: 0003
2025-10-17 21:35:47,593 INFO:   PO No: 6100815414
2025-10-17 21:35:47,593 INFO:   科目指派: K - 費用
2025-10-17 21:35:47,593 INFO:   品名: TBD-06-3450-1503 限位塊(短)
2025-10-17 21:35:47,593 INFO:   數量: 4
2025-10-17 21:35:47,593 INFO:   取件者: 郭任?
2025-10-17 21:35:47,593 INFO: ------------------------------
2025-10-17 21:35:47,593 INFO: 第 13 筆:
2025-10-17 21:35:47,593 INFO:   RT No: 5000386045
2025-10-17 21:35:47,593 INFO:   項次: 0004
2025-10-17 21:35:47,593 INFO:   PO No: 6100815414
2025-10-17 21:35:47,593 INFO:   科目指派: K - 費用
2025-10-17 21:35:47,593 INFO:   品名: TBD-06-3450-1504 限位塊(長)
2025-10-17 21:35:47,593 INFO:   數量: 4
2025-10-17 21:35:47,593 INFO:   取件者: 郭任?
2025-10-17 21:35:47,593 INFO: ------------------------------
2025-10-17 21:35:47,593 INFO: 第 14 筆:
2025-10-17 21:35:47,593 INFO:   RT No: 5000386045
2025-10-17 21:35:47,593 INFO:   項次: 0005
2025-10-17 21:35:47,593 INFO:   PO No: 6100815414
2025-10-17 21:35:47,593 INFO:   科目指派: K - 費用
2025-10-17 21:35:47,593 INFO:   品名: TBD-06-3450-1520 時規皮帶架橋
2025-10-17 21:35:47,593 INFO:   數量: 1
2025-10-17 21:35:47,593 INFO:   取件者: 郭任?
2025-10-17 21:35:47,593 INFO: ------------------------------
2025-10-17 21:35:47,593 INFO: ==================================================
2025-10-17 21:35:47,594 INFO: 127.0.0.1 - - [17/Oct/2025 21:35:47] "POST /api/parse-mhtml HTTP/1.1" 200 -
2025-10-17 21:35:52,605 INFO: 127.0.0.1 - - [17/Oct/2025 21:35:52] "OPTIONS /api/get-user-epr-data HTTP/1.1" 200 -
2025-10-17 21:35:52,629 INFO: 收到查詢請求，PO 號碼: ['6100816013', '6100814131', '6100814131', '6100815040', '6100809343', '6100814986', '6100814986', '6100814986', '6100814986', '6100815414', '6100815414', '6100815414', '6100815414', '6100815414']
2025-10-17 21:35:52,629 INFO: buyer_detail_df 狀態: 已載入
2025-10-17 21:35:52,629 INFO: planned_purchase_df 狀態: 已載入
2025-10-17 21:35:52,629 INFO: Buyer_detail 資料筆數: 392
2025-10-17 21:35:52,629 INFO: Buyer_detail 欄位: ['Id', '開單狀態', '交貨驗證', 'User', 'ePR No.', 'PO No.', 'Item', '品項', '規格', '數量', '總數', '單價', '總價', '備註', '字數', 'isEditing', 'backup', '_alertedItemLimit', 'Delivery Date 廠商承諾交期', 'SOD Qty 廠商承諾數量', '驗收數量', '拒收數量', '發票月份', 'WBS', '需求日', 'RT金額', 'RT總金額', '驗收狀態']
2025-10-17 21:35:52,630 INFO: Buyer_detail 前3筆 PO No.: [nan, nan, nan]
2025-10-17 21:35:52,630 INFO: Planned_purchase 資料筆數: 161
2025-10-17 21:35:52,630 INFO: Planned_purchase 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:52,630 INFO: Planned_purchase 前3筆 PO No.: [nan, '6100793959<br />6100793960', '6100794178']
2025-10-17 21:35:52,630 INFO: 開始處理 PO: 6100816013
2025-10-17 21:35:52,634 INFO: 查詢需求者，PO No: '6100816013'
2025-10-17 21:35:52,635 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:52,635 INFO: 查詢結果數量: 1
2025-10-17 21:35:52,635 INFO: 找到 PO 6100816013 的需求者: 周彥良 -> 周彥良
2025-10-17 21:35:52,636 INFO: 查詢 ePR No.，PO No: '6100816013'
2025-10-17 21:35:52,643 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:52,643 INFO: 將 PO No. 轉換為數字: 6100816013
2025-10-17 21:35:52,643 INFO: 數字匹配查詢到 1 筆結果
2025-10-17 21:35:52,643 INFO: 找到的 ePR No. 原始值: '2508280217', 類型: <class 'str'>
2025-10-17 21:35:52,643 INFO: ✓ 在 Buyer_detail 找到 PO 6100816013 的 ePR No.: 2508280217
2025-10-17 21:35:52,644 INFO: PO 6100816013 最終結果: User=周彥良, ePR=2508280217
2025-10-17 21:35:52,644 INFO: 開始處理 PO: 6100814131
2025-10-17 21:35:52,649 INFO: 查詢需求者，PO No: '6100814131'
2025-10-17 21:35:52,649 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:52,650 INFO: 查詢結果數量: 1
2025-10-17 21:35:52,650 INFO: 找到 PO 6100814131 的需求者: 趙祥富 -> 趙祥富
2025-10-17 21:35:52,650 INFO: 查詢 ePR No.，PO No: '6100814131'
2025-10-17 21:35:52,658 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:52,658 INFO: 將 PO No. 轉換為數字: 6100814131
2025-10-17 21:35:52,658 INFO: 數字匹配查詢到 5 筆結果
2025-10-17 21:35:52,658 INFO: 找到的 ePR No. 原始值: '2508110466', 類型: <class 'str'>
2025-10-17 21:35:52,658 INFO: ✓ 在 Buyer_detail 找到 PO 6100814131 的 ePR No.: 2508110466
2025-10-17 21:35:52,659 INFO: PO 6100814131 最終結果: User=趙祥富, ePR=2508110466
2025-10-17 21:35:52,659 INFO: 開始處理 PO: 6100814131
2025-10-17 21:35:52,665 INFO: 查詢需求者，PO No: '6100814131'
2025-10-17 21:35:52,665 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:52,666 INFO: 查詢結果數量: 1
2025-10-17 21:35:52,666 INFO: 找到 PO 6100814131 的需求者: 趙祥富 -> 趙祥富
2025-10-17 21:35:52,666 INFO: 查詢 ePR No.，PO No: '6100814131'
2025-10-17 21:35:52,671 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:52,672 INFO: 將 PO No. 轉換為數字: 6100814131
2025-10-17 21:35:52,672 INFO: 數字匹配查詢到 5 筆結果
2025-10-17 21:35:52,672 INFO: 找到的 ePR No. 原始值: '2508110466', 類型: <class 'str'>
2025-10-17 21:35:52,672 INFO: ✓ 在 Buyer_detail 找到 PO 6100814131 的 ePR No.: 2508110466
2025-10-17 21:35:52,672 INFO: PO 6100814131 最終結果: User=趙祥富, ePR=2508110466
2025-10-17 21:35:52,672 INFO: 開始處理 PO: 6100815040
2025-10-17 21:35:52,677 INFO: 查詢需求者，PO No: '6100815040'
2025-10-17 21:35:52,677 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:52,678 INFO: 查詢結果數量: 1
2025-10-17 21:35:52,678 INFO: 找到 PO 6100815040 的需求者: 郭任群 -> 郭任群
2025-10-17 21:35:52,678 INFO: 查詢 ePR No.，PO No: '6100815040'
2025-10-17 21:35:52,684 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:52,684 INFO: 將 PO No. 轉換為數字: 6100815040
2025-10-17 21:35:52,684 INFO: 數字匹配查詢到 1 筆結果
2025-10-17 21:35:52,684 INFO: 找到的 ePR No. 原始值: '2508190319', 類型: <class 'str'>
2025-10-17 21:35:52,684 INFO: ✓ 在 Buyer_detail 找到 PO 6100815040 的 ePR No.: 2508190319
2025-10-17 21:35:52,684 INFO: PO 6100815040 最終結果: User=郭任群, ePR=2508190319
2025-10-17 21:35:52,685 INFO: 開始處理 PO: 6100809343
2025-10-17 21:35:52,689 INFO: 查詢需求者，PO No: '6100809343'
2025-10-17 21:35:52,690 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:52,691 INFO: 查詢結果數量: 1
2025-10-17 21:35:52,691 INFO: 找到 PO 6100809343 的需求者: 黃郁文 -> 黃郁文
2025-10-17 21:35:52,691 INFO: 查詢 ePR No.，PO No: '6100809343'
2025-10-17 21:35:52,696 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:52,696 INFO: 將 PO No. 轉換為數字: 6100809343
2025-10-17 21:35:52,697 INFO: 數字匹配查詢到 1 筆結果
2025-10-17 21:35:52,697 INFO: 找到的 ePR No. 原始值: '2507170283', 類型: <class 'str'>
2025-10-17 21:35:52,697 INFO: ✓ 在 Buyer_detail 找到 PO 6100809343 的 ePR No.: 2507170283
2025-10-17 21:35:52,697 INFO: PO 6100809343 最終結果: User=黃郁文, ePR=2507170283
2025-10-17 21:35:52,697 INFO: 開始處理 PO: 6100814986
2025-10-17 21:35:52,702 INFO: 查詢需求者，PO No: '6100814986'
2025-10-17 21:35:52,702 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:52,703 INFO: 查詢結果數量: 1
2025-10-17 21:35:52,703 INFO: 找到 PO 6100814986 的需求者: 趙祥富 -> 趙祥富
2025-10-17 21:35:52,703 INFO: 查詢 ePR No.，PO No: '6100814986'
2025-10-17 21:35:52,707 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:52,709 INFO: 將 PO No. 轉換為數字: 6100814986
2025-10-17 21:35:52,709 INFO: 數字匹配查詢到 4 筆結果
2025-10-17 21:35:52,709 INFO: 找到的 ePR No. 原始值: '2508180211', 類型: <class 'str'>
2025-10-17 21:35:52,709 INFO: ✓ 在 Buyer_detail 找到 PO 6100814986 的 ePR No.: 2508180211
2025-10-17 21:35:52,710 INFO: PO 6100814986 最終結果: User=趙祥富, ePR=2508180211
2025-10-17 21:35:52,710 INFO: 開始處理 PO: 6100814986
2025-10-17 21:35:52,714 INFO: 查詢需求者，PO No: '6100814986'
2025-10-17 21:35:52,715 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:52,715 INFO: 查詢結果數量: 1
2025-10-17 21:35:52,715 INFO: 找到 PO 6100814986 的需求者: 趙祥富 -> 趙祥富
2025-10-17 21:35:52,715 INFO: 查詢 ePR No.，PO No: '6100814986'
2025-10-17 21:35:52,721 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:52,721 INFO: 將 PO No. 轉換為數字: 6100814986
2025-10-17 21:35:52,723 INFO: 數字匹配查詢到 4 筆結果
2025-10-17 21:35:52,723 INFO: 找到的 ePR No. 原始值: '2508180211', 類型: <class 'str'>
2025-10-17 21:35:52,723 INFO: ✓ 在 Buyer_detail 找到 PO 6100814986 的 ePR No.: 2508180211
2025-10-17 21:35:52,723 INFO: PO 6100814986 最終結果: User=趙祥富, ePR=2508180211
2025-10-17 21:35:52,723 INFO: 開始處理 PO: 6100814986
2025-10-17 21:35:52,730 INFO: 查詢需求者，PO No: '6100814986'
2025-10-17 21:35:52,730 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:52,731 INFO: 查詢結果數量: 1
2025-10-17 21:35:52,731 INFO: 找到 PO 6100814986 的需求者: 趙祥富 -> 趙祥富
2025-10-17 21:35:52,731 INFO: 查詢 ePR No.，PO No: '6100814986'
2025-10-17 21:35:52,737 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:52,737 INFO: 將 PO No. 轉換為數字: 6100814986
2025-10-17 21:35:52,738 INFO: 數字匹配查詢到 4 筆結果
2025-10-17 21:35:52,738 INFO: 找到的 ePR No. 原始值: '2508180211', 類型: <class 'str'>
2025-10-17 21:35:52,738 INFO: ✓ 在 Buyer_detail 找到 PO 6100814986 的 ePR No.: 2508180211
2025-10-17 21:35:52,738 INFO: PO 6100814986 最終結果: User=趙祥富, ePR=2508180211
2025-10-17 21:35:52,738 INFO: 開始處理 PO: 6100814986
2025-10-17 21:35:52,744 INFO: 查詢需求者，PO No: '6100814986'
2025-10-17 21:35:52,744 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:52,745 INFO: 查詢結果數量: 1
2025-10-17 21:35:52,745 INFO: 找到 PO 6100814986 的需求者: 趙祥富 -> 趙祥富
2025-10-17 21:35:52,745 INFO: 查詢 ePR No.，PO No: '6100814986'
2025-10-17 21:35:52,750 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:52,750 INFO: 將 PO No. 轉換為數字: 6100814986
2025-10-17 21:35:52,751 INFO: 數字匹配查詢到 4 筆結果
2025-10-17 21:35:52,751 INFO: 找到的 ePR No. 原始值: '2508180211', 類型: <class 'str'>
2025-10-17 21:35:52,751 INFO: ✓ 在 Buyer_detail 找到 PO 6100814986 的 ePR No.: 2508180211
2025-10-17 21:35:52,751 INFO: PO 6100814986 最終結果: User=趙祥富, ePR=2508180211
2025-10-17 21:35:52,751 INFO: 開始處理 PO: 6100815414
2025-10-17 21:35:52,756 INFO: 查詢需求者，PO No: '6100815414'
2025-10-17 21:35:52,756 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:52,757 INFO: 查詢結果數量: 1
2025-10-17 21:35:52,757 INFO: 找到 PO 6100815414 的需求者: 郭任群 -> 郭任群
2025-10-17 21:35:52,757 INFO: 查詢 ePR No.，PO No: '6100815414'
2025-10-17 21:35:52,762 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:52,762 INFO: 將 PO No. 轉換為數字: 6100815414
2025-10-17 21:35:52,762 INFO: 數字匹配查詢到 5 筆結果
2025-10-17 21:35:52,762 INFO: 找到的 ePR No. 原始值: '2508250336', 類型: <class 'str'>
2025-10-17 21:35:52,762 INFO: ✓ 在 Buyer_detail 找到 PO 6100815414 的 ePR No.: 2508250336
2025-10-17 21:35:52,762 INFO: PO 6100815414 最終結果: User=郭任群, ePR=2508250336
2025-10-17 21:35:52,762 INFO: 開始處理 PO: 6100815414
2025-10-17 21:35:52,767 INFO: 查詢需求者，PO No: '6100815414'
2025-10-17 21:35:52,767 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:52,768 INFO: 查詢結果數量: 1
2025-10-17 21:35:52,768 INFO: 找到 PO 6100815414 的需求者: 郭任群 -> 郭任群
2025-10-17 21:35:52,768 INFO: 查詢 ePR No.，PO No: '6100815414'
2025-10-17 21:35:52,773 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:52,773 INFO: 將 PO No. 轉換為數字: 6100815414
2025-10-17 21:35:52,774 INFO: 數字匹配查詢到 5 筆結果
2025-10-17 21:35:52,774 INFO: 找到的 ePR No. 原始值: '2508250336', 類型: <class 'str'>
2025-10-17 21:35:52,774 INFO: ✓ 在 Buyer_detail 找到 PO 6100815414 的 ePR No.: 2508250336
2025-10-17 21:35:52,774 INFO: PO 6100815414 最終結果: User=郭任群, ePR=2508250336
2025-10-17 21:35:52,774 INFO: 開始處理 PO: 6100815414
2025-10-17 21:35:52,779 INFO: 查詢需求者，PO No: '6100815414'
2025-10-17 21:35:52,779 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:52,780 INFO: 查詢結果數量: 1
2025-10-17 21:35:52,780 INFO: 找到 PO 6100815414 的需求者: 郭任群 -> 郭任群
2025-10-17 21:35:52,780 INFO: 查詢 ePR No.，PO No: '6100815414'
2025-10-17 21:35:52,784 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:52,784 INFO: 將 PO No. 轉換為數字: 6100815414
2025-10-17 21:35:52,785 INFO: 數字匹配查詢到 5 筆結果
2025-10-17 21:35:52,785 INFO: 找到的 ePR No. 原始值: '2508250336', 類型: <class 'str'>
2025-10-17 21:35:52,785 INFO: ✓ 在 Buyer_detail 找到 PO 6100815414 的 ePR No.: 2508250336
2025-10-17 21:35:52,785 INFO: PO 6100815414 最終結果: User=郭任群, ePR=2508250336
2025-10-17 21:35:52,785 INFO: 開始處理 PO: 6100815414
2025-10-17 21:35:52,789 INFO: 查詢需求者，PO No: '6100815414'
2025-10-17 21:35:52,789 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:52,790 INFO: 查詢結果數量: 1
2025-10-17 21:35:52,790 INFO: 找到 PO 6100815414 的需求者: 郭任群 -> 郭任群
2025-10-17 21:35:52,791 INFO: 查詢 ePR No.，PO No: '6100815414'
2025-10-17 21:35:52,797 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:52,797 INFO: 將 PO No. 轉換為數字: 6100815414
2025-10-17 21:35:52,798 INFO: 數字匹配查詢到 5 筆結果
2025-10-17 21:35:52,798 INFO: 找到的 ePR No. 原始值: '2508250336', 類型: <class 'str'>
2025-10-17 21:35:52,798 INFO: ✓ 在 Buyer_detail 找到 PO 6100815414 的 ePR No.: 2508250336
2025-10-17 21:35:52,798 INFO: PO 6100815414 最終結果: User=郭任群, ePR=2508250336
2025-10-17 21:35:52,798 INFO: 開始處理 PO: 6100815414
2025-10-17 21:35:52,803 INFO: 查詢需求者，PO No: '6100815414'
2025-10-17 21:35:52,803 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:35:52,803 INFO: 查詢結果數量: 1
2025-10-17 21:35:52,803 INFO: 找到 PO 6100815414 的需求者: 郭任群 -> 郭任群
2025-10-17 21:35:52,804 INFO: 查詢 ePR No.，PO No: '6100815414'
2025-10-17 21:35:52,809 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:35:52,809 INFO: 將 PO No. 轉換為數字: 6100815414
2025-10-17 21:35:52,809 INFO: 數字匹配查詢到 5 筆結果
2025-10-17 21:35:52,809 INFO: 找到的 ePR No. 原始值: '2508250336', 類型: <class 'str'>
2025-10-17 21:35:52,809 INFO: ✓ 在 Buyer_detail 找到 PO 6100815414 的 ePR No.: 2508250336
2025-10-17 21:35:52,809 INFO: PO 6100815414 最終結果: User=郭任群, ePR=2508250336
2025-10-17 21:35:52,809 INFO: 回傳完整結果: {'6100816013': {'user': '周彥良', 'eprNo': '2508280217'}, '6100814131': {'user': '趙祥富', 'eprNo': '2508110466'}, '6100815040': {'user': '郭任群', 'eprNo': '2508190319'}, '6100809343': {'user': '黃郁文', 'eprNo': '2507170283'}, '6100814986': {'user': '趙祥富', 'eprNo': '2508180211'}, '6100815414': {'user': '郭任群', 'eprNo': '2508250336'}}
2025-10-17 21:35:52,810 INFO: 127.0.0.1 - - [17/Oct/2025 21:35:52] "POST /api/get-user-epr-data HTTP/1.1" 200 -
2025-10-17 21:35:55,248 INFO: 127.0.0.1 - - [17/Oct/2025 21:35:55] "OPTIONS /api/save-mail HTTP/1.1" 200 -
2025-10-17 21:35:55,255 INFO: 準備發送郵件,共 14 筆資料
2025-10-17 21:35:55,258 INFO: 提取到的使用者: ['周彥良', '趙祥富', '郭任群', '黃郁文']
2025-10-17 21:35:55,258 INFO: 使用者 周彥良 -> 英文名: YenLiang
2025-10-17 21:35:55,259 INFO: 使用者 趙祥富 -> 英文名: Zilong
2025-10-17 21:35:55,259 INFO: 使用者 郭任群 -> 英文名: Erix
2025-10-17 21:35:55,260 INFO: 使用者 黃郁文 -> 英文名: AlanYW
2025-10-17 21:35:55,260 INFO: 生成的問候語: Dear YenLiang, Zilong, Erix, AlanYW
2025-10-17 21:35:55,260 INFO: 生成的問候語: Dear YenLiang, Zilong, Erix, AlanYW
2025-10-17 21:35:55,265 INFO: ✅ 郵件發送成功,處理了 14 筆資料
2025-10-17 21:35:55,266 INFO: 127.0.0.1 - - [17/Oct/2025 21:35:55] "POST /api/save-mail HTTP/1.1" 200 -
2025-10-17 21:36:38,316 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\MailFunction\\acceptanceMail.py', reloading
2025-10-17 21:36:38,444 INFO:  * Restarting with stat
2025-10-17 21:36:39,867 WARNING:  * Debugger is active!
2025-10-17 21:36:39,873 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:41:59,672 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\app.py', reloading
2025-10-17 21:41:59,756 INFO:  * Restarting with stat
2025-10-17 21:42:03,014 INFO: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-10-17 21:42:03,014 INFO: [33mPress CTRL+C to quit[0m
2025-10-17 21:42:03,016 INFO:  * Restarting with stat
2025-10-17 21:42:04,155 WARNING:  * Debugger is active!
2025-10-17 21:42:04,161 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:43:16,280 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\app.py', reloading
2025-10-17 21:43:16,384 INFO:  * Restarting with stat
2025-10-17 21:43:17,544 WARNING:  * Debugger is active!
2025-10-17 21:43:17,549 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:43:46,046 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\MailFunction\\acceptanceMail.py', reloading
2025-10-17 21:43:46,137 INFO:  * Restarting with stat
2025-10-17 21:43:47,299 WARNING:  * Debugger is active!
2025-10-17 21:43:47,306 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:43:52,417 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\MailFunction\\acceptanceMail.py', reloading
2025-10-17 21:43:52,487 INFO:  * Restarting with stat
2025-10-17 21:43:55,012 INFO: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-10-17 21:43:55,012 INFO: [33mPress CTRL+C to quit[0m
2025-10-17 21:43:55,014 INFO:  * Restarting with stat
2025-10-17 21:43:56,101 WARNING:  * Debugger is active!
2025-10-17 21:43:56,106 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:44:00,372 INFO: 收到檔案: 物料收貨單-20250922.mhtml, 大小: 275281 字元
2025-10-17 21:44:00,372 INFO: 開始解析 MHTML 文件
2025-10-17 21:44:00,397 INFO: 使用選擇器 'table[id*="GridView1"]' 找到表格
2025-10-17 21:44:00,398 INFO: 成功使用 utf-8 解碼: 'Mitsubishi GS2110 HMI=E4=BA=BA=E6=A9=9F' -> 'Mitsubishi GS2110 HMI人機'
2025-10-17 21:44:00,398 INFO: 成功使用 utf-8 解碼: '=E6=B8=B8=E5=81=89=E6=98=93' -> '游偉易'
2025-10-17 21:44:00,398 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:44:00,399 INFO: 成功使用 utf-8 解碼: 'JVC 65W2 =E6=B6=B2=E6=99=B6=E9=A1=AF=E7=A4=BA=E5=99=
=A8 (65=E5=90=8B)' -> 'JVC 65W2 液晶顯示器 (65吋)'
2025-10-17 21:44:00,399 INFO: 成功使用 utf-8 解碼: '=E8=B6=99=E7=A5=A5=E5=AF=8C' -> '趙祥富'
2025-10-17 21:44:00,399 INFO: 成功使用 utf-8 解碼: '=E4=BD=8E=E9=A1=8D' -> '低額'
2025-10-17 21:44:00,399 INFO: 成功使用 utf-8 解碼: 'JVC 55W2 =E6=B6=B2=E6=99=B6=E9=A1=AF=E7=A4=BA=E5=99=
=A8 (55=E5=90=8B)' -> 'JVC 55W2 液晶顯示器 (55吋)'
2025-10-17 21:44:00,399 INFO: 成功使用 utf-8 解碼: '=E7=8E=8B=E6=9F=8F=E7=BF=B0/14547' -> '王柏翰/14547'
2025-10-17 21:44:00,399 INFO: 成功使用 utf-8 解碼: '=E4=BD=8E=E9=A1=8D' -> '低額'
2025-10-17 21:44:00,400 INFO: 成功使用 utf-8 解碼: 'Service Labor K11-8F 4110 =E7=A7=BB=E8=BC=89=E5=8F=
=B0=E8=BB=8A=E5=8F=AB=E4=BF=AE=E8=B2=BB' -> 'Service Labor K11-8F 4110 移載台車叫修費'
2025-10-17 21:44:00,400 INFO: 成功使用 utf-8 解碼: '=E6=96=BD=E6=96=87=E6=97=8C' -> '施文旌'
2025-10-17 21:44:00,400 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:44:00,400 INFO: 成功使用 utf-8 解碼: '=E9=8B=81=E6=93=A0=E5=9E=8B=E8=85=B3=E8=B8=8F=E6=A2=
=AF' -> '鋁擠型腳踏梯'
2025-10-17 21:44:00,400 INFO: 成功使用 utf-8 解碼: '=E9=BB=83=E9=83=81=E6=96=87' -> '黃郁文'
2025-10-17 21:44:00,400 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:44:00,401 INFO: 成功使用 utf-8 解碼: 'Basler A2A1920-51GMBAS =E5=B7=A5=E6=A5=ADCCD' -> 'Basler A2A1920-51GMBAS 工業CCD'
2025-10-17 21:44:00,401 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:44:00,401 INFO: 成功使用 utf-8 解碼: 'TUSS KV0814M2 =E5=B7=A5=E6=A5=AD=E9=8F=A1=E9=A0=AD' -> 'TUSS KV0814M2 工業鏡頭'
2025-10-17 21:44:00,401 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:44:00,401 INFO: 成功使用 utf-8 解碼: 'Basler GIGE-CABLE-5M-LEF CCD=E4=BF=A1=E8=99=9F=E7=B7=
=9A' -> 'Basler GIGE-CABLE-5M-LEF CCD信號線'
2025-10-17 21:44:00,401 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:44:00,402 INFO: 成功使用 utf-8 解碼: 'Basler Power-12V-6P-B-5M CCD=E9=9B=BB=E6=BA=90=E7=B7=
=9A' -> 'Basler Power-12V-6P-B-5M CCD電源線'
2025-10-17 21:44:00,402 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:44:00,402 INFO: 成功使用 utf-8 解碼: 'TBD-06-3450-1501 CV1#TURN=E4=B9=98=E8=BC=89=E5=8F=B0=' -> 'TBD-06-3450-1501 CV1#TURN乘載台'
2025-10-17 21:44:00,402 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:44:00,402 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:44:00,402 INFO: 成功使用 utf-8 解碼: 'TBD-06-3450-1502 CV1#TURN =E4=B9=98=E8=BC=89=E5=8F=
=B0(=E5=AF=AC=E6=9D=BF)' -> 'TBD-06-3450-1502 CV1#TURN 乘載台(寬板)'
2025-10-17 21:44:00,402 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:44:00,403 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:44:00,403 INFO: 成功使用 utf-8 解碼: 'TBD-06-3450-1503 =E9=99=90=E4=BD=8D=E5=A1=8A(=E7=9F=
=AD)' -> 'TBD-06-3450-1503 限位塊(短)'
2025-10-17 21:44:00,403 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:44:00,403 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:44:00,403 INFO: 成功使用 utf-8 解碼: 'TBD-06-3450-1504 =E9=99=90=E4=BD=8D=E5=A1=8A(=E9=95=
=B7)' -> 'TBD-06-3450-1504 限位塊(長)'
2025-10-17 21:44:00,403 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:44:00,403 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:44:00,404 INFO: 成功使用 utf-8 解碼: 'TBD-06-3450-1520 =E6=99=82=E8=A6=8F=E7=9A=AE=E5=B8=
=B6=E6=9E=B6=E6=A9=8B' -> 'TBD-06-3450-1520 時規皮帶架橋'
2025-10-17 21:44:00,404 INFO: 成功使用 utf-8 解碼: '=E9=83=AD=E4=BB=BB?' -> '郭任?'
2025-10-17 21:44:00,404 INFO: 成功使用 utf-8 解碼: '=E8=B2=BB=E7=94=A8' -> '費用'
2025-10-17 21:44:00,404 INFO: 成功解析 14 筆資料
2025-10-17 21:44:00,404 INFO: ==================================================
2025-10-17 21:44:00,404 INFO: 解析結果:
2025-10-17 21:44:00,404 INFO: 檔案名稱: 物料收貨單-20250922.mhtml
2025-10-17 21:44:00,404 INFO: 解析筆數: 14
2025-10-17 21:44:00,404 INFO: ------------------------------
2025-10-17 21:44:00,404 INFO: 第 1 筆:
2025-10-17 21:44:00,404 INFO:   RT No: 5000375090
2025-10-17 21:44:00,404 INFO:   項次: 0001
2025-10-17 21:44:00,404 INFO:   PO No: 6100816013
2025-10-17 21:44:00,404 INFO:   科目指派: K - 費用
2025-10-17 21:44:00,404 INFO:   品名: Mitsubishi GS2110 HMI人機
2025-10-17 21:44:00,404 INFO:   數量: 2
2025-10-17 21:44:00,404 INFO:   取件者: 游偉易
2025-10-17 21:44:00,405 INFO: ------------------------------
2025-10-17 21:44:00,405 INFO: 第 2 筆:
2025-10-17 21:44:00,405 INFO:   RT No: 5000377903
2025-10-17 21:44:00,405 INFO:   項次: 0001
2025-10-17 21:44:00,405 INFO:   PO No: 6100814131
2025-10-17 21:44:00,405 INFO:   科目指派: R - 低額
2025-10-17 21:44:00,405 INFO:   品名: JVC 65W2 液晶顯示器 (65吋)
2025-10-17 21:44:00,405 INFO:   數量: 3
2025-10-17 21:44:00,405 INFO:   取件者: 趙祥富
2025-10-17 21:44:00,405 INFO: ------------------------------
2025-10-17 21:44:00,405 INFO: 第 3 筆:
2025-10-17 21:44:00,405 INFO:   RT No: 5000377904
2025-10-17 21:44:00,405 INFO:   項次: 0001
2025-10-17 21:44:00,405 INFO:   PO No: 6100814131
2025-10-17 21:44:00,405 INFO:   科目指派: R - 低額
2025-10-17 21:44:00,405 INFO:   品名: JVC 55W2 液晶顯示器 (55吋)
2025-10-17 21:44:00,405 INFO:   數量: 5
2025-10-17 21:44:00,405 INFO:   取件者: 王柏翰/14547
2025-10-17 21:44:00,405 INFO: ------------------------------
2025-10-17 21:44:00,405 INFO: 第 4 筆:
2025-10-17 21:44:00,405 INFO:   RT No: 5000379478
2025-10-17 21:44:00,405 INFO:   項次: 0001
2025-10-17 21:44:00,405 INFO:   PO No: 6100815040
2025-10-17 21:44:00,405 INFO:   科目指派: K - 費用
2025-10-17 21:44:00,405 INFO:   品名: Service Labor K11-8F 4110 移載台車叫修費
2025-10-17 21:44:00,405 INFO:   數量: 7.50
2025-10-17 21:44:00,405 INFO:   取件者: 施文旌
2025-10-17 21:44:00,405 INFO: ------------------------------
2025-10-17 21:44:00,406 INFO: 第 5 筆:
2025-10-17 21:44:00,406 INFO:   RT No: 5000379536
2025-10-17 21:44:00,406 INFO:   項次: 0001
2025-10-17 21:44:00,406 INFO:   PO No: 6100809343
2025-10-17 21:44:00,406 INFO:   科目指派: K - 費用
2025-10-17 21:44:00,406 INFO:   品名: 鋁擠型腳踏梯
2025-10-17 21:44:00,406 INFO:   數量: 6
2025-10-17 21:44:00,406 INFO:   取件者: 黃郁文
2025-10-17 21:44:00,406 INFO: ------------------------------
2025-10-17 21:44:00,406 INFO: 第 6 筆:
2025-10-17 21:44:00,406 INFO:   RT No: 5000384631
2025-10-17 21:44:00,406 INFO:   項次: 0001
2025-10-17 21:44:00,406 INFO:   PO No: 6100814986
2025-10-17 21:44:00,406 INFO:   科目指派: K - 費用
2025-10-17 21:44:00,406 INFO:   品名: Basler A2A1920-51GMBAS 工業CCD
2025-10-17 21:44:00,406 INFO:   數量: 4
2025-10-17 21:44:00,406 INFO:   取件者: X2
2025-10-17 21:44:00,406 INFO: ------------------------------
2025-10-17 21:44:00,406 INFO: 第 7 筆:
2025-10-17 21:44:00,406 INFO:   RT No: 5000384632
2025-10-17 21:44:00,406 INFO:   項次: 0001
2025-10-17 21:44:00,406 INFO:   PO No: 6100814986
2025-10-17 21:44:00,406 INFO:   科目指派: K - 費用
2025-10-17 21:44:00,406 INFO:   品名: TUSS KV0814M2 工業鏡頭
2025-10-17 21:44:00,406 INFO:   數量: 4
2025-10-17 21:44:00,407 INFO:   取件者: X2
2025-10-17 21:44:00,407 INFO: ------------------------------
2025-10-17 21:44:00,407 INFO: 第 8 筆:
2025-10-17 21:44:00,407 INFO:   RT No: 5000384633
2025-10-17 21:44:00,407 INFO:   項次: 0001
2025-10-17 21:44:00,407 INFO:   PO No: 6100814986
2025-10-17 21:44:00,407 INFO:   科目指派: K - 費用
2025-10-17 21:44:00,407 INFO:   品名: Basler GIGE-CABLE-5M-LEF CCD信號線
2025-10-17 21:44:00,407 INFO:   數量: 4
2025-10-17 21:44:00,407 INFO:   取件者: X2
2025-10-17 21:44:00,407 INFO: ------------------------------
2025-10-17 21:44:00,407 INFO: 第 9 筆:
2025-10-17 21:44:00,407 INFO:   RT No: 5000384634
2025-10-17 21:44:00,407 INFO:   項次: 0001
2025-10-17 21:44:00,407 INFO:   PO No: 6100814986
2025-10-17 21:44:00,407 INFO:   科目指派: K - 費用
2025-10-17 21:44:00,407 INFO:   品名: Basler Power-12V-6P-B-5M CCD電源線
2025-10-17 21:44:00,407 INFO:   數量: 4
2025-10-17 21:44:00,407 INFO:   取件者: X2
2025-10-17 21:44:00,407 INFO: ------------------------------
2025-10-17 21:44:00,407 INFO: 第 10 筆:
2025-10-17 21:44:00,407 INFO:   RT No: 5000386045
2025-10-17 21:44:00,407 INFO:   項次: 0001
2025-10-17 21:44:00,407 INFO:   PO No: 6100815414
2025-10-17 21:44:00,407 INFO:   科目指派: K - 費用
2025-10-17 21:44:00,407 INFO:   品名: TBD-06-3450-1501 CV1#TURN乘載台
2025-10-17 21:44:00,407 INFO:   數量: 1
2025-10-17 21:44:00,408 INFO:   取件者: 郭任?
2025-10-17 21:44:00,408 INFO: ------------------------------
2025-10-17 21:44:00,408 INFO: 第 11 筆:
2025-10-17 21:44:00,408 INFO:   RT No: 5000386045
2025-10-17 21:44:00,408 INFO:   項次: 0002
2025-10-17 21:44:00,408 INFO:   PO No: 6100815414
2025-10-17 21:44:00,408 INFO:   科目指派: K - 費用
2025-10-17 21:44:00,408 INFO:   品名: TBD-06-3450-1502 CV1#TURN 乘載台(寬板)
2025-10-17 21:44:00,408 INFO:   數量: 1
2025-10-17 21:44:00,408 INFO:   取件者: 郭任?
2025-10-17 21:44:00,408 INFO: ------------------------------
2025-10-17 21:44:00,408 INFO: 第 12 筆:
2025-10-17 21:44:00,408 INFO:   RT No: 5000386045
2025-10-17 21:44:00,408 INFO:   項次: 0003
2025-10-17 21:44:00,408 INFO:   PO No: 6100815414
2025-10-17 21:44:00,408 INFO:   科目指派: K - 費用
2025-10-17 21:44:00,408 INFO:   品名: TBD-06-3450-1503 限位塊(短)
2025-10-17 21:44:00,408 INFO:   數量: 4
2025-10-17 21:44:00,408 INFO:   取件者: 郭任?
2025-10-17 21:44:00,408 INFO: ------------------------------
2025-10-17 21:44:00,408 INFO: 第 13 筆:
2025-10-17 21:44:00,408 INFO:   RT No: 5000386045
2025-10-17 21:44:00,408 INFO:   項次: 0004
2025-10-17 21:44:00,408 INFO:   PO No: 6100815414
2025-10-17 21:44:00,408 INFO:   科目指派: K - 費用
2025-10-17 21:44:00,408 INFO:   品名: TBD-06-3450-1504 限位塊(長)
2025-10-17 21:44:00,408 INFO:   數量: 4
2025-10-17 21:44:00,409 INFO:   取件者: 郭任?
2025-10-17 21:44:00,409 INFO: ------------------------------
2025-10-17 21:44:00,409 INFO: 第 14 筆:
2025-10-17 21:44:00,409 INFO:   RT No: 5000386045
2025-10-17 21:44:00,409 INFO:   項次: 0005
2025-10-17 21:44:00,409 INFO:   PO No: 6100815414
2025-10-17 21:44:00,409 INFO:   科目指派: K - 費用
2025-10-17 21:44:00,409 INFO:   品名: TBD-06-3450-1520 時規皮帶架橋
2025-10-17 21:44:00,409 INFO:   數量: 1
2025-10-17 21:44:00,409 INFO:   取件者: 郭任?
2025-10-17 21:44:00,409 INFO: ------------------------------
2025-10-17 21:44:00,409 INFO: ==================================================
2025-10-17 21:44:00,410 INFO: 127.0.0.1 - - [17/Oct/2025 21:44:00] "POST /api/parse-mhtml HTTP/1.1" 200 -
2025-10-17 21:44:10,317 INFO:  * Detected change in 'C:\\Users\\a9132\\Desktop\\預計請購_20220530-w03上版\\MailFunction\\acceptanceMail.py', reloading
2025-10-17 21:44:10,414 INFO:  * Restarting with stat
2025-10-17 21:44:12,531 INFO: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-10-17 21:44:12,531 INFO: [33mPress CTRL+C to quit[0m
2025-10-17 21:44:12,533 INFO:  * Restarting with stat
2025-10-17 21:44:13,529 WARNING:  * Debugger is active!
2025-10-17 21:44:13,533 INFO:  * Debugger PIN: 448-687-441
2025-10-17 21:44:16,861 INFO: 127.0.0.1 - - [17/Oct/2025 21:44:16] "OPTIONS /api/get-user-epr-data HTTP/1.1" 200 -
2025-10-17 21:44:16,891 INFO: 收到查詢請求，PO 號碼: ['6100816013', '6100814131', '6100814131', '6100815040', '6100809343', '6100814986', '6100814986', '6100814986', '6100814986', '6100815414', '6100815414', '6100815414', '6100815414', '6100815414']
2025-10-17 21:44:16,891 INFO: buyer_detail_df 狀態: 已載入
2025-10-17 21:44:16,891 INFO: planned_purchase_df 狀態: 已載入
2025-10-17 21:44:16,891 INFO: Buyer_detail 資料筆數: 392
2025-10-17 21:44:16,891 INFO: Buyer_detail 欄位: ['Id', '開單狀態', '交貨驗證', 'User', 'ePR No.', 'PO No.', 'Item', '品項', '規格', '數量', '總數', '單價', '總價', '備註', '字數', 'isEditing', 'backup', '_alertedItemLimit', 'Delivery Date 廠商承諾交期', 'SOD Qty 廠商承諾數量', '驗收數量', '拒收數量', '發票月份', 'WBS', '需求日', 'RT金額', 'RT總金額', '驗收狀態']
2025-10-17 21:44:16,892 INFO: Buyer_detail 前3筆 PO No.: [nan, nan, nan]
2025-10-17 21:44:16,892 INFO: Planned_purchase 資料筆數: 161
2025-10-17 21:44:16,892 INFO: Planned_purchase 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:44:16,892 INFO: Planned_purchase 前3筆 PO No.: [nan, '6100793959<br />6100793960', '6100794178']
2025-10-17 21:44:16,892 INFO: 開始處理 PO: 6100816013
2025-10-17 21:44:16,898 INFO: 查詢需求者，PO No: '6100816013'
2025-10-17 21:44:16,898 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:44:16,899 INFO: 查詢結果數量: 1
2025-10-17 21:44:16,900 INFO: 找到 PO 6100816013 的需求者: 周彥良 -> 周彥良
2025-10-17 21:44:16,900 INFO: 查詢 ePR No.，PO No: '6100816013'
2025-10-17 21:44:16,905 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:44:16,905 INFO: 將 PO No. 轉換為數字: 6100816013
2025-10-17 21:44:16,906 INFO: 數字匹配查詢到 1 筆結果
2025-10-17 21:44:16,906 INFO: 找到的 ePR No. 原始值: '2508280217', 類型: <class 'str'>
2025-10-17 21:44:16,906 INFO: ✓ 在 Buyer_detail 找到 PO 6100816013 的 ePR No.: 2508280217
2025-10-17 21:44:16,906 INFO: PO 6100816013 最終結果: User=周彥良, ePR=2508280217
2025-10-17 21:44:16,906 INFO: 開始處理 PO: 6100814131
2025-10-17 21:44:16,912 INFO: 查詢需求者，PO No: '6100814131'
2025-10-17 21:44:16,912 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:44:16,913 INFO: 查詢結果數量: 1
2025-10-17 21:44:16,913 INFO: 找到 PO 6100814131 的需求者: 趙祥富 -> 趙祥富
2025-10-17 21:44:16,913 INFO: 查詢 ePR No.，PO No: '6100814131'
2025-10-17 21:44:16,919 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:44:16,919 INFO: 將 PO No. 轉換為數字: 6100814131
2025-10-17 21:44:16,920 INFO: 數字匹配查詢到 5 筆結果
2025-10-17 21:44:16,920 INFO: 找到的 ePR No. 原始值: '2508110466', 類型: <class 'str'>
2025-10-17 21:44:16,920 INFO: ✓ 在 Buyer_detail 找到 PO 6100814131 的 ePR No.: 2508110466
2025-10-17 21:44:16,920 INFO: PO 6100814131 最終結果: User=趙祥富, ePR=2508110466
2025-10-17 21:44:16,920 INFO: 開始處理 PO: 6100814131
2025-10-17 21:44:16,926 INFO: 查詢需求者，PO No: '6100814131'
2025-10-17 21:44:16,926 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:44:16,927 INFO: 查詢結果數量: 1
2025-10-17 21:44:16,927 INFO: 找到 PO 6100814131 的需求者: 趙祥富 -> 趙祥富
2025-10-17 21:44:16,927 INFO: 查詢 ePR No.，PO No: '6100814131'
2025-10-17 21:44:16,932 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:44:16,932 INFO: 將 PO No. 轉換為數字: 6100814131
2025-10-17 21:44:16,932 INFO: 數字匹配查詢到 5 筆結果
2025-10-17 21:44:16,932 INFO: 找到的 ePR No. 原始值: '2508110466', 類型: <class 'str'>
2025-10-17 21:44:16,932 INFO: ✓ 在 Buyer_detail 找到 PO 6100814131 的 ePR No.: 2508110466
2025-10-17 21:44:16,932 INFO: PO 6100814131 最終結果: User=趙祥富, ePR=2508110466
2025-10-17 21:44:16,932 INFO: 開始處理 PO: 6100815040
2025-10-17 21:44:16,938 INFO: 查詢需求者，PO No: '6100815040'
2025-10-17 21:44:16,938 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:44:16,939 INFO: 查詢結果數量: 1
2025-10-17 21:44:16,939 INFO: 找到 PO 6100815040 的需求者: 郭任群 -> 郭任群
2025-10-17 21:44:16,939 INFO: 查詢 ePR No.，PO No: '6100815040'
2025-10-17 21:44:16,944 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:44:16,944 INFO: 將 PO No. 轉換為數字: 6100815040
2025-10-17 21:44:16,945 INFO: 數字匹配查詢到 1 筆結果
2025-10-17 21:44:16,945 INFO: 找到的 ePR No. 原始值: '2508190319', 類型: <class 'str'>
2025-10-17 21:44:16,945 INFO: ✓ 在 Buyer_detail 找到 PO 6100815040 的 ePR No.: 2508190319
2025-10-17 21:44:16,945 INFO: PO 6100815040 最終結果: User=郭任群, ePR=2508190319
2025-10-17 21:44:16,945 INFO: 開始處理 PO: 6100809343
2025-10-17 21:44:16,950 INFO: 查詢需求者，PO No: '6100809343'
2025-10-17 21:44:16,950 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:44:16,951 INFO: 查詢結果數量: 1
2025-10-17 21:44:16,951 INFO: 找到 PO 6100809343 的需求者: 黃郁文 -> 黃郁文
2025-10-17 21:44:16,951 INFO: 查詢 ePR No.，PO No: '6100809343'
2025-10-17 21:44:16,956 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:44:16,957 INFO: 將 PO No. 轉換為數字: 6100809343
2025-10-17 21:44:16,957 INFO: 數字匹配查詢到 1 筆結果
2025-10-17 21:44:16,957 INFO: 找到的 ePR No. 原始值: '2507170283', 類型: <class 'str'>
2025-10-17 21:44:16,957 INFO: ✓ 在 Buyer_detail 找到 PO 6100809343 的 ePR No.: 2507170283
2025-10-17 21:44:16,957 INFO: PO 6100809343 最終結果: User=黃郁文, ePR=2507170283
2025-10-17 21:44:16,957 INFO: 開始處理 PO: 6100814986
2025-10-17 21:44:16,962 INFO: 查詢需求者，PO No: '6100814986'
2025-10-17 21:44:16,962 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:44:16,962 INFO: 查詢結果數量: 1
2025-10-17 21:44:16,963 INFO: 找到 PO 6100814986 的需求者: 趙祥富 -> 趙祥富
2025-10-17 21:44:16,963 INFO: 查詢 ePR No.，PO No: '6100814986'
2025-10-17 21:44:16,968 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:44:16,968 INFO: 將 PO No. 轉換為數字: 6100814986
2025-10-17 21:44:16,969 INFO: 數字匹配查詢到 4 筆結果
2025-10-17 21:44:16,969 INFO: 找到的 ePR No. 原始值: '2508180211', 類型: <class 'str'>
2025-10-17 21:44:16,969 INFO: ✓ 在 Buyer_detail 找到 PO 6100814986 的 ePR No.: 2508180211
2025-10-17 21:44:16,969 INFO: PO 6100814986 最終結果: User=趙祥富, ePR=2508180211
2025-10-17 21:44:16,969 INFO: 開始處理 PO: 6100814986
2025-10-17 21:44:16,974 INFO: 查詢需求者，PO No: '6100814986'
2025-10-17 21:44:16,974 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:44:16,974 INFO: 查詢結果數量: 1
2025-10-17 21:44:16,975 INFO: 找到 PO 6100814986 的需求者: 趙祥富 -> 趙祥富
2025-10-17 21:44:16,975 INFO: 查詢 ePR No.，PO No: '6100814986'
2025-10-17 21:44:16,980 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:44:16,980 INFO: 將 PO No. 轉換為數字: 6100814986
2025-10-17 21:44:16,980 INFO: 數字匹配查詢到 4 筆結果
2025-10-17 21:44:16,980 INFO: 找到的 ePR No. 原始值: '2508180211', 類型: <class 'str'>
2025-10-17 21:44:16,980 INFO: ✓ 在 Buyer_detail 找到 PO 6100814986 的 ePR No.: 2508180211
2025-10-17 21:44:16,980 INFO: PO 6100814986 最終結果: User=趙祥富, ePR=2508180211
2025-10-17 21:44:16,980 INFO: 開始處理 PO: 6100814986
2025-10-17 21:44:16,986 INFO: 查詢需求者，PO No: '6100814986'
2025-10-17 21:44:16,986 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:44:16,987 INFO: 查詢結果數量: 1
2025-10-17 21:44:16,987 INFO: 找到 PO 6100814986 的需求者: 趙祥富 -> 趙祥富
2025-10-17 21:44:16,987 INFO: 查詢 ePR No.，PO No: '6100814986'
2025-10-17 21:44:16,992 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:44:16,992 INFO: 將 PO No. 轉換為數字: 6100814986
2025-10-17 21:44:16,992 INFO: 數字匹配查詢到 4 筆結果
2025-10-17 21:44:16,992 INFO: 找到的 ePR No. 原始值: '2508180211', 類型: <class 'str'>
2025-10-17 21:44:16,992 INFO: ✓ 在 Buyer_detail 找到 PO 6100814986 的 ePR No.: 2508180211
2025-10-17 21:44:16,992 INFO: PO 6100814986 最終結果: User=趙祥富, ePR=2508180211
2025-10-17 21:44:16,992 INFO: 開始處理 PO: 6100814986
2025-10-17 21:44:16,996 INFO: 查詢需求者，PO No: '6100814986'
2025-10-17 21:44:16,996 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:44:16,997 INFO: 查詢結果數量: 1
2025-10-17 21:44:16,997 INFO: 找到 PO 6100814986 的需求者: 趙祥富 -> 趙祥富
2025-10-17 21:44:16,997 INFO: 查詢 ePR No.，PO No: '6100814986'
2025-10-17 21:44:17,004 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:44:17,004 INFO: 將 PO No. 轉換為數字: 6100814986
2025-10-17 21:44:17,004 INFO: 數字匹配查詢到 4 筆結果
2025-10-17 21:44:17,005 INFO: 找到的 ePR No. 原始值: '2508180211', 類型: <class 'str'>
2025-10-17 21:44:17,005 INFO: ✓ 在 Buyer_detail 找到 PO 6100814986 的 ePR No.: 2508180211
2025-10-17 21:44:17,005 INFO: PO 6100814986 最終結果: User=趙祥富, ePR=2508180211
2025-10-17 21:44:17,005 INFO: 開始處理 PO: 6100815414
2025-10-17 21:44:17,009 INFO: 查詢需求者，PO No: '6100815414'
2025-10-17 21:44:17,009 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:44:17,010 INFO: 查詢結果數量: 1
2025-10-17 21:44:17,010 INFO: 找到 PO 6100815414 的需求者: 郭任群 -> 郭任群
2025-10-17 21:44:17,010 INFO: 查詢 ePR No.，PO No: '6100815414'
2025-10-17 21:44:17,015 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:44:17,015 INFO: 將 PO No. 轉換為數字: 6100815414
2025-10-17 21:44:17,016 INFO: 數字匹配查詢到 5 筆結果
2025-10-17 21:44:17,016 INFO: 找到的 ePR No. 原始值: '2508250336', 類型: <class 'str'>
2025-10-17 21:44:17,016 INFO: ✓ 在 Buyer_detail 找到 PO 6100815414 的 ePR No.: 2508250336
2025-10-17 21:44:17,016 INFO: PO 6100815414 最終結果: User=郭任群, ePR=2508250336
2025-10-17 21:44:17,016 INFO: 開始處理 PO: 6100815414
2025-10-17 21:44:17,021 INFO: 查詢需求者，PO No: '6100815414'
2025-10-17 21:44:17,021 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:44:17,021 INFO: 查詢結果數量: 1
2025-10-17 21:44:17,021 INFO: 找到 PO 6100815414 的需求者: 郭任群 -> 郭任群
2025-10-17 21:44:17,021 INFO: 查詢 ePR No.，PO No: '6100815414'
2025-10-17 21:44:17,026 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:44:17,027 INFO: 將 PO No. 轉換為數字: 6100815414
2025-10-17 21:44:17,027 INFO: 數字匹配查詢到 5 筆結果
2025-10-17 21:44:17,027 INFO: 找到的 ePR No. 原始值: '2508250336', 類型: <class 'str'>
2025-10-17 21:44:17,027 INFO: ✓ 在 Buyer_detail 找到 PO 6100815414 的 ePR No.: 2508250336
2025-10-17 21:44:17,027 INFO: PO 6100815414 最終結果: User=郭任群, ePR=2508250336
2025-10-17 21:44:17,027 INFO: 開始處理 PO: 6100815414
2025-10-17 21:44:17,032 INFO: 查詢需求者，PO No: '6100815414'
2025-10-17 21:44:17,032 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:44:17,033 INFO: 查詢結果數量: 1
2025-10-17 21:44:17,033 INFO: 找到 PO 6100815414 的需求者: 郭任群 -> 郭任群
2025-10-17 21:44:17,033 INFO: 查詢 ePR No.，PO No: '6100815414'
2025-10-17 21:44:17,037 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:44:17,037 INFO: 將 PO No. 轉換為數字: 6100815414
2025-10-17 21:44:17,037 INFO: 數字匹配查詢到 5 筆結果
2025-10-17 21:44:17,038 INFO: 找到的 ePR No. 原始值: '2508250336', 類型: <class 'str'>
2025-10-17 21:44:17,038 INFO: ✓ 在 Buyer_detail 找到 PO 6100815414 的 ePR No.: 2508250336
2025-10-17 21:44:17,038 INFO: PO 6100815414 最終結果: User=郭任群, ePR=2508250336
2025-10-17 21:44:17,038 INFO: 開始處理 PO: 6100815414
2025-10-17 21:44:17,043 INFO: 查詢需求者，PO No: '6100815414'
2025-10-17 21:44:17,043 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:44:17,044 INFO: 查詢結果數量: 1
2025-10-17 21:44:17,044 INFO: 找到 PO 6100815414 的需求者: 郭任群 -> 郭任群
2025-10-17 21:44:17,044 INFO: 查詢 ePR No.，PO No: '6100815414'
2025-10-17 21:44:17,050 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:44:17,050 INFO: 將 PO No. 轉換為數字: 6100815414
2025-10-17 21:44:17,050 INFO: 數字匹配查詢到 5 筆結果
2025-10-17 21:44:17,050 INFO: 找到的 ePR No. 原始值: '2508250336', 類型: <class 'str'>
2025-10-17 21:44:17,050 INFO: ✓ 在 Buyer_detail 找到 PO 6100815414 的 ePR No.: 2508250336
2025-10-17 21:44:17,050 INFO: PO 6100815414 最終結果: User=郭任群, ePR=2508250336
2025-10-17 21:44:17,050 INFO: 開始處理 PO: 6100815414
2025-10-17 21:44:17,055 INFO: 查詢需求者，PO No: '6100815414'
2025-10-17 21:44:17,055 INFO: Planned_Purchase CSV 欄位: ['Id', '開單狀態', 'WBS', '請購順序', '需求者', '請購項目', '需求原因', '總金額', '需求日', '已開單日期', 'ePR No.', '進度追蹤超連結', '備註', 'Status', '簽核中關卡', '報告路徑', '驗收路徑', '合作類別', '合作廠商', '前購單單號', '驗收狀態', 'PO No.']
2025-10-17 21:44:17,055 INFO: 查詢結果數量: 1
2025-10-17 21:44:17,055 INFO: 找到 PO 6100815414 的需求者: 郭任群 -> 郭任群
2025-10-17 21:44:17,056 INFO: 查詢 ePR No.，PO No: '6100815414'
2025-10-17 21:44:17,060 INFO: 從 Buyer_detail 查詢 (共 392 筆資料)
2025-10-17 21:44:17,061 INFO: 將 PO No. 轉換為數字: 6100815414
2025-10-17 21:44:17,061 INFO: 數字匹配查詢到 5 筆結果
2025-10-17 21:44:17,061 INFO: 找到的 ePR No. 原始值: '2508250336', 類型: <class 'str'>
2025-10-17 21:44:17,061 INFO: ✓ 在 Buyer_detail 找到 PO 6100815414 的 ePR No.: 2508250336
2025-10-17 21:44:17,061 INFO: PO 6100815414 最終結果: User=郭任群, ePR=2508250336
2025-10-17 21:44:17,061 INFO: 回傳完整結果: {'6100816013': {'user': '周彥良', 'eprNo': '2508280217'}, '6100814131': {'user': '趙祥富', 'eprNo': '2508110466'}, '6100815040': {'user': '郭任群', 'eprNo': '2508190319'}, '6100809343': {'user': '黃郁文', 'eprNo': '2507170283'}, '6100814986': {'user': '趙祥富', 'eprNo': '2508180211'}, '6100815414': {'user': '郭任群', 'eprNo': '2508250336'}}
2025-10-17 21:44:17,062 INFO: 127.0.0.1 - - [17/Oct/2025 21:44:17] "POST /api/get-user-epr-data HTTP/1.1" 200 -
2025-10-17 21:44:22,440 INFO: 127.0.0.1 - - [17/Oct/2025 21:44:22] "OPTIONS /api/save-mail HTTP/1.1" 200 -
2025-10-17 21:44:22,447 INFO: 準備發送郵件,共 14 筆資料
2025-10-17 21:44:22,450 INFO: 提取到的使用者: ['周彥良', '趙祥富', '郭任群', '黃郁文']
2025-10-17 21:44:22,450 INFO: 使用者 周彥良 -> 英文名: YenLiang
2025-10-17 21:44:22,451 INFO: 使用者 趙祥富 -> 英文名: Zilong
2025-10-17 21:44:22,451 INFO: 使用者 郭任群 -> 英文名: Erix
2025-10-17 21:44:22,452 INFO: 使用者 黃郁文 -> 英文名: AlanYW
2025-10-17 21:44:22,452 INFO: 生成的問候語: Dear YenLiang, Zilong, Erix, AlanYW
2025-10-17 21:44:22,452 INFO: 生成的問候語: Dear YenLiang, Zilong, Erix, AlanYW
2025-10-17 21:44:22,452 INFO: PO字串: 6100816013、6100814131、6100814986、6100815414、6100809343、6100815040
2025-10-17 21:44:22,452 INFO: TO 收件人: YenLiang_Chou@aseglobal.com,Zilong_Chao@aseglobal.com,Erix_Kuo@aseglobal.com,AlanYW_Huang@aseglobal.com
2025-10-17 21:44:22,452 INFO: TO 字串: Zilong, AlanYW, Erix, YenLiang
2025-10-17 21:44:22,452 INFO: 問候語: Dear YenLiang, Zilong, Erix, AlanYW
2025-10-17 21:44:22,458 INFO: ✅ 郵件發送成功,處理了 14 筆資料
2025-10-17 21:44:22,458 INFO: 127.0.0.1 - - [17/Oct/2025 21:44:22] "POST /api/save-mail HTTP/1.1" 200 -
2025-10-18 00:03:25,114 INFO: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-10-18 00:03:25,114 INFO: [33mPress CTRL+C to quit[0m
2025-10-18 00:03:25,116 INFO:  * Restarting with stat
2025-10-18 00:03:26,414 WARNING:  * Debugger is active!
2025-10-18 00:03:26,418 INFO:  * Debugger PIN: 448-687-441
2025-10-18 00:03:26,454 INFO: 127.0.0.1 - - [18/Oct/2025 00:03:26] "GET /api/get_unaccounted_amount HTTP/1.1" 200 -
2025-10-18 00:03:26,582 INFO: 127.0.0.1 - - [18/Oct/2025 00:03:26] "GET /api/accounting_summary HTTP/1.1" 200 -
2025-10-18 00:03:26,630 INFO: 127.0.0.1 - - [18/Oct/2025 00:03:26] "GET /api/monthly_actual_accounting HTTP/1.1" 200 -
2025-10-18 00:03:26,658 INFO: 127.0.0.1 - - [18/Oct/2025 00:03:26] "GET /api/getrestofmoney HTTP/1.1" 200 -
2025-10-18 00:04:05,965 INFO: 127.0.0.1 - - [18/Oct/2025 00:04:05] "GET /api/admins HTTP/1.1" 200 -
2025-10-18 00:04:06,023 INFO: 127.0.0.1 - - [18/Oct/2025 00:04:06] "GET /api/buyer_detail HTTP/1.1" 200 -
2025-10-18 00:04:06,084 INFO: 127.0.0.1 - - [18/Oct/2025 00:04:06] "GET /api/get_unaccounted_amount HTTP/1.1" 200 -
2025-10-18 00:04:06,419 INFO: 127.0.0.1 - - [18/Oct/2025 00:04:06] "GET /api/accounting_summary HTTP/1.1" 200 -
2025-10-18 00:04:06,498 INFO: 127.0.0.1 - - [18/Oct/2025 00:04:06] "GET /api/monthly_actual_accounting HTTP/1.1" 200 -
2025-10-18 00:04:06,532 INFO: 127.0.0.1 - - [18/Oct/2025 00:04:06] "GET /api/getrestofmoney HTTP/1.1" 200 -
2025-10-18 00:06:40,258 INFO: 127.0.0.1 - - [18/Oct/2025 00:06:40] "OPTIONS /api/save_csv HTTP/1.1" 200 -
2025-10-18 00:06:40,272 INFO: ✅ 已儲存 uploads/6100822325.csv (4 筆資料)
2025-10-18 00:06:40,273 INFO: ✅ 已儲存 uploads/6100817457.csv (4 筆資料)
2025-10-18 00:06:40,297 INFO: 總資料筆數: 390, 有效資料(狀態=V): 329
2025-10-18 00:06:40,326 INFO: ⚠️ 筆數不符: PO=6100817457, Item=0010, XLS=2筆, CSV=1筆
2025-10-18 00:06:40,327 INFO: ⚠️ 筆數不符: PO=6100817457, Item=0020, XLS=2筆, CSV=1筆
2025-10-18 00:06:40,329 INFO: 處理 PO 6100822325 的 Item 0010
2025-10-18 00:06:40,329 INFO:   找到 Buyer Item 0010, 品名: SMC KQ2H06-00A 快速接頭
2025-10-18 00:06:40,332 INFO:   ✅ 完全相同
2025-10-18 00:06:40,332 INFO: 處理 PO 6100822325 的 Item 0020
2025-10-18 00:06:40,332 INFO:   找到 Buyer Item 0020, 品名: SMC TU0604B-100 AIR管
2025-10-18 00:06:40,332 INFO:   ✅ 完全相同
2025-10-18 00:06:40,333 INFO: 處理 PO 6100822325 的 Item 0030
2025-10-18 00:06:40,333 INFO:   找到 Buyer Item 0030, 品名: SMC TU0805B-100 AIR管
2025-10-18 00:06:40,334 INFO:   ✅ 完全相同
2025-10-18 00:06:40,334 INFO: 處理 PO 6100822325 的 Item 0040
2025-10-18 00:06:40,334 INFO:   找到 Buyer Item 0040, 品名: SMC TU1065B-100 AIR管
2025-10-18 00:06:40,335 INFO:   ✅ 完全相同
2025-10-18 00:06:40,335 INFO: 📊 PO 6100822325 統計: 相同=4, 衝突=0
2025-10-18 00:06:40,335 INFO: ⏭️ 跳過 PO 6100817457 的正常比對 (有分批問題)
2025-10-18 00:06:40,335 INFO: 🚨 發現 2 個項目筆數不符
2025-10-18 00:06:40,335 INFO: ✅ 同時處理了 1 個正常 PO
2025-10-18 00:06:40,336 INFO: 127.0.0.1 - - [18/Oct/2025 00:06:40] "POST /api/save_csv HTTP/1.1" 200 -
2025-10-18 00:06:45,773 INFO: 127.0.0.1 - - [18/Oct/2025 00:06:45] "OPTIONS /api/save_override_all HTTP/1.1" 200 -
2025-10-18 00:06:45,790 INFO: 總資料筆數: 390, 有效資料(狀態=V): 329
2025-10-18 00:06:45,791 INFO: 
================================================================================
2025-10-18 00:06:45,791 INFO: 開始處理資料比對 (Version 31 - 品名優先)
2025-10-18 00:06:45,791 INFO: ================================================================================
2025-10-18 00:06:45,791 INFO: 
[第 1 筆]
2025-10-18 00:06:45,791 INFO:   新資料 => PO: 6100822325, Item: 0010
2025-10-18 00:06:45,791 INFO:   品名: SMC KQ2H06-00A 快速接頭
2025-10-18 00:06:45,792 INFO:      在 PO 6100822325 找到 4 筆資料
2025-10-18 00:06:45,792 INFO:      品名相似度排名：
2025-10-18 00:06:45,792 INFO:        1. Item 0010: 100.0% [Item相同] - SMC KQ2H06-00A 快速接頭...
2025-10-18 00:06:45,792 INFO:        2. Item 0020: 51.3% - SMC TU0604B-100 AIR管...
2025-10-18 00:06:45,792 INFO:        3. Item 0040: 51.3% - SMC TU1065B-100 AIR管...
2025-10-18 00:06:45,792 INFO:   ✅ 品名完全相同且 Item 相同（相似度 100.0%） => 直接更新
2025-10-18 00:06:45,793 INFO: 
[第 2 筆]
2025-10-18 00:06:45,793 INFO:   新資料 => PO: 6100822325, Item: 0020
2025-10-18 00:06:45,793 INFO:   品名: SMC TU0604B-100 AIR管
2025-10-18 00:06:45,794 INFO:      在 PO 6100822325 找到 4 筆資料
2025-10-18 00:06:45,794 INFO:      品名相似度排名：
2025-10-18 00:06:45,794 INFO:        1. Item 0020: 100.0% [Item相同] - SMC TU0604B-100 AIR管...
2025-10-18 00:06:45,794 INFO:        2. Item 0030: 90.0% - SMC TU0805B-100 AIR管...
2025-10-18 00:06:45,794 INFO:        3. Item 0040: 90.0% - SMC TU1065B-100 AIR管...
2025-10-18 00:06:45,794 INFO:   ✅ 品名完全相同且 Item 相同（相似度 100.0%） => 直接更新
2025-10-18 00:06:45,794 INFO: 
[第 3 筆]
2025-10-18 00:06:45,794 INFO:   新資料 => PO: 6100822325, Item: 0030
2025-10-18 00:06:45,794 INFO:   品名: SMC TU0805B-100 AIR管
2025-10-18 00:06:45,795 INFO:      在 PO 6100822325 找到 4 筆資料
2025-10-18 00:06:45,795 INFO:      品名相似度排名：
2025-10-18 00:06:45,795 INFO:        1. Item 0030: 100.0% [Item相同] - SMC TU0805B-100 AIR管...
2025-10-18 00:06:45,795 INFO:        2. Item 0020: 90.0% - SMC TU0604B-100 AIR管...
2025-10-18 00:06:45,796 INFO:        3. Item 0040: 90.0% - SMC TU1065B-100 AIR管...
2025-10-18 00:06:45,796 INFO:   ✅ 品名完全相同且 Item 相同（相似度 100.0%） => 直接更新
2025-10-18 00:06:45,796 INFO: 
[第 4 筆]
2025-10-18 00:06:45,796 INFO:   新資料 => PO: 6100822325, Item: 0040
2025-10-18 00:06:45,796 INFO:   品名: SMC TU1065B-100 AIR管
2025-10-18 00:06:45,797 INFO:      在 PO 6100822325 找到 4 筆資料
2025-10-18 00:06:45,797 INFO:      品名相似度排名：
2025-10-18 00:06:45,797 INFO:        1. Item 0040: 100.0% [Item相同] - SMC TU1065B-100 AIR管...
2025-10-18 00:06:45,797 INFO:        2. Item 0020: 90.0% - SMC TU0604B-100 AIR管...
2025-10-18 00:06:45,797 INFO:        3. Item 0030: 90.0% - SMC TU0805B-100 AIR管...
2025-10-18 00:06:45,797 INFO:   ✅ 品名完全相同且 Item 相同（相似度 100.0%） => 直接更新
2025-10-18 00:06:45,798 INFO: 
================================================================================
2025-10-18 00:06:45,798 INFO: 比對結果摘要 (Version 31 - 品名優先)
2025-10-18 00:06:45,798 INFO: ================================================================================
2025-10-18 00:06:45,798 INFO: 總處理筆數: 4
2025-10-18 00:06:45,798 INFO: 更新筆數: 4
2025-10-18 00:06:45,798 INFO: 新增筆數: 0
2025-10-18 00:06:45,798 INFO: 失敗筆數: 0
2025-10-18 00:06:45,798 INFO: 待確認筆數: 0
2025-10-18 00:06:45,798 INFO: 自動更新筆數: 4
2025-10-18 00:06:45,798 INFO: 
詳細比對結果:
2025-10-18 00:06:45,798 INFO: --------------------------------------------------------------------------------
2025-10-18 00:06:45,798 INFO: 筆數    PO No.          Item       比對方式                 處理       備註
2025-10-18 00:06:45,798 INFO: --------------------------------------------------------------------------------
2025-10-18 00:06:45,798 INFO: 1     6100822325      0010       品名完全相同+Item相同        已更新      
2025-10-18 00:06:45,798 INFO: 2     6100822325      0020       品名完全相同+Item相同        已更新      
2025-10-18 00:06:45,798 INFO: 3     6100822325      0030       品名完全相同+Item相同        已更新      
2025-10-18 00:06:45,798 INFO: 4     6100822325      0040       品名完全相同+Item相同        已更新      
2025-10-18 00:06:45,798 INFO: ================================================================================

2025-10-18 00:06:45,806 INFO: 127.0.0.1 - - [18/Oct/2025 00:06:45] "POST /api/save_override_all HTTP/1.1" 200 -
2025-10-18 00:07:50,471 INFO: 127.0.0.1 - - [18/Oct/2025 00:07:50] "OPTIONS /api/confirm_quantity_update HTTP/1.1" 200 -
2025-10-18 00:07:50,484 INFO: ================================================================================
2025-10-18 00:07:50,484 INFO: 🚀 confirm_quantity_update 函數被調用
2025-10-18 00:07:50,484 INFO: ================================================================================
2025-10-18 00:07:50,484 INFO: 📥 收到的完整資料: {
  "po_no": "6100817457",
  "item": "0010",
  "rows": [
    {
      "delivery": "2025/10/15",
      "description": "CIM K25-8F 手臂整合 Fork 特仕版",
      "sod_qty": "1"
    },
    {
      "delivery": "2025/11/11",
      "description": "CIM K25-8F 手臂整合 Fork 特仕版",
      "sod_qty": "1"
    }
  ],
  "expected_total": 0
}
2025-10-18 00:07:50,484 INFO: 📦 解析後的參數:
2025-10-18 00:07:50,484 INFO:    PO No: 6100817457
2025-10-18 00:07:50,484 INFO:    Item: 0010
2025-10-18 00:07:50,484 INFO:    新筆數: 2
2025-10-18 00:07:50,484 INFO:    預期總和: 0
2025-10-18 00:07:50,486 INFO: 📂 開始載入 static/data/Buyer_detail.csv
2025-10-18 00:07:50,503 INFO: ✅ 成功載入 Buyer_detail.csv,共 390 筆資料
2025-10-18 00:07:50,504 INFO: 🔢 SOD 總和計算:
2025-10-18 00:07:50,504 INFO:    預期: 0
2025-10-18 00:07:50,504 INFO:    實際: 2.0
2025-10-18 00:07:50,504 INFO:    差異: 2.0
2025-10-18 00:07:50,504 WARNING: ⚠️ SOD 總和不符!預期=0, 實際=2.0, 差異=2.0
2025-10-18 00:07:50,504 WARNING:    使用者選擇強制儲存,將繼續處理...
2025-10-18 00:07:50,504 INFO: 🔍 開始尋找要刪除的資料 (PO=6100817457, Item=0010, 狀態=V)
2025-10-18 00:07:50,506 INFO: 📊 找到 1 筆符合條件的資料
2025-10-18 00:07:50,506 INFO: 📋 取得第一筆舊資料作為範本
2025-10-18 00:07:50,507 INFO: 🗑️ 將刪除的資料:
2025-10-18 00:07:50,507 INFO:    第 1 筆: {'品項': 'CIM K25-8F 手臂整合 Fork 特仕版', '規格': '設備型號：AERJ2583_V1、包含零組件、安裝與測試工程', '單價': '47800', '總價': '95600', '交期': '', 'SOD': ''}
2025-10-18 00:07:50,507 INFO: 🗑️ 執行刪除操作...
2025-10-18 00:07:50,507 INFO: ✅ 刪除完成,剩餘 389 筆資料
2025-10-18 00:07:50,507 INFO: 💰 原始單價: 47800.0
2025-10-18 00:07:50,507 INFO: ➕ 開始準備新資料...
2025-10-18 00:07:50,507 INFO:    處理第 1/2 筆新資料...
2025-10-18 00:07:50,508 INFO:       品項: CIM K25-8F 手臂整合 Fork 特仕版, SOD: 1, 總價: 47800
2025-10-18 00:07:50,508 INFO:    處理第 2/2 筆新資料...
2025-10-18 00:07:50,508 INFO:       品項: CIM K25-8F 手臂整合 Fork 特仕版, SOD: 1, 總價: 47800
2025-10-18 00:07:50,508 INFO: ✅ 準備完成 2 筆新資料
2025-10-18 00:07:50,508 INFO: 📥 將新資料添加到最後...
2025-10-18 00:07:50,511 INFO: ✅ 添加完成,現有 391 筆資料
2025-10-18 00:07:50,511 INFO: 💾 開始儲存到 static/data/Buyer_detail.csv...
2025-10-18 00:07:50,518 INFO: ✅ 儲存完成
2025-10-18 00:07:50,519 INFO: ================================================================================
2025-10-18 00:07:50,519 INFO: ✅ 成功更新 PO 6100817457 Item 0010: 刪除 1 筆,新增 2 筆 (已加到最後) (⚠️ SOD差異: +2.00)
2025-10-18 00:07:50,519 INFO: ================================================================================
2025-10-18 00:07:50,520 INFO: ✅ 已刪除: uploads\6100817457.csv
2025-10-18 00:07:50,520 INFO: 127.0.0.1 - - [18/Oct/2025 00:07:50] "POST /api/confirm_quantity_update HTTP/1.1" 200 -
2025-10-18 00:07:50,535 INFO: 127.0.0.1 - - [18/Oct/2025 00:07:50] "OPTIONS /api/confirm_quantity_update HTTP/1.1" 200 -
2025-10-18 00:07:50,549 INFO: ================================================================================
2025-10-18 00:07:50,549 INFO: 🚀 confirm_quantity_update 函數被調用
2025-10-18 00:07:50,549 INFO: ================================================================================
2025-10-18 00:07:50,549 INFO: 📥 收到的完整資料: {
  "po_no": "6100817457",
  "item": "0020",
  "rows": [
    {
      "delivery": "2025/10/15",
      "description": "CIM K25-8F 新增設備護蓋加固補強",
      "sod_qty": "1"
    },
    {
      "delivery": "2025/11/11",
      "description": "CIM K25-8F 新增設備護蓋加固補強",
      "sod_qty": "1"
    }
  ],
  "expected_total": 0
}
2025-10-18 00:07:50,549 INFO: 📦 解析後的參數:
2025-10-18 00:07:50,550 INFO:    PO No: 6100817457
2025-10-18 00:07:50,550 INFO:    Item: 0020
2025-10-18 00:07:50,550 INFO:    新筆數: 2
2025-10-18 00:07:50,550 INFO:    預期總和: 0
2025-10-18 00:07:50,552 INFO: 📂 開始載入 static/data/Buyer_detail.csv
2025-10-18 00:07:50,589 INFO: ✅ 成功載入 Buyer_detail.csv,共 391 筆資料
2025-10-18 00:07:50,589 INFO: 🔢 SOD 總和計算:
2025-10-18 00:07:50,589 INFO:    預期: 0
2025-10-18 00:07:50,589 INFO:    實際: 2.0
2025-10-18 00:07:50,589 INFO:    差異: 2.0
2025-10-18 00:07:50,589 WARNING: ⚠️ SOD 總和不符!預期=0, 實際=2.0, 差異=2.0
2025-10-18 00:07:50,589 WARNING:    使用者選擇強制儲存,將繼續處理...
2025-10-18 00:07:50,589 INFO: 🔍 開始尋找要刪除的資料 (PO=6100817457, Item=0020, 狀態=V)
2025-10-18 00:07:50,592 INFO: 📊 找到 1 筆符合條件的資料
2025-10-18 00:07:50,592 INFO: 📋 取得第一筆舊資料作為範本
2025-10-18 00:07:50,593 INFO: 🗑️ 將刪除的資料:
2025-10-18 00:07:50,594 INFO:    第 1 筆: {'品項': 'CIM K25-8F 新增設備護蓋加固補強', '規格': '包含零組件、安裝與測試工程', '單價': '12600', '總價': '25200', '交期': '', 'SOD': ''}
2025-10-18 00:07:50,594 INFO: 🗑️ 執行刪除操作...
2025-10-18 00:07:50,595 INFO: ✅ 刪除完成,剩餘 390 筆資料
2025-10-18 00:07:50,595 INFO: 💰 原始單價: 12600.0
2025-10-18 00:07:50,595 INFO: ➕ 開始準備新資料...
2025-10-18 00:07:50,595 INFO:    處理第 1/2 筆新資料...
2025-10-18 00:07:50,595 INFO:       品項: CIM K25-8F 新增設備護蓋加固補強, SOD: 1, 總價: 12600
2025-10-18 00:07:50,595 INFO:    處理第 2/2 筆新資料...
2025-10-18 00:07:50,596 INFO:       品項: CIM K25-8F 新增設備護蓋加固補強, SOD: 1, 總價: 12600
2025-10-18 00:07:50,596 INFO: ✅ 準備完成 2 筆新資料
2025-10-18 00:07:50,596 INFO: 📥 將新資料添加到最後...
2025-10-18 00:07:50,597 INFO: ✅ 添加完成,現有 392 筆資料
2025-10-18 00:07:50,597 INFO: 💾 開始儲存到 static/data/Buyer_detail.csv...
2025-10-18 00:07:50,605 INFO: ✅ 儲存完成
2025-10-18 00:07:50,607 INFO: ================================================================================
2025-10-18 00:07:50,607 INFO: ✅ 成功更新 PO 6100817457 Item 0020: 刪除 1 筆,新增 2 筆 (已加到最後) (⚠️ SOD差異: +2.00)
2025-10-18 00:07:50,607 INFO: ================================================================================
2025-10-18 00:07:50,608 INFO: 127.0.0.1 - - [18/Oct/2025 00:07:50] "POST /api/confirm_quantity_update HTTP/1.1" 200 -
2025-10-18 00:09:56,934 INFO: 127.0.0.1 - - [18/Oct/2025 00:09:56] "GET /api/admins HTTP/1.1" 200 -
2025-10-18 00:09:56,976 INFO: 127.0.0.1 - - [18/Oct/2025 00:09:56] "GET /api/buyer_detail HTTP/1.1" 200 -
2025-10-18 00:09:57,043 INFO: 127.0.0.1 - - [18/Oct/2025 00:09:57] "GET /api/get_unaccounted_amount HTTP/1.1" 200 -
2025-10-18 00:09:57,359 INFO: 127.0.0.1 - - [18/Oct/2025 00:09:57] "GET /api/accounting_summary HTTP/1.1" 200 -
2025-10-18 00:09:57,433 INFO: 127.0.0.1 - - [18/Oct/2025 00:09:57] "GET /api/monthly_actual_accounting HTTP/1.1" 200 -
2025-10-18 00:09:57,463 INFO: 127.0.0.1 - - [18/Oct/2025 00:09:57] "GET /api/getrestofmoney HTTP/1.1" 200 -
2025-10-20 18:35:22,386 INFO: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-10-20 18:35:22,386 INFO: [33mPress CTRL+C to quit[0m
2025-10-20 18:35:22,389 INFO:  * Restarting with stat
2025-10-20 18:35:23,237 WARNING:  * Debugger is active!
2025-10-20 18:35:23,239 INFO:  * Debugger PIN: 509-008-513
2025-10-20 18:36:52,711 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:52] "OPTIONS /api/getAllLoginer HTTP/1.1" 200 -
2025-10-20 18:36:52,725 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:52] "POST /api/getAllLoginer HTTP/1.1" 200 -
2025-10-20 18:36:52,742 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:52] "OPTIONS /api/login HTTP/1.1" 200 -
2025-10-20 18:36:52,758 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:52] "POST /api/login HTTP/1.1" 200 -
2025-10-20 18:36:53,615 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:53] "GET /api/unordered-count HTTP/1.1" 200 -
2025-10-20 18:36:53,673 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:53] "GET /api/requesters HTTP/1.1" 200 -
2025-10-20 18:36:53,833 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:53] "GET /api/admins HTTP/1.1" 200 -
2025-10-20 18:36:54,091 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:54] "GET /api/venders HTTP/1.1" 200 -
2025-10-20 18:36:54,116 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:54] "GET /api/get-filters-json/K18251 HTTP/1.1" 200 -
2025-10-20 18:36:54,183 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:54] "GET /api/getrestofmoney HTTP/1.1" 200 -
2025-10-20 18:36:54,197 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:54] "GET /data HTTP/1.1" 200 -
2025-10-20 18:36:54,702 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:54] "OPTIONS /api/save-filters-json HTTP/1.1" 200 -
2025-10-20 18:36:54,721 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:54] "POST /api/save-filters-json HTTP/1.1" 200 -
2025-10-20 18:36:57,533 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:57] "OPTIONS /api/save-filters-json HTTP/1.1" 200 -
2025-10-20 18:36:57,552 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:57] "POST /api/save-filters-json HTTP/1.1" 200 -
2025-10-20 18:36:58,421 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:58] "GET /api/unordered-count HTTP/1.1" 200 -
2025-10-20 18:36:58,442 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:58] "GET /api/requesters HTTP/1.1" 200 -
2025-10-20 18:36:58,461 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:58] "GET /api/admins HTTP/1.1" 200 -
2025-10-20 18:36:58,515 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:58] "GET /api/venders HTTP/1.1" 200 -
2025-10-20 18:36:58,922 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:58] "GET /api/get-filters-json/K18251 HTTP/1.1" 200 -
2025-10-20 18:36:59,017 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:59] "GET /data HTTP/1.1" 200 -
2025-10-20 18:36:59,030 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:59] "GET /api/getrestofmoney HTTP/1.1" 200 -
2025-10-20 18:36:59,456 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:59] "OPTIONS /api/save-filters-json HTTP/1.1" 200 -
2025-10-20 18:36:59,472 INFO: 127.0.0.1 - - [20/Oct/2025 18:36:59] "POST /api/save-filters-json HTTP/1.1" 200 -
2025-10-20 18:37:04,448 INFO: 127.0.0.1 - - [20/Oct/2025 18:37:04] "GET /api/admins HTTP/1.1" 200 -
2025-10-20 18:37:04,656 INFO: 127.0.0.1 - - [20/Oct/2025 18:37:04] "GET /api/buyer_detail HTTP/1.1" 200 -
2025-10-20 18:37:04,776 INFO: 127.0.0.1 - - [20/Oct/2025 18:37:04] "GET /api/get_unaccounted_amount HTTP/1.1" 200 -
2025-10-20 18:37:05,648 INFO: 127.0.0.1 - - [20/Oct/2025 18:37:05] "GET /api/accounting_summary HTTP/1.1" 200 -
2025-10-20 18:37:05,772 INFO: 127.0.0.1 - - [20/Oct/2025 18:37:05] "GET /api/monthly_actual_accounting HTTP/1.1" 200 -
2025-10-20 18:37:05,855 INFO: 127.0.0.1 - - [20/Oct/2025 18:37:05] "GET /api/getrestofmoney HTTP/1.1" 200 -
2025-10-20 18:38:04,354 INFO: 127.0.0.1 - - [20/Oct/2025 18:38:04] "OPTIONS /api/save_csv HTTP/1.1" 200 -
2025-10-20 18:38:04,379 INFO: ✅ 已儲存 uploads/6100822325.csv (4 筆資料)
2025-10-20 18:38:04,383 INFO: ✅ 已儲存 uploads/6100817457.csv (2 筆資料)
2025-10-20 18:38:04,401 INFO: 總資料筆數: 392, 有效資料(狀態=V): 331
2025-10-20 18:38:04,422 INFO: 
================================================================================
2025-10-20 18:38:04,423 INFO: 第一輪掃描：檢測分批和合併問題
2025-10-20 18:38:04,423 INFO: ================================================================================
2025-10-20 18:38:04,504 INFO: 🔄 偵測到合併:PO=6100817457, Item=0010, XLS=1筆 < CSV=2筆
2025-10-20 18:38:04,508 INFO:    📝 已記錄需要合併的項目
2025-10-20 18:38:04,508 INFO: 🔄 偵測到合併:PO=6100817457, Item=0020, XLS=1筆 < CSV=2筆
2025-10-20 18:38:04,511 INFO:    📝 已記錄需要合併的項目
2025-10-20 18:38:04,511 INFO: 
📊 第一輪掃描結果:
2025-10-20 18:38:04,511 INFO:    分批問題 PO: 0 個 - []
2025-10-20 18:38:04,512 INFO:    合併問題 PO: 1 個 - ['6100817457']
2025-10-20 18:38:04,512 INFO: ================================================================================

2025-10-20 18:38:04,512 INFO: 
================================================================================
2025-10-20 18:38:04,512 INFO: 第二輪處理：正常比對（排除有問題的 PO）
2025-10-20 18:38:04,512 INFO: ================================================================================
2025-10-20 18:38:04,517 INFO: 處理 PO 6100822325 的 Item 0010
2025-10-20 18:38:04,518 INFO:   找到 Buyer Item 0010, 品名: SMC KQ2H06-00A 快速接頭
2025-10-20 18:38:04,520 INFO:   ✅ 完全相同
2025-10-20 18:38:04,520 INFO: 處理 PO 6100822325 的 Item 0020
2025-10-20 18:38:04,521 INFO:   找到 Buyer Item 0020, 品名: SMC TU0604B-100 AIR管
2025-10-20 18:38:04,522 INFO:   ✅ 完全相同
2025-10-20 18:38:04,522 INFO: 處理 PO 6100822325 的 Item 0030
2025-10-20 18:38:04,523 INFO:   找到 Buyer Item 0030, 品名: SMC TU0805B-100 AIR管
2025-10-20 18:38:04,524 INFO:   ✅ 完全相同
2025-10-20 18:38:04,524 INFO: 處理 PO 6100822325 的 Item 0040
2025-10-20 18:38:04,525 INFO:   找到 Buyer Item 0040, 品名: SMC TU1065B-100 AIR管
2025-10-20 18:38:04,526 INFO:   ✅ 完全相同
2025-10-20 18:38:04,526 INFO: 📊 PO 6100822325 統計: 相同=4, 衝突=0
2025-10-20 18:38:04,526 INFO: ⭕️ 跳過 PO 6100817457 的正常比對 (有合併問題)
2025-10-20 18:38:04,526 INFO: ================================================================================

2025-10-20 18:38:04,527 INFO: 🔄 發現 2 個項目需要合併
2025-10-20 18:38:04,527 INFO: 127.0.0.1 - - [20/Oct/2025 18:38:04] "POST /api/save_csv HTTP/1.1" 200 -
2025-10-20 18:38:06,554 INFO: 127.0.0.1 - - [20/Oct/2025 18:38:06] "OPTIONS /api/save_override_all HTTP/1.1" 200 -
2025-10-20 18:38:06,586 INFO: 總資料筆數: 392, 有效資料(狀態=V): 331
2025-10-20 18:38:06,587 INFO: 
================================================================================
2025-10-20 18:38:06,587 INFO: 開始處理資料比對 (Version 31 - 品名優先)
2025-10-20 18:38:06,587 INFO: ================================================================================
2025-10-20 18:38:06,587 INFO: 
[第 1 筆]
2025-10-20 18:38:06,587 INFO:   新資料 => PO: 6100822325, Item: 0010
2025-10-20 18:38:06,587 INFO:   品名: SMC KQ2H06-00A 快速接頭
2025-10-20 18:38:06,589 INFO:      在 PO 6100822325 找到 4 筆資料
2025-10-20 18:38:06,590 INFO:      品名相似度排名：
2025-10-20 18:38:06,590 INFO:        1. Item 0010: 100.0% [Item相同] - SMC KQ2H06-00A 快速接頭...
2025-10-20 18:38:06,590 INFO:        2. Item 0020: 51.3% - SMC TU0604B-100 AIR管...
2025-10-20 18:38:06,590 INFO:        3. Item 0040: 51.3% - SMC TU1065B-100 AIR管...
2025-10-20 18:38:06,590 INFO:   ✅ 品名完全相同且 Item 相同（相似度 100.0%） => 直接更新
2025-10-20 18:38:06,591 INFO: 
[第 2 筆]
2025-10-20 18:38:06,591 INFO:   新資料 => PO: 6100822325, Item: 0020
2025-10-20 18:38:06,591 INFO:   品名: SMC TU0604B-100 AIR管
2025-10-20 18:38:06,592 INFO:      在 PO 6100822325 找到 4 筆資料
2025-10-20 18:38:06,593 INFO:      品名相似度排名：
2025-10-20 18:38:06,593 INFO:        1. Item 0020: 100.0% [Item相同] - SMC TU0604B-100 AIR管...
2025-10-20 18:38:06,593 INFO:        2. Item 0030: 90.0% - SMC TU0805B-100 AIR管...
2025-10-20 18:38:06,593 INFO:        3. Item 0040: 90.0% - SMC TU1065B-100 AIR管...
2025-10-20 18:38:06,593 INFO:   ✅ 品名完全相同且 Item 相同（相似度 100.0%） => 直接更新
2025-10-20 18:38:06,594 INFO: 
[第 3 筆]
2025-10-20 18:38:06,594 INFO:   新資料 => PO: 6100822325, Item: 0030
2025-10-20 18:38:06,594 INFO:   品名: SMC TU0805B-100 AIR管
2025-10-20 18:38:06,595 INFO:      在 PO 6100822325 找到 4 筆資料
2025-10-20 18:38:06,596 INFO:      品名相似度排名：
2025-10-20 18:38:06,596 INFO:        1. Item 0030: 100.0% [Item相同] - SMC TU0805B-100 AIR管...
2025-10-20 18:38:06,596 INFO:        2. Item 0020: 90.0% - SMC TU0604B-100 AIR管...
2025-10-20 18:38:06,596 INFO:        3. Item 0040: 90.0% - SMC TU1065B-100 AIR管...
2025-10-20 18:38:06,596 INFO:   ✅ 品名完全相同且 Item 相同（相似度 100.0%） => 直接更新
2025-10-20 18:38:06,597 INFO: 
[第 4 筆]
2025-10-20 18:38:06,597 INFO:   新資料 => PO: 6100822325, Item: 0040
2025-10-20 18:38:06,597 INFO:   品名: SMC TU1065B-100 AIR管
2025-10-20 18:38:06,598 INFO:      在 PO 6100822325 找到 4 筆資料
2025-10-20 18:38:06,599 INFO:      品名相似度排名：
2025-10-20 18:38:06,599 INFO:        1. Item 0040: 100.0% [Item相同] - SMC TU1065B-100 AIR管...
2025-10-20 18:38:06,599 INFO:        2. Item 0020: 90.0% - SMC TU0604B-100 AIR管...
2025-10-20 18:38:06,599 INFO:        3. Item 0030: 90.0% - SMC TU0805B-100 AIR管...
2025-10-20 18:38:06,599 INFO:   ✅ 品名完全相同且 Item 相同（相似度 100.0%） => 直接更新
2025-10-20 18:38:06,600 INFO: 
================================================================================
2025-10-20 18:38:06,600 INFO: 比對結果摘要 (Version 31 - 品名優先)
2025-10-20 18:38:06,600 INFO: ================================================================================
2025-10-20 18:38:06,600 INFO: 總處理筆數: 4
2025-10-20 18:38:06,600 INFO: 更新筆數: 4
2025-10-20 18:38:06,600 INFO: 新增筆數: 0
2025-10-20 18:38:06,600 INFO: 失敗筆數: 0
2025-10-20 18:38:06,600 INFO: 待確認筆數: 0
2025-10-20 18:38:06,600 INFO: 自動更新筆數: 4
2025-10-20 18:38:06,600 INFO: 
詳細比對結果:
2025-10-20 18:38:06,601 INFO: --------------------------------------------------------------------------------
2025-10-20 18:38:06,601 INFO: 筆數    PO No.          Item       比對方式                 處理       備註
2025-10-20 18:38:06,601 INFO: --------------------------------------------------------------------------------
2025-10-20 18:38:06,601 INFO: 1     6100822325      0010       品名完全相同+Item相同        已更新      
2025-10-20 18:38:06,601 INFO: 2     6100822325      0020       品名完全相同+Item相同        已更新      
2025-10-20 18:38:06,601 INFO: 3     6100822325      0030       品名完全相同+Item相同        已更新      
2025-10-20 18:38:06,601 INFO: 4     6100822325      0040       品名完全相同+Item相同        已更新      
2025-10-20 18:38:06,601 INFO: ================================================================================

2025-10-20 18:38:06,612 INFO: 127.0.0.1 - - [20/Oct/2025 18:38:06] "POST /api/save_override_all HTTP/1.1" 200 -
2025-10-20 18:38:14,267 INFO: 127.0.0.1 - - [20/Oct/2025 18:38:14] "OPTIONS /api/confirm_merge HTTP/1.1" 200 -
2025-10-20 18:38:14,281 INFO: ================================================================================
2025-10-20 18:38:14,281 INFO: 🔄 confirm_merge 函數被調用
2025-10-20 18:38:14,281 INFO: ================================================================================
2025-10-20 18:38:14,281 INFO: 📥 收到的完整資料: {
  "po_no": "6100817457",
  "item": "0010",
  "xls_data": [
    {
      "delivery": "2025/10/15",
      "description": "CIM K25-8F 手臂整合 Fork 特仕版",
      "sod_qty": "2"
    }
  ]
}
2025-10-20 18:38:14,281 INFO: 📦 解析後的參數:
2025-10-20 18:38:14,282 INFO:    PO No: 6100817457
2025-10-20 18:38:14,282 INFO:    Item: 0010
2025-10-20 18:38:14,282 INFO:    新筆數: 1
2025-10-20 18:38:14,283 INFO: 📂 開始載入 static/data/Buyer_detail.csv
2025-10-20 18:38:14,300 INFO: ✅ 成功載入 Buyer_detail.csv,共 392 筆資料
2025-10-20 18:38:14,301 INFO: 🔍 開始尋找要刪除的資料 (PO=6100817457, Item=0010, 備註包含'分批', 狀態=V)
2025-10-20 18:38:14,304 INFO: 📊 找到 2 筆符合條件的資料
2025-10-20 18:38:14,304 INFO: 📋 取得第一筆舊資料作為範本
2025-10-20 18:38:14,305 INFO: 🗑️ 將刪除的資料:
2025-10-20 18:38:14,305 INFO:    第 1 筆: {'品項': 'CIM K25-8F 手臂整合 Fork 特仕版', '交期': '2025/10/15', 'SOD': '1', '備註': '分批1/2'}
2025-10-20 18:38:14,305 INFO:    第 2 筆: {'品項': 'CIM K25-8F 手臂整合 Fork 特仕版', '交期': '2025/11/11', 'SOD': '1', '備註': '分批2/2'}
2025-10-20 18:38:14,305 INFO: 🗑️ 執行刪除操作...
2025-10-20 18:38:14,306 INFO: ✅ 刪除完成,剩餘 390 筆資料
2025-10-20 18:38:14,306 INFO: 💰 原始單價: 47800.0
2025-10-20 18:38:14,306 INFO: ➕ 開始準備新資料...
2025-10-20 18:38:14,306 INFO:    處理第 1/1 筆新資料...
2025-10-20 18:38:14,306 INFO:       品項: CIM K25-8F 手臂整合 Fork 特仕版, SOD: 2, 總價: 95600
2025-10-20 18:38:14,307 INFO: ✅ 準備完成 1 筆新資料
2025-10-20 18:38:14,307 INFO: 🔥 將新資料添加到最後...
2025-10-20 18:38:14,310 INFO: ✅ 添加完成,現有 391 筆資料
2025-10-20 18:38:14,311 INFO: 💾 開始儲存到 static/data/Buyer_detail.csv...
2025-10-20 18:38:14,319 INFO: ✅ 儲存完成
2025-10-20 18:38:14,320 INFO: ================================================================================
2025-10-20 18:38:14,320 INFO: ✅ 成功合併 PO 6100817457 Item 0010: 刪除 2 筆分批資料,新增 1 筆合併資料
2025-10-20 18:38:14,320 INFO: ================================================================================
2025-10-20 18:38:14,320 INFO: ✅ 已刪除: uploads\6100817457.csv
2025-10-20 18:38:14,321 INFO: 127.0.0.1 - - [20/Oct/2025 18:38:14] "POST /api/confirm_merge HTTP/1.1" 200 -
2025-10-20 18:38:14,643 INFO: 127.0.0.1 - - [20/Oct/2025 18:38:14] "OPTIONS /api/confirm_merge HTTP/1.1" 200 -
2025-10-20 18:38:14,659 INFO: ================================================================================
2025-10-20 18:38:14,660 INFO: 🔄 confirm_merge 函數被調用
2025-10-20 18:38:14,660 INFO: ================================================================================
2025-10-20 18:38:14,660 INFO: 📥 收到的完整資料: {
  "po_no": "6100817457",
  "item": "0020",
  "xls_data": [
    {
      "delivery": "2025/11/1",
      "description": "CIM K25-8F 新增設備護蓋加固補強",
      "sod_qty": "2"
    }
  ]
}
2025-10-20 18:38:14,661 INFO: 📦 解析後的參數:
2025-10-20 18:38:14,661 INFO:    PO No: 6100817457
2025-10-20 18:38:14,661 INFO:    Item: 0020
2025-10-20 18:38:14,661 INFO:    新筆數: 1
2025-10-20 18:38:14,663 INFO: 📂 開始載入 static/data/Buyer_detail.csv
2025-10-20 18:38:14,679 INFO: ✅ 成功載入 Buyer_detail.csv,共 391 筆資料
2025-10-20 18:38:14,679 INFO: 🔍 開始尋找要刪除的資料 (PO=6100817457, Item=0020, 備註包含'分批', 狀態=V)
2025-10-20 18:38:14,682 INFO: 📊 找到 2 筆符合條件的資料
2025-10-20 18:38:14,682 INFO: 📋 取得第一筆舊資料作為範本
2025-10-20 18:38:14,683 INFO: 🗑️ 將刪除的資料:
2025-10-20 18:38:14,683 INFO:    第 1 筆: {'品項': 'CIM K25-8F 新增設備護蓋加固補強', '交期': '2025/10/15', 'SOD': '1', '備註': '分批1/2'}
2025-10-20 18:38:14,683 INFO:    第 2 筆: {'品項': 'CIM K25-8F 新增設備護蓋加固補強', '交期': '2025/11/11', 'SOD': '1', '備註': '分批2/2'}
2025-10-20 18:38:14,683 INFO: 🗑️ 執行刪除操作...
2025-10-20 18:38:14,684 INFO: ✅ 刪除完成,剩餘 389 筆資料
2025-10-20 18:38:14,684 INFO: 💰 原始單價: 12600.0
2025-10-20 18:38:14,684 INFO: ➕ 開始準備新資料...
2025-10-20 18:38:14,685 INFO:    處理第 1/1 筆新資料...
2025-10-20 18:38:14,685 INFO:       品項: CIM K25-8F 新增設備護蓋加固補強, SOD: 2, 總價: 25200
2025-10-20 18:38:14,685 INFO: ✅ 準備完成 1 筆新資料
2025-10-20 18:38:14,685 INFO: 🔥 將新資料添加到最後...
2025-10-20 18:38:14,687 INFO: ✅ 添加完成,現有 390 筆資料
2025-10-20 18:38:14,687 INFO: 💾 開始儲存到 static/data/Buyer_detail.csv...
2025-10-20 18:38:14,696 INFO: ✅ 儲存完成
2025-10-20 18:38:14,698 INFO: ================================================================================
2025-10-20 18:38:14,698 INFO: ✅ 成功合併 PO 6100817457 Item 0020: 刪除 2 筆分批資料,新增 1 筆合併資料
2025-10-20 18:38:14,698 INFO: ================================================================================
2025-10-20 18:38:14,699 INFO: 127.0.0.1 - - [20/Oct/2025 18:38:14] "POST /api/confirm_merge HTTP/1.1" 200 -
2025-10-20 18:38:39,210 INFO: 127.0.0.1 - - [20/Oct/2025 18:38:39] "OPTIONS /api/save_csv HTTP/1.1" 200 -
2025-10-20 18:38:39,232 INFO: ✅ 已儲存 uploads/6100822325.csv (4 筆資料)
2025-10-20 18:38:39,234 INFO: ✅ 已儲存 uploads/6100817457.csv (4 筆資料)
2025-10-20 18:38:39,253 INFO: 總資料筆數: 390, 有效資料(狀態=V): 329
2025-10-20 18:38:39,275 INFO: 
================================================================================
2025-10-20 18:38:39,275 INFO: 第一輪掃描：檢測分批和合併問題
2025-10-20 18:38:39,275 INFO: ================================================================================
2025-10-20 18:38:39,323 INFO: ⚠️ 筆數不符: PO=6100817457, Item=0010, XLS=2筆, CSV=1筆
2025-10-20 18:38:39,325 INFO: ⚠️ 筆數不符: PO=6100817457, Item=0020, XLS=2筆, CSV=1筆
2025-10-20 18:38:39,325 INFO: 
📊 第一輪掃描結果:
2025-10-20 18:38:39,325 INFO:    分批問題 PO: 1 個 - ['6100817457']
2025-10-20 18:38:39,325 INFO:    合併問題 PO: 0 個 - []
2025-10-20 18:38:39,325 INFO: ================================================================================

2025-10-20 18:38:39,325 INFO: 
================================================================================
2025-10-20 18:38:39,325 INFO: 第二輪處理：正常比對（排除有問題的 PO）
2025-10-20 18:38:39,325 INFO: ================================================================================
2025-10-20 18:38:39,331 INFO: 處理 PO 6100822325 的 Item 0010
2025-10-20 18:38:39,332 INFO:   找到 Buyer Item 0010, 品名: SMC KQ2H06-00A 快速接頭
2025-10-20 18:38:39,333 INFO:   ✅ 完全相同
2025-10-20 18:38:39,333 INFO: 處理 PO 6100822325 的 Item 0020
2025-10-20 18:38:39,334 INFO:   找到 Buyer Item 0020, 品名: SMC TU0604B-100 AIR管
2025-10-20 18:38:39,335 INFO:   ✅ 完全相同
2025-10-20 18:38:39,336 INFO: 處理 PO 6100822325 的 Item 0030
2025-10-20 18:38:39,336 INFO:   找到 Buyer Item 0030, 品名: SMC TU0805B-100 AIR管
2025-10-20 18:38:39,337 INFO:   ✅ 完全相同
2025-10-20 18:38:39,338 INFO: 處理 PO 6100822325 的 Item 0040
2025-10-20 18:38:39,338 INFO:   找到 Buyer Item 0040, 品名: SMC TU1065B-100 AIR管
2025-10-20 18:38:39,339 INFO:   ✅ 完全相同
2025-10-20 18:38:39,339 INFO: 📊 PO 6100822325 統計: 相同=4, 衝突=0
2025-10-20 18:38:39,340 INFO: ⭕️ 跳過 PO 6100817457 的正常比對 (有分批問題)
2025-10-20 18:38:39,340 INFO: ================================================================================

2025-10-20 18:38:39,340 INFO: 🚨 發現 2 個項目筆數不符
2025-10-20 18:38:39,340 INFO: ✅ 同時處理了 1 個正常 PO
2025-10-20 18:38:39,341 INFO: 127.0.0.1 - - [20/Oct/2025 18:38:39] "POST /api/save_csv HTTP/1.1" 200 -
2025-10-20 18:38:41,245 INFO: 127.0.0.1 - - [20/Oct/2025 18:38:41] "OPTIONS /api/save_override_all HTTP/1.1" 200 -
2025-10-20 18:38:41,275 INFO: 總資料筆數: 390, 有效資料(狀態=V): 329
2025-10-20 18:38:41,276 INFO: 
================================================================================
2025-10-20 18:38:41,276 INFO: 開始處理資料比對 (Version 31 - 品名優先)
2025-10-20 18:38:41,276 INFO: ================================================================================
2025-10-20 18:38:41,276 INFO: 
[第 1 筆]
2025-10-20 18:38:41,276 INFO:   新資料 => PO: 6100822325, Item: 0010
2025-10-20 18:38:41,276 INFO:   品名: SMC KQ2H06-00A 快速接頭
2025-10-20 18:38:41,278 INFO:      在 PO 6100822325 找到 4 筆資料
2025-10-20 18:38:41,279 INFO:      品名相似度排名：
2025-10-20 18:38:41,279 INFO:        1. Item 0010: 100.0% [Item相同] - SMC KQ2H06-00A 快速接頭...
2025-10-20 18:38:41,279 INFO:        2. Item 0020: 51.3% - SMC TU0604B-100 AIR管...
2025-10-20 18:38:41,279 INFO:        3. Item 0040: 51.3% - SMC TU1065B-100 AIR管...
2025-10-20 18:38:41,279 INFO:   ✅ 品名完全相同且 Item 相同（相似度 100.0%） => 直接更新
2025-10-20 18:38:41,280 INFO: 
[第 2 筆]
2025-10-20 18:38:41,280 INFO:   新資料 => PO: 6100822325, Item: 0020
2025-10-20 18:38:41,280 INFO:   品名: SMC TU0604B-100 AIR管
2025-10-20 18:38:41,281 INFO:      在 PO 6100822325 找到 4 筆資料
2025-10-20 18:38:41,282 INFO:      品名相似度排名：
2025-10-20 18:38:41,282 INFO:        1. Item 0020: 100.0% [Item相同] - SMC TU0604B-100 AIR管...
2025-10-20 18:38:41,282 INFO:        2. Item 0030: 90.0% - SMC TU0805B-100 AIR管...
2025-10-20 18:38:41,282 INFO:        3. Item 0040: 90.0% - SMC TU1065B-100 AIR管...
2025-10-20 18:38:41,282 INFO:   ✅ 品名完全相同且 Item 相同（相似度 100.0%） => 直接更新
2025-10-20 18:38:41,283 INFO: 
[第 3 筆]
2025-10-20 18:38:41,283 INFO:   新資料 => PO: 6100822325, Item: 0030
2025-10-20 18:38:41,283 INFO:   品名: SMC TU0805B-100 AIR管
2025-10-20 18:38:41,284 INFO:      在 PO 6100822325 找到 4 筆資料
2025-10-20 18:38:41,285 INFO:      品名相似度排名：
2025-10-20 18:38:41,285 INFO:        1. Item 0030: 100.0% [Item相同] - SMC TU0805B-100 AIR管...
2025-10-20 18:38:41,285 INFO:        2. Item 0020: 90.0% - SMC TU0604B-100 AIR管...
2025-10-20 18:38:41,285 INFO:        3. Item 0040: 90.0% - SMC TU1065B-100 AIR管...
2025-10-20 18:38:41,286 INFO:   ✅ 品名完全相同且 Item 相同（相似度 100.0%） => 直接更新
2025-10-20 18:38:41,286 INFO: 
[第 4 筆]
2025-10-20 18:38:41,286 INFO:   新資料 => PO: 6100822325, Item: 0040
2025-10-20 18:38:41,286 INFO:   品名: SMC TU1065B-100 AIR管
2025-10-20 18:38:41,287 INFO:      在 PO 6100822325 找到 4 筆資料
2025-10-20 18:38:41,288 INFO:      品名相似度排名：
2025-10-20 18:38:41,288 INFO:        1. Item 0040: 100.0% [Item相同] - SMC TU1065B-100 AIR管...
2025-10-20 18:38:41,288 INFO:        2. Item 0020: 90.0% - SMC TU0604B-100 AIR管...
2025-10-20 18:38:41,288 INFO:        3. Item 0030: 90.0% - SMC TU0805B-100 AIR管...
2025-10-20 18:38:41,288 INFO:   ✅ 品名完全相同且 Item 相同（相似度 100.0%） => 直接更新
2025-10-20 18:38:41,289 INFO: 
================================================================================
2025-10-20 18:38:41,289 INFO: 比對結果摘要 (Version 31 - 品名優先)
2025-10-20 18:38:41,289 INFO: ================================================================================
2025-10-20 18:38:41,289 INFO: 總處理筆數: 4
2025-10-20 18:38:41,289 INFO: 更新筆數: 4
2025-10-20 18:38:41,289 INFO: 新增筆數: 0
2025-10-20 18:38:41,289 INFO: 失敗筆數: 0
2025-10-20 18:38:41,289 INFO: 待確認筆數: 0
2025-10-20 18:38:41,289 INFO: 自動更新筆數: 4
2025-10-20 18:38:41,289 INFO: 
詳細比對結果:
2025-10-20 18:38:41,290 INFO: --------------------------------------------------------------------------------
2025-10-20 18:38:41,290 INFO: 筆數    PO No.          Item       比對方式                 處理       備註
2025-10-20 18:38:41,290 INFO: --------------------------------------------------------------------------------
2025-10-20 18:38:41,290 INFO: 1     6100822325      0010       品名完全相同+Item相同        已更新      
2025-10-20 18:38:41,290 INFO: 2     6100822325      0020       品名完全相同+Item相同        已更新      
2025-10-20 18:38:41,290 INFO: 3     6100822325      0030       品名完全相同+Item相同        已更新      
2025-10-20 18:38:41,290 INFO: 4     6100822325      0040       品名完全相同+Item相同        已更新      
2025-10-20 18:38:41,290 INFO: ================================================================================

2025-10-20 18:38:41,301 INFO: 127.0.0.1 - - [20/Oct/2025 18:38:41] "POST /api/save_override_all HTTP/1.1" 200 -
2025-10-20 18:38:47,201 INFO: 127.0.0.1 - - [20/Oct/2025 18:38:47] "OPTIONS /api/confirm_quantity_update HTTP/1.1" 200 -
2025-10-20 18:38:47,217 INFO: ================================================================================
2025-10-20 18:38:47,217 INFO: 🚀 confirm_quantity_update 函數被調用
2025-10-20 18:38:47,217 INFO: ================================================================================
2025-10-20 18:38:47,218 INFO: 📥 收到的完整資料: {
  "po_no": "6100817457",
  "item": "0010",
  "rows": [
    {
      "delivery": "2025/10/15",
      "description": "CIM K25-8F 手臂整合 Fork 特仕版",
      "sod_qty": "1"
    },
    {
      "delivery": "2025/11/11",
      "description": "CIM K25-8F 手臂整合 Fork 特仕版",
      "sod_qty": "1"
    }
  ],
  "expected_total": 2
}
2025-10-20 18:38:47,218 INFO: 📦 解析後的參數:
2025-10-20 18:38:47,218 INFO:    PO No: 6100817457
2025-10-20 18:38:47,218 INFO:    Item: 0010
2025-10-20 18:38:47,218 INFO:    新筆數: 2
2025-10-20 18:38:47,218 INFO:    預期總和: 2
2025-10-20 18:38:47,220 INFO: 📂 開始載入 static/data/Buyer_detail.csv
2025-10-20 18:38:47,234 INFO: ✅ 成功載入 Buyer_detail.csv,共 390 筆資料
2025-10-20 18:38:47,235 INFO: 🔢 SOD 總和計算:
2025-10-20 18:38:47,235 INFO:    預期: 2
2025-10-20 18:38:47,235 INFO:    實際: 2.0
2025-10-20 18:38:47,235 INFO:    差異: 0.0
2025-10-20 18:38:47,235 INFO: ✅ SOD 總和正確:2.0
2025-10-20 18:38:47,235 INFO: 🔍 開始尋找要刪除的資料 (PO=6100817457, Item=0010, 狀態=V)
2025-10-20 18:38:47,237 INFO: 📊 找到 1 筆符合條件的資料
2025-10-20 18:38:47,238 INFO: 📋 取得第一筆舊資料作為範本
2025-10-20 18:38:47,239 INFO: 🗑️ 將刪除的資料:
2025-10-20 18:38:47,239 INFO:    第 1 筆: {'品項': 'CIM K25-8F 手臂整合 Fork 特仕版', '規格': '設備型號：AERJ2583_V1、包含零組件、安裝與測試工程', '單價': '47800', '總價': '95600', '交期': '2025/10/15', 'SOD': '2'}
2025-10-20 18:38:47,239 INFO: 🗑️ 執行刪除操作...
2025-10-20 18:38:47,239 INFO: ✅ 刪除完成,剩餘 389 筆資料
2025-10-20 18:38:47,239 INFO: 💰 原始單價: 47800.0
2025-10-20 18:38:47,239 INFO: ➕ 開始準備新資料...
2025-10-20 18:38:47,240 INFO:    處理第 1/2 筆新資料...
2025-10-20 18:38:47,240 INFO:       品項: CIM K25-8F 手臂整合 Fork 特仕版, SOD: 1, 總價: 47800
2025-10-20 18:38:47,240 INFO:    處理第 2/2 筆新資料...
2025-10-20 18:38:47,240 INFO:       品項: CIM K25-8F 手臂整合 Fork 特仕版, SOD: 1, 總價: 47800
2025-10-20 18:38:47,240 INFO: ✅ 準備完成 2 筆新資料
2025-10-20 18:38:47,240 INFO: 📥 將新資料添加到最後...
2025-10-20 18:38:47,242 INFO: ✅ 添加完成,現有 391 筆資料
2025-10-20 18:38:47,242 INFO: 💾 開始儲存到 static/data/Buyer_detail.csv...
2025-10-20 18:38:47,253 INFO: ✅ 儲存完成
2025-10-20 18:38:47,254 INFO: ================================================================================
2025-10-20 18:38:47,254 INFO: ✅ 成功更新 PO 6100817457 Item 0010: 刪除 1 筆,新增 2 筆 (已加到最後)
2025-10-20 18:38:47,254 INFO: ================================================================================
2025-10-20 18:38:47,255 INFO: ✅ 已刪除: uploads\6100817457.csv
2025-10-20 18:38:47,256 INFO: 127.0.0.1 - - [20/Oct/2025 18:38:47] "POST /api/confirm_quantity_update HTTP/1.1" 200 -
2025-10-20 18:38:47,273 INFO: 127.0.0.1 - - [20/Oct/2025 18:38:47] "OPTIONS /api/confirm_quantity_update HTTP/1.1" 200 -
2025-10-20 18:38:47,292 INFO: ================================================================================
2025-10-20 18:38:47,292 INFO: 🚀 confirm_quantity_update 函數被調用
2025-10-20 18:38:47,292 INFO: ================================================================================
2025-10-20 18:38:47,293 INFO: 📥 收到的完整資料: {
  "po_no": "6100817457",
  "item": "0020",
  "rows": [
    {
      "delivery": "2025/10/15",
      "description": "CIM K25-8F 新增設備護蓋加固補強",
      "sod_qty": "1"
    },
    {
      "delivery": "2025/11/11",
      "description": "CIM K25-8F 新增設備護蓋加固補強",
      "sod_qty": "1"
    }
  ],
  "expected_total": 2
}
2025-10-20 18:38:47,293 INFO: 📦 解析後的參數:
2025-10-20 18:38:47,293 INFO:    PO No: 6100817457
2025-10-20 18:38:47,293 INFO:    Item: 0020
2025-10-20 18:38:47,293 INFO:    新筆數: 2
2025-10-20 18:38:47,293 INFO:    預期總和: 2
2025-10-20 18:38:47,294 INFO: 📂 開始載入 static/data/Buyer_detail.csv
2025-10-20 18:38:47,352 INFO: ✅ 成功載入 Buyer_detail.csv,共 391 筆資料
2025-10-20 18:38:47,352 INFO: 🔢 SOD 總和計算:
2025-10-20 18:38:47,352 INFO:    預期: 2
2025-10-20 18:38:47,352 INFO:    實際: 2.0
2025-10-20 18:38:47,352 INFO:    差異: 0.0
2025-10-20 18:38:47,352 INFO: ✅ SOD 總和正確:2.0
2025-10-20 18:38:47,352 INFO: 🔍 開始尋找要刪除的資料 (PO=6100817457, Item=0020, 狀態=V)
2025-10-20 18:38:47,354 INFO: 📊 找到 1 筆符合條件的資料
2025-10-20 18:38:47,355 INFO: 📋 取得第一筆舊資料作為範本
2025-10-20 18:38:47,356 INFO: 🗑️ 將刪除的資料:
2025-10-20 18:38:47,356 INFO:    第 1 筆: {'品項': 'CIM K25-8F 新增設備護蓋加固補強', '規格': '包含零組件、安裝與測試工程', '單價': '12600', '總價': '25200', '交期': '2025/11/1', 'SOD': '2'}
2025-10-20 18:38:47,356 INFO: 🗑️ 執行刪除操作...
2025-10-20 18:38:47,357 INFO: ✅ 刪除完成,剩餘 390 筆資料
2025-10-20 18:38:47,357 INFO: 💰 原始單價: 12600.0
2025-10-20 18:38:47,357 INFO: ➕ 開始準備新資料...
2025-10-20 18:38:47,357 INFO:    處理第 1/2 筆新資料...
2025-10-20 18:38:47,357 INFO:       品項: CIM K25-8F 新增設備護蓋加固補強, SOD: 1, 總價: 12600
2025-10-20 18:38:47,357 INFO:    處理第 2/2 筆新資料...
2025-10-20 18:38:47,358 INFO:       品項: CIM K25-8F 新增設備護蓋加固補強, SOD: 1, 總價: 12600
2025-10-20 18:38:47,358 INFO: ✅ 準備完成 2 筆新資料
2025-10-20 18:38:47,358 INFO: 📥 將新資料添加到最後...
2025-10-20 18:38:47,360 INFO: ✅ 添加完成,現有 392 筆資料
2025-10-20 18:38:47,360 INFO: 💾 開始儲存到 static/data/Buyer_detail.csv...
2025-10-20 18:38:47,368 INFO: ✅ 儲存完成
2025-10-20 18:38:47,369 INFO: ================================================================================
2025-10-20 18:38:47,369 INFO: ✅ 成功更新 PO 6100817457 Item 0020: 刪除 1 筆,新增 2 筆 (已加到最後)
2025-10-20 18:38:47,369 INFO: ================================================================================
2025-10-20 18:38:47,370 INFO: 127.0.0.1 - - [20/Oct/2025 18:38:47] "POST /api/confirm_quantity_update HTTP/1.1" 200 -
